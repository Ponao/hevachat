(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{1e3:function(e,t){},1002:function(e,t){},1183:function(e,t){},1184:function(e,t){},1209:function(e,t){},1211:function(e,t){},1239:function(e,t){},1241:function(e,t){},1242:function(e,t){},1248:function(e,t){},1250:function(e,t){},1268:function(e,t){},1271:function(e,t){},1287:function(e,t){},1290:function(e,t){},1295:function(e,t){},1297:function(e,t){},1320:function(e,t){},1424:function(e,t,a){},1427:function(e,t,a){"use strict";a.r(t);var s={};a.r(s),a.d(s,"dialogsGet",(function(){return ke})),a.d(s,"dialogGet",(function(){return Ne})),a.d(s,"dialogLoad",(function(){return Te})),a.d(s,"updateOnline",(function(){return Ce})),a.d(s,"setForward",(function(){return De})),a.d(s,"sendMessage",(function(){return xe})),a.d(s,"editMessage",(function(){return we})),a.d(s,"readMessages",(function(){return Fe})),a.d(s,"retrySendMessage",(function(){return Le})),a.d(s,"deleteMessage",(function(){return Ue})),a.d(s,"deleteLocalMessage",(function(){return Be})),a.d(s,"loadMessages",(function(){return Ge}));var n={};a.r(n),a.d(n,"roomsGet",(function(){return vt})),a.d(n,"roomsAdd",(function(){return St})),a.d(n,"joinRoom",(function(){return jt})),a.d(n,"leaveRoom",(function(){return Rt})),a.d(n,"sendMessage",(function(){return _t})),a.d(n,"editMessage",(function(){return Mt})),a.d(n,"deleteMessage",(function(){return It})),a.d(n,"deleteLocalMessage",(function(){return At})),a.d(n,"retrySendMessage",(function(){return kt})),a.d(n,"readMessages",(function(){return Nt})),a.d(n,"loadMessages",(function(){return Tt}));var o={};a.r(o),a.d(o,"userGet",(function(){return xt})),a.d(o,"friendsGet",(function(){return wt})),a.d(o,"requestedGet",(function(){return Ft})),a.d(o,"pendingGet",(function(){return Lt})),a.d(o,"setUsers",(function(){return Ut})),a.d(o,"setActiveUserId",(function(){return Bt})),a.d(o,"sendRequest",(function(){return Gt})),a.d(o,"acceptRequest",(function(){return zt})),a.d(o,"removeRequest",(function(){return Pt}));var r={};a.r(r),a.d(r,"notificationsGet",(function(){return ra})),a.d(r,"notificationRead",(function(){return ia}));var i={};a.r(i),a.d(i,"loginUser",(function(){return da})),a.d(i,"logoutUser",(function(){return ma})),a.d(i,"updateRoomLang",(function(){return ga}));a(370),a(380),a(381),a(659),a(394),a(705);var c=a(0),l=a.n(c),p=a(38),u=a.n(p),d=(a(887),a(5)),m=a(4),g=a(7),h=a(6),f=(a(888),l.a.createContext()),y=a(619),E=a.n(y),b=a(615),O=a.n(b),v=a(128),S=a.n(v),j=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"user-avatar",style:this.props.style},l.a.createElement("span",null,this.props.name.toUpperCase()),this.props.online&&l.a.createElement("span",{className:"online-status"}),this.props.status&&l.a.createElement(l.a.Fragment,null,"accept"===this.props.status&&l.a.createElement("span",{className:"notification-status"},l.a.createElement(O.a,{style:{color:"#fff",fontSize:14}})),"invite"===this.props.status&&l.a.createElement("span",{className:"notification-status"},l.a.createElement(E.a,{style:{color:"#fff",fontSize:14}})),"request"===this.props.status&&l.a.createElement("span",{className:"notification-status"},l.a.createElement(S.a,{style:{color:"#fff",fontSize:14}}))))}}]),a}(l.a.Component),R=(a(893),a(628)),_=a.n(R),M=a(255),I=a.n(M),A=a(629),k=a.n(A),N=a(254),T=a.n(N),C=a(52),D=a(8),x=a(9),w=a(1),F={isAuth:!1},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":return Object(w.a)(Object(w.a)(Object(w.a)({},e),t.payload),{},{isAuth:!0});case"USER_LOGOUT":return{isAuth:!1};case"USER_UPDATE_ROOM_LANG":return Object(w.a)(Object(w.a)({},e),{},{roomLang:t.payload});default:return e}},U=a(14),B={isFetching:!0,getted:!1,activeRoom:!1,isError:!1,rooms:[]},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROOMS_GET":return Object(w.a)(Object(w.a)({},e),{},{rooms:t.payload,isFetching:!1,getted:!0});case"ROOMS_SET_GET":return Object(w.a)(Object(w.a)({},e),{},{isFetching:!0,getted:!1,isError:!1});case"ROOMS_GET_ERROR":return Object(w.a)(Object(w.a)({},e),{},{isFetching:!1,getted:!0,isError:!0});case"ROOMS_ADD":return Object(w.a)(Object(w.a)({},e),{},{rooms:[t.payload].concat(Object(U.a)(e.rooms))});case"ROOMS_EDIT_ROOM":return Object(w.a)(Object(w.a)({},e),{},{rooms:e.rooms.map((function(e){return t.payload._id===e._id?Object(w.a)(Object(w.a)({},e),{},{title:t.payload.title,isPrivate:t.payload.isPrivate}):e}))});case"ROOMS_DELETE_ROOM":return Object(w.a)(Object(w.a)({},e),{},{rooms:Object(U.a)(e.rooms.filter((function(e){return e._id!==t.payload})))});case"ROOMS_JOIN_ROOM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},t.payload.room),{},{typers:[],canLoad:t.payload.canLoad,isLoading:!1,remoteStream:!1})});case"ROOMS_JOIN_ERROR":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:{error:t.payload}});case"ROOMS_USER_LEAVE_IN_ROOM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{users:Object(U.a)(e.activeRoom.users.filter((function(e){return e._id!==t.payload})))})});case"ROOMS_USER_JOIN_IN_ROOM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{users:[].concat(Object(U.a)(e.activeRoom.users),[t.payload])})});case"ROOMS_EDIT_IN_ROOM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{title:t.payload.title,isPrivate:t.payload.isPrivate})});case"ROOMS_LEAVE_ROOM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:!1});case"ROOMS_USER_JOIN_ROOM":return Object(w.a)(Object(w.a)({},e),{},{rooms:e.rooms.map((function(e){return t.payload.roomId===e._id?Object(w.a)(Object(w.a)({},e),{},{users:[t.payload.user].concat(Object(U.a)(e.users))}):e}))});case"ROOMS_USER_LEAVE_ROOM":return Object(w.a)(Object(w.a)({},e),{},{rooms:e.rooms.map((function(e){return t.payload.roomId===e._id?Object(w.a)(Object(w.a)({},e),{},{users:Object(U.a)(e.users.filter((function(e){return e._id!==t.payload.userId})))}):e}))});case"ROOMS_ADD_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:[].concat(Object(U.a)(e.activeRoom.dialog.messages),[t.payload])})})});case"ROOMS_SUCCESS_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:e.activeRoom.dialog.messages.map((function(e){return t.payload._id===e._id?Object(w.a)(Object(w.a)({},e),{},{isLoading:!1,_id:t.payload._newId}):e}))})})});case"ROOMS_ERROR_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:e.activeRoom.dialog.messages.map((function(e){return t.payload===e._id?Object(w.a)(Object(w.a)({},e),{},{isLoading:!1,isError:!0}):e}))})})});case"ROOMS_EDIT_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:e.activeRoom.dialog.messages.map((function(e){return t.payload._id===e._id?Object(w.a)(Object(w.a)(Object(w.a)({},e),t.payload),{},{isEdit:!0}):e}))})})});case"ROOMS_DELETE_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:Object(U.a)(e.activeRoom.dialog.messages.filter((function(e){return!t.payload.find((function(t){return t===e._id}))})))})})});case"ROOMS_READ_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:e.activeRoom.dialog.messages.map((function(e){return e.isRead||e.user._id!==t.payload?e:Object(w.a)(Object(w.a)({},e),{},{isRead:!0})}))})})});case"ROOMS_READ_MESSAGES":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:e.activeRoom.dialog.messages.map((function(e){return e.isRead||e.user._id===t.payload?e:Object(w.a)(Object(w.a)({},e),{},{isRead:!0})}))})})});case"ROOMS_SET_REMOTE_STREAM":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{remoteStream:t.payload})});case"ROOMS_SET_LOADING":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{canLoad:!1,isLoading:!0})});case"ROOMS_LOAD_MESSAGES":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{isLoading:!1,canLoad:t.payload.canLoad,dialog:Object(w.a)(Object(w.a)({},e.activeRoom.dialog),{},{messages:[].concat(Object(U.a)(t.payload.messages),Object(U.a)(e.activeRoom.dialog.messages))})})});case"ROOMS_ADD_TYPER":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{typers:[t.payload].concat(Object(U.a)(e.activeRoom.typers))})});case"ROOMS_REMOVE_TYPER":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{typers:Object(U.a)(e.activeRoom.typers.filter((function(e){return e._id!==t.payload})))})});case"ROOMS_SET_SPEAKING_STATUS":return Object(w.a)(Object(w.a)({},e),{},{activeRoom:Object(w.a)(Object(w.a)({},e.activeRoom),{},{users:e.activeRoom.users.map((function(e){return e._id===t.payload.userId?Object(w.a)(Object(w.a)({},e),{},{speaking:t.payload.speaking}):e}))})});default:return e}},z={micOn:!1,musicOn:!0},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MEDIA_TOGGLE_MICROPHONE":return Object(w.a)(Object(w.a)({},e),{},{micOn:t.payload});case"MEDIA_TOGGLE_MUSIC":return Object(w.a)(Object(w.a)({},e),{},{musicOn:t.payload});default:return e}},H={isFetching:!0,dialogs:[],forwardMessages:[]},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DIALOGS_GET":return Object(w.a)(Object(w.a)({},e),{},{dialogs:t.payload.dialogs,isFetching:!1,noReadCount:t.payload.noReadCount});case"DIALOGS_ADD":return Object(w.a)(Object(w.a)({},e),{},{dialogs:[t.payload].concat(Object(U.a)(e.dialogs))});case"DIALOGS_LOAD":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:t.payload.messages,getted:!0,canLoad:t.payload.canLoad}):e}))});case"DIALOGS_ADD_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:[].concat(Object(U.a)(e.messages),[t.payload.message]),lastMessage:t.payload.message,noRead:t.payload.noRead?e.noRead+1:e.noRead}):e})).sort((function(e,t){return e.lastMessage&&t.lastMessage?(e=new Date(e.lastMessage.createdAt))>(t=new Date(t.lastMessage.createdAt))?-1:e<t?1:0:0})),noReadCount:t.payload.noReadCount?e.noReadCount+1:e.noReadCount});case"DIALOGS_SUCCESS_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:e.messages.map((function(e){return t.payload._id===e._id?Object(w.a)(Object(w.a)({},e),{},{isLoading:!1,_id:t.payload._newId}):e})),lastMessage:Object(w.a)(Object(w.a)({},e.lastMessage),{},{isLoading:!1})}):e}))});case"DIALOGS_ERROR_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:e.messages.map((function(e){return t.payload._id===e._id?Object(w.a)(Object(w.a)({},e),{},{isLoading:!1,isError:!0}):e})),lastMessage:Object(w.a)(Object(w.a)({},e.lastMessage),{},{isLoading:!1,isError:!0})}):e}))});case"DIALOGS_UPDATE_ONLINE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.userId===e.user._id?Object(w.a)(Object(w.a)({},e),{},{user:Object(w.a)(Object(w.a)({},e.user),{},{online:t.payload.online,onlineAt:t.payload.onlineAt})}):e}))});case"DIALOGS_READ_MESSAGES":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:e.messages.map((function(e){return e.isRead||e.user._id!==t.payload.userId?e:Object(w.a)(Object(w.a)({},e),{},{isRead:!0})})),noRead:t.payload.noRead?0:e.noRead,lastMessage:Object(w.a)(Object(w.a)({},e.lastMessage),{},{isRead:!0})}):e})),noReadCount:t.payload.noReadCount?e.noReadCount-1:e.noReadCount});case"DIALOGS_EDIT_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:e.messages.map((function(e){return t.payload.message._id===e._id?Object(w.a)(Object(w.a)(Object(w.a)({},e),t.payload.message),{},{isEdit:!0}):e})),lastMessage:t.payload.editLast?Object(w.a)(Object(w.a)({},e.lastMessage),t.payload.message):e.lastMessage}):e}))});case"DIALOGS_DELETE_MESSAGE":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{messages:Object(U.a)(e.messages.filter((function(e){return!t.payload.messageIds.find((function(t){return t===e._id}))}))),lastMessage:t.payload.lastMessage,noRead:t.payload.noRead||0===t.payload.noRead?t.payload.noRead:e.noRead}):e})).sort((function(e,t){return e.lastMessage&&t.lastMessage?(e=new Date(e.lastMessage.createdAt))>(t=new Date(t.lastMessage.createdAt))?-1:e<t?1:0:0})),noReadCount:t.payload.noReadCount||0===t.payload.noReadCount?t.payload.noReadCount:e.noReadCount});case"DIALOGS_SET_LOADING":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload===e._id?Object(w.a)(Object(w.a)({},e),{},{canLoad:!1,isLoading:!0}):e}))});case"DIALOGS_LOAD_MESSAGES":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.dialogId===e._id?Object(w.a)(Object(w.a)({},e),{},{isLoading:!1,canLoad:t.payload.canLoad,messages:[].concat(Object(U.a)(t.payload.messages),Object(U.a)(e.messages))}):e}))});case"DIALOGS_SET_TYPER":return Object(w.a)(Object(w.a)({},e),{},{dialogs:e.dialogs.map((function(e){return t.payload.userId===e.user._id?Object(w.a)(Object(w.a)({},e),{},{typing:t.payload.typing}):e}))});case"DIALOGS_SET_FORWARD":return Object(w.a)(Object(w.a)({},e),{},{forwardMessages:t.payload});default:return e}},W={isFetching:!0,getted:!1,activeUserId:!1,isError:!1,canLoad:!1,users:[],friends:{users:[],getted:!1,canLoad:!1,isFetching:!0},requested:{users:[],getted:!1,canLoad:!1,isFetching:!0},pending:{users:[],getted:!1,canLoad:!1,isFetching:!0}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USERS_SET":return Object(w.a)(Object(w.a)({},e),{},{users:t.payload.friends,canLoad:t.payload.canLoad,isFetching:!1,getted:!0});case"USERS_ADD":return Object(w.a)(Object(w.a)({},e),{},{users:[t.payload].concat(Object(U.a)(e.users))});case"USERS_SET_ACTIVE_USER_ID":return Object(w.a)(Object(w.a)({},e),{},{activeUserId:t.payload});case"USERS_SET_FRIEND_STATUS":return Object(w.a)(Object(w.a)({},e),{},{users:e.users.map((function(e){return t.payload.userId===e._id?Object(w.a)(Object(w.a)({},e),{},{friendStatus:t.payload.friendStatus}):e}))});case"USERS_FRIENDS_GET":return Object(w.a)(Object(w.a)({},e),{},{friends:Object(w.a)(Object(w.a)({},e.friends),{},{users:t.payload.users,canLoad:t.payload.canLoad,isFetching:!1,getted:!0})});case"USERS_REQUESTED_GET":return Object(w.a)(Object(w.a)({},e),{},{requested:Object(w.a)(Object(w.a)({},e.requested),{},{users:t.payload.users,canLoad:t.payload.canLoad,isFetching:!1,getted:!0})});case"USERS_PENDING_GET":return Object(w.a)(Object(w.a)({},e),{},{pending:Object(w.a)(Object(w.a)({},e.pending),{},{users:t.payload.users,canLoad:t.payload.canLoad,isFetching:!1,getted:!0})});case"USERS_FRIENDS_REMOVE":return Object(w.a)(Object(w.a)({},e),{},{friends:Object(w.a)(Object(w.a)({},e.friends),{},{users:Object(U.a)(e.friends.users.filter((function(e){return t.payload.userId!==e._id})))})});case"USERS_REQUESTED_REMOVE":return Object(w.a)(Object(w.a)({},e),{},{requested:Object(w.a)(Object(w.a)({},e.requested),{},{users:Object(U.a)(e.requested.users.filter((function(e){return t.payload.userId!==e._id})))})});case"USERS_PENDING_REMOVE":return Object(w.a)(Object(w.a)({},e),{},{pending:Object(w.a)(Object(w.a)({},e.pending),{},{users:Object(U.a)(e.pending.users.filter((function(e){return t.payload.userId!==e._id})))})});case"USERS_FRIENDS_ADD":return Object(w.a)(Object(w.a)({},e),{},{friends:Object(w.a)(Object(w.a)({},e.friends),{},{users:[t.payload.user].concat(Object(U.a)(e.friends.users))})});case"USERS_REQUESTED_ADD":return Object(w.a)(Object(w.a)({},e),{},{requested:Object(w.a)(Object(w.a)({},e.requested),{},{users:[t.payload.user].concat(Object(U.a)(e.requested.users))})});case"USERS_PENDING_ADD":return Object(w.a)(Object(w.a)({},e),{},{pending:Object(w.a)(Object(w.a)({},e.pending),{},{users:[t.payload.user].concat(Object(U.a)(e.pending.users))})});default:return e}},V={isFetching:!0,getted:!1,activeRoom:!1,isError:!1,notifications:[],noRead:0},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATIONS_GET":return Object(w.a)(Object(w.a)({},e),{},{notifications:t.payload,isFetching:!1,getted:!0});case"NOTIFICATIONS_ADD":return Object(w.a)(Object(w.a)({},e),{},{notifications:[t.payload].concat(Object(U.a)(e.notifications)),noRead:e.noRead+1});case"NOTIFICATIONS_READ":return Object(w.a)(Object(w.a)({},e),{},{notifications:e.notifications.map((function(e){return t.payload===e._id?Object(w.a)(Object(w.a)({},e),{},{isRead:!0}):e})),noRead:e.noRead-1});case"NOTIFICATIONS_SET_NO_READ":return Object(w.a)(Object(w.a)({},e),{},{noRead:t.payload});case"NOTIFICATIONS_REMOVE":return Object(w.a)(Object(w.a)({},e),{},{notifications:Object(U.a)(e.notifications.filter((function(e){return e._id!==t.payload})))});default:return e}},Q=Object(x.c)({user:L,rooms:G,media:P,dialogs:J,users:q,notifications:Y}),$=a(621),K=Object(x.d)(Q,Object(x.a)($.a));a(908);function X(e,t){var a=e+Math.random()*(t+1-e);return Math.floor(a)}function Z(e,t){for(var a,s=0;s<t.length;s++)t[s].path===e&&(a="Hevachat | "+t[s].title);document.title=a||"Hevachat"}function ee(e){document.title="Hevachat | "+e}var te=a(622),ae=a.n(te),se=(a(1428),a(624)),ne=a.n(se),oe=!1,re=!1,ie=!1,ce=!1,le=!1,pe=!!document.documentMode,ue=!pe&&!!window.StyleMedia,de=RTCPeerConnection||window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,me=window.RTCSessionDescription||window.mozRTCSessionDescription||window.RTCSessionDescription,ge=(window.mozRTCIceCandidate||window.RTCIceCandidate,{offerToReceiveAudio:!0,offerToReceiveVideo:!1}),he={iceServers:[{urls:"stun:173.194.66.127:19302"},{urls:"turn:89.223.100.223:3478",credential:"TkYUraQew3RjwTA2JPjAaWL1Q7FIamc",username:"hevachat"}]};function fe(e){return e((new(window.AudioContext||window.webkitAudioContext)).createMediaStreamDestination().stream)}var ye=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;function Ee(e){e.candidate&&Ae.sendRoomIceCandidate({roomId:re,candidate:e.candidate})}var be=function(){ie.getAudioTracks()[0].enabled=!ie.getAudioTracks()[0].enabled,K.dispatch({type:"MEDIA_TOGGLE_MICROPHONE",payload:ie.getAudioTracks()[0].enabled})},Oe=function(){ce.getAudioTracks()[0].enabled=!ce.getAudioTracks()[0].enabled,K.dispatch({type:"MEDIA_TOGGLE_MUSIC",payload:ce.getAudioTracks()[0].enabled})},ve=function(e){var t;re=e,t=function(e){(ie=e).getAudioTracks()[0].enabled=!1,(oe=new de(he)).addStream(e),oe.onicecandidate=Ee,oe.createOffer(ge).then((function(e){oe.setLocalDescription(e),function(e,t){if(e)return console.log(e);Ae.sendRoomOfferSdp({roomId:re,offerSdp:t.sdp})}(null,e)}))},pe||ue?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(e){t(e)})).catch((function(e){fe(t)})):ye({audio:!0,video:!1},t,(function(){fe(t)}))},Se=function(e){var t=e.roomId,a=e.lang;oe&&(oe.close(),oe=!1),re&&(Ae.leaveRoom({roomId:t,lang:a}),re=!1),ie&&(ie.getAudioTracks()[0].stop(),ie=!1),ce&&(ce.getAudioTracks()[0].stop(),ce=!1),le&&(le.stop(),le=!1),K.dispatch({type:"MEDIA_TOGGLE_MICROPHONE",payload:!1})},je=function(e){oe&&e.candidate&&oe.addIceCandidate(e)},Re=function(e){var t=new me({type:"answer",sdp:e});oe.setRemoteDescription(t);var a=new MediaStream;oe.getReceivers().forEach((function(e){a.addTrack(e.track)})),ce=a,K.dispatch({type:"ROOMS_SET_REMOTE_STREAM",payload:a}),(le=ne()(ie,{})).on("speaking",(function(){Ae.sendRoomSpeaking({roomId:re})})),le.on("stopped_speaking",(function(){Ae.sendRoomStopSpeaking({roomId:re})}))},_e="https://romadevtest.tk:8080",Me=null,Ie=!1,Ae={init:function(e){(Me=ae()(_e,{transports:["websocket","polling","flashsocket"]})).on("connect",(function(){Me.emit("auth",e)})),Me.on("createRoom",(function(e){K.dispatch({type:"ROOMS_ADD",payload:e})})),Me.on("editRoom",(function(e){K.dispatch({type:"ROOMS_EDIT_ROOM",payload:e})})),Me.on("editInRoom",(function(e){K.dispatch({type:"ROOMS_EDIT_IN_ROOM",payload:e})})),Me.on("deleteRoom",(function(e){K.dispatch({type:"ROOMS_DELETE_ROOM",payload:e})})),Me.on("joinRoom",(function(e){var t=e.roomId,a=e.user;K.dispatch({type:"ROOMS_USER_JOIN_ROOM",payload:{roomId:t,user:a}})})),Me.on("joinInRoom",(function(e){K.dispatch({type:"ROOMS_USER_JOIN_IN_ROOM",payload:e})})),Me.on("leaveRoom",(function(e){var t=e.roomId,a=e.userId;K.dispatch({type:"ROOMS_USER_LEAVE_ROOM",payload:{roomId:t,userId:a}})})),Me.on("leaveInRoom",(function(e){K.dispatch({type:"ROOMS_USER_LEAVE_IN_ROOM",payload:e})})),Me.on("sendMessageRoom",(function(e){K.dispatch({type:"ROOMS_ADD_MESSAGE",payload:e}),K.getState().rooms.activeRoom.typers.find((function(t){return t._id===e.user._id}))&&K.dispatch({type:"ROOMS_REMOVE_TYPER",payload:e.user._id})})),Me.on("deleteMessageRoom",(function(e){K.dispatch({type:"ROOMS_DELETE_MESSAGE",payload:e})})),Me.on("readMessagesRoom",(function(e){K.getState().rooms.activeRoom&&K.getState().rooms.activeRoom._id===e&&K.dispatch({type:"ROOMS_READ_MESSAGE",payload:K.getState().user._id})})),Me.on("editMessageRoom",(function(e){K.dispatch({type:"ROOMS_EDIT_MESSAGE",payload:e})})),Me.on("typingRoom",(function(e){K.getState().rooms.activeRoom.typers.find((function(t){return t._id===e._id}))||(K.dispatch({type:"ROOMS_ADD_TYPER",payload:e}),setTimeout((function(){K.dispatch({type:"ROOMS_REMOVE_TYPER",payload:e._id})}),2500))})),Me.on("roomAnswerSdp",(function(e){Re(e)})),Me.on("roomOnIceCandidate",(function(e){je(e)})),Me.on("roomSpeaking",(function(e){K.dispatch({type:"ROOMS_SET_SPEAKING_STATUS",payload:{userId:e,speaking:!0}})})),Me.on("roomStopSpeaking",(function(e){K.dispatch({type:"ROOMS_SET_SPEAKING_STATUS",payload:{userId:e,speaking:!1}})})),Me.on("sendMessageDialog",(function(t){var a=t.message,s=t.otherId;if(K.getState().dialogs.dialogs.find((function(e){return e.user._id===a.user._id}))&&K.getState().dialogs.dialogs.find((function(e){return e.user._id===a.user._id})).typing&&K.dispatch({type:"DIALOGS_SET_TYPER",payload:{userId:a.user._id,typing:!1}}),K.getState().dialogs.dialogs.find((function(e){return e._id===a.dialogId}))){var n=!1;a.user._id===K.getState().user._id||K.getState().dialogs.dialogs.find((function(e){return e._id===a.dialogId})).noRead||(n=!0),K.dispatch({type:"DIALOGS_ADD_MESSAGE",payload:{message:a,dialogId:a.dialogId,noRead:a.user._id!==K.getState().user._id,noReadCount:n}})}else fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:s})}).then((function(e){return e.json()})).then((function(e){var t=e.user,s=(e.friendStatus,{lastMessage:a,_id:a.dialogId,users:[K.getState().user,t],user:t,getted:!1,typing:!1,noRead:1,messages:[]});K.dispatch({type:"DIALOGS_ADD",payload:s})}))})),Me.on("sendNotification",(function(e){K.getState().notifications.getted?K.dispatch({type:"NOTIFICATIONS_ADD",payload:e}):K.dispatch({type:"NOTIFICATIONS_SET_NO_READ",payload:K.getState().notifications.noRead+1})})),Me.on("readNotification",(function(e){K.dispatch({type:"NOTIFICATIONS_READ",payload:e})})),Me.on("removeNotification",(function(e){var t=e.id,a=e.read,s=K.getState().notifications.noRead;a||s--,K.dispatch({type:"NOTIFICATIONS_SET_NO_READ",payload:s}),K.dispatch({type:"NOTIFICATIONS_REMOVE",payload:t})})),Me.on("readMessagesDialog",(function(e){var t=e.dialogId,a=e.userId;K.dispatch({type:"DIALOGS_READ_MESSAGES",payload:{dialogId:t,userId:a,noRead:a!==K.getState().user._id,noReadCount:a!==K.getState().user._id}})})),Me.on("editMessageDialog",(function(e){var t,a=e.message,s=e.dialogId,n=K.getState().dialogs.dialogs.find((function(e){return e._id===s})).lastMessage;t=!!n&&a._id===n._id,K.dispatch({type:"DIALOGS_EDIT_MESSAGE",payload:{message:a,dialogId:s,editLast:t}})})),Me.on("deleteMessageDialog",(function(e){var t=e.messageIds,a=e.dialogId,s=e.lastMessage,n=e.noRead,o=e.noReadCount;console.log(o),K.dispatch({type:"DIALOGS_DELETE_MESSAGE",payload:{dialogId:a,messageIds:t,lastMessage:s,noRead:n,noReadCount:o}})})),Me.on("typingDialog",(function(e){K.getState().dialogs.dialogs.find((function(t){return t.user._id===e}))&&(K.dispatch({type:"DIALOGS_SET_TYPER",payload:{userId:e,typing:!0}}),setTimeout((function(){K.dispatch({type:"DIALOGS_SET_TYPER",payload:{userId:e,typing:!1}})}),2500))})),Me.on("sendRequestFriend",(function(t){var a=t.userId,s=t.friendStatus;K.dispatch({type:"USERS_SET_FRIEND_STATUS",payload:{userId:a,friendStatus:s}}),K.getState().users.pending.getted&&K.dispatch({type:"USERS_PENDING_REMOVE",payload:{userId:a}}),K.getState().users.requested.getted&&(K.getState().users.users.find((function(e){return e._id===a}))?K.dispatch({type:"USERS_REQUESTED_ADD",payload:{user:K.getState().users.users.find((function(e){return e._id===a}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:a})}).then((function(e){return e.json()})).then((function(e){var t=e.user,a=e.friendStatus;t.friendStatus=a,K.dispatch({type:"USERS_ADD",payload:t}),K.dispatch({type:"USERS_REQUESTED_ADD",payload:{user:t}})})))})),Me.on("sendAcceptFriend",(function(t){var a=t.userId,s=t.friendStatus;K.dispatch({type:"USERS_SET_FRIEND_STATUS",payload:{userId:a,friendStatus:s}}),K.getState().users.pending.getted&&K.dispatch({type:"USERS_PENDING_REMOVE",payload:{userId:a}}),K.getState().users.friends.getted&&(K.getState().users.users.find((function(e){return e._id===a}))?K.dispatch({type:"USERS_FRIENDS_ADD",payload:{user:K.getState().users.users.find((function(e){return e._id===a}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:a})}).then((function(e){return e.json()})).then((function(e){var t=e.user,a=e.friendStatus;t.friendStatus=a,K.dispatch({type:"USERS_ADD",payload:t}),K.dispatch({type:"USERS_FRIENDS_ADD",payload:{user:t}})})))})),Me.on("sendRemoveFriend",(function(t){var a=t.userId,s=t.friendStatus;K.dispatch({type:"USERS_SET_FRIEND_STATUS",payload:{userId:a,friendStatus:s}}),K.getState().users.friends.getted&&1===s&&(K.dispatch({type:"USERS_FRIENDS_REMOVE",payload:{userId:a}}),K.getState().users.requested.getted&&(K.getState().users.users.find((function(e){return e._id===a}))?K.dispatch({type:"USERS_PENDING_ADD",payload:{user:K.getState().users.users.find((function(e){return e._id===a}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:a})}).then((function(e){return e.json()})).then((function(e){var t=e.user,a=e.friendStatus;t.friendStatus=a,K.dispatch({type:"USERS_ADD",payload:t}),K.dispatch({type:"USERS_PENDING_ADD",payload:{user:t}})})))),K.getState().users.pending.getted&&0===s&&K.dispatch({type:"USERS_PENDING_REMOVE",payload:{userId:a}}),K.getState().users.requested.getted&&0===s&&K.dispatch({type:"USERS_REQUESTED_REMOVE",payload:{userId:a}})}))},getSocketId:function(){return Me.id},joinLang:function(e){Ie&&Me.emit("leaveLang",e),Me.emit("joinLang",e),Ie=e},createRoom:function(e){var t=e.room,a=e.lang;Me.emit("createRoom",{room:t,lang:a})},joinRoom:function(e){var t=e.roomId,a=e.lang;Me.emit("joinRoom",{roomId:t,lang:a,userId:K.getState().user._id})},leaveRoom:function(e){var t=e.roomId,a=e.lang;Me.emit("leaveRoom",{roomId:t,lang:a})},sendMessageRoom:function(e){var t=e.roomId,a=e.message;Me.emit("sendMessageRoom",{roomId:t,message:a})},typingRoom:function(e){Me.emit("typingRoom",e)},sendRoomIceCandidate:function(e){var t=e.roomId,a=e.candidate;Me.emit("roomIceCandidate",{roomId:t,candidate:a})},sendRoomOfferSdp:function(e){var t=e.roomId,a=e.offerSdp;Me.emit("roomOfferSdp",{roomId:t,offerSdp:a})},sendRoomSpeaking:function(e){var t=e.roomId;Me.emit("roomSpeaking",t)},sendRoomStopSpeaking:function(e){var t=e.roomId;Me.emit("roomStopSpeaking",t)},typingDialog:function(e,t){Me.emit("typingDialog",{otherId:e,userId:t})}},ke=function(e){return function(t){fetch("".concat(_e,"/api/dialog/get-all"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){for(var a=function(t){var a=K.getState().dialogs.dialogs.find((function(a){return a._id===e[t]._id}));a?e[t]=a:(e[t].user=e[t].users.find((function(e){return e._id!==K.getState().user._id})),e[t].user||(e[t].user=e[t].users[0]),e[t].typers=[])},s=0;s<e.length;s++)a(s);t({type:"DIALOGS_GET",payload:e})}))}},Ne=function(e,t){return function(a){fetch("".concat(_e,"/api/dialog/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(t){var s=t.dialog,n=t.messages;s.error?a({type:"DIALOGS_ADD",payload:{getted:!0,isNotFound:!0,user:{_id:e}}}):(s.user=s.users.find((function(e){return e._id!==K.getState().user._id})),s.user||(s.user=s.users[0]),s.typing=!1,s.getted=!0,s.messages=n.reverse(),s.lastMessage=!1,s.canLoad=50===n.length,s.isLoading=!1,a({type:"DIALOGS_ADD",payload:s}))}))}},Te=function(e,t){return function(a){fetch("".concat(_e,"/api/dialog/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(e){var t=e.dialog,s=e.messages;t.messages=s.reverse(),a({type:"DIALOGS_LOAD",payload:{dialogId:t._id,messages:t.messages,canLoad:50===s.length}})}))}},Ce=function(e,t){return function(a){fetch("".concat(_e,"/api/user/get-online"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(t){var s=t.online,n=t.onlineAt;a({type:"DIALOGS_UPDATE_ONLINE",payload:{userId:e,online:s,onlineAt:n}})}))}},De=function(e){return function(t){t({type:"DIALOGS_SET_FORWARD",payload:e})}},xe=function(e,t){return function(a){for(var s=new FormData,n=X(0,1e6),o=[],r=[],i=[],c=0;c<e.images.length;c++)s.append("images"+c,e.images[c].file),e.images[c].file=!1,o.push(e.images[c]);for(var l=0;l<e.files.length;l++)s.append("files"+l,e.files[l].file),e.files[l].file=!1,r.push(e.files[l]);for(var p=0;p<e.sounds.length;p++)s.append("sounds"+p,e.sounds[p].file),e.sounds[p].file=!1,i.push(e.sounds[p]);var u={_id:n,user:K.getState().user,text:e.text,images:o,sounds:i,files:r,isLoading:!0,isError:!1,isRead:!1,recentMessages:e.recentMessages,createdAt:Date.now()};a({type:"DIALOGS_ADD_MESSAGE",payload:{message:u,dialogId:e.dialogId}});var d=[];e.recentMessages.map((function(e){d.push(e._id)})),e.recentMessages=d,e.socketId=Ae.getSocketId(),s.append("text",e.text),s.append("recentMessages",e.recentMessages),s.append("dialogId",e.dialogId),s.append("userId",e.userId),s.append("socketId",Ae.getSocketId()),fetch("".concat(_e,"/api/dialog/send-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:s}).then((function(e){return e.json()})).then((function(t){if(t.error)return a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:n,dialogId:e.dialogId}});a({type:"DIALOGS_SUCCESS_MESSAGE",payload:{_id:n,_newId:t._id,dialogId:e.dialogId}})})).catch((function(){a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:n,dialogId:e.dialogId}})}))}},we=function(e,t){return function(a){for(var s=new FormData,n=[],o=[],r=[],i=[],c=[],l=[],p=0;p<e.images.length;p++)e.images[p].file?(s.append("images"+p,e.images[p].file),n.push(e.images[p])):i.push(e.images[p].id);for(var u=0;u<e.files.length;u++)e.files[u].file?(s.append("files"+u,e.files[u].file),o.push(e.files[u])):c.push(e.files[u].id);for(var d=0;d<e.sounds.length;d++)e.sounds[d].file?(s.append("sounds"+d,e.sounds[d].file),r.push(e.sounds[d])):l.push(e.sounds[d].id);var m={_id:e._id,user:K.getState().user,text:e.text,images:e.images,sounds:e.sounds,files:e.files,isLoading:!0,isError:!1,recentMessages:e.recentMessages},g=K.getState().dialogs.dialogs.find((function(t){return t._id===e.dialogId})).messages[K.getState().dialogs.dialogs.find((function(t){return t._id===e.dialogId})).messages.length-1];a({type:"DIALOGS_EDIT_MESSAGE",payload:{message:m,dialogId:e.dialogId,editLast:g._id===e._id}});var h=[];e.recentMessages.map((function(e){h.push(e._id)})),e.recentMessages=h,e.socketId=Ae.getSocketId(),s.append("_id",e._id),s.append("text",e.text),s.append("recentMessages",e.recentMessages),s.append("userId",e.userId),s.append("dialogId",e.dialogId),s.append("socketId",Ae.getSocketId()),s.append("oldImages",i),s.append("oldSounds",l),s.append("oldFiles",c),fetch("".concat(_e,"/api/dialog/edit-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:s}).then((function(e){return e.json()})).then((function(t){if(t.error)return a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:e._id,dialogId:e.dialogId}});a({type:"DIALOGS_SUCCESS_MESSAGE",payload:{_id:e._id,_newId:e._id,dialogId:e.dialogId}})})).catch((function(){a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:e._id,dialogId:e.dialogId}})}))}},Fe=function(e,t){var a=e.dialogId,s=e.userId,n=e.otherId;return function(e){var o=K.getState().dialogs.dialogs.find((function(e){return e._id===a})).messages.filter((function(e){return!e.isRead&&e.user._id!==s}));setTimeout((function(){o.length&&e({type:"DIALOGS_READ_MESSAGES",payload:{dialogId:a,userId:n,noRead:!0,noReadCount:!0}})}),750),o.length&&fetch("".concat(_e,"/api/dialog/read-messages"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({dialogId:a,otherId:n,socketId:Ae.getSocketId()})}).then().catch((function(){}))}},Le=function(e,t){return function(a){var s=e.dialogId,n=new FormData,o=[],r={_id:e._id,user:K.getState().user,text:e.text,images:e.images,sounds:[],files:[],isLoading:!0,isError:!1,recentMessages:e.recentMessages,createdAt:Date.now()};a({type:"DIALOGS_DELETE_MESSAGE",payload:{dialogId:s,messageIds:[e._id],lastMessage:!1}}),a({type:"DIALOGS_ADD_MESSAGE",payload:{message:r,dialogId:e.dialogId}});for(var i=0;i<e.images.length;i++)n.append("images"+i,e.images[i].file),o.push(e.images[i].path);var c=[];e.recentMessages.map((function(e){c.push(e._id)})),e.recentMessages=c,e.socketId=Ae.getSocketId(),n.append("text",e.text),n.append("recentMessages",e.recentMessages),n.append("userId",e.userId),n.append("dialogId",e.dialogId),n.append("socketId",Ae.getSocketId()),fetch("".concat(_e,"/api/dialog/send-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:n}).then((function(e){return e.json()})).then((function(t){if(t.error)return a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:e._id,dialogId:e.dialogId}});a({type:"DIALOGS_SUCCESS_MESSAGE",payload:{_id:e._id,_newId:t._id,dialogId:e.dialogId}})})).catch((function(){a({type:"DIALOGS_ERROR_MESSAGE",payload:{_id:e._id,dialogId:e.dialogId}})}))}},Ue=function(e,t){var a=e.dialogId,s=e.otherId,n=e.deleteMessages;return function(e){var o,r=[];n.map((function(e){r.push(e._id)})),o=!(!K.getState().dialogs.dialogs.find((function(e){return e._id===a}))||!K.getState().dialogs.dialogs.find((function(e){return e._id===a})).messages.length)&&K.getState().dialogs.dialogs.find((function(e){return e._id===a})).messages.filter((function(e){return!r.find((function(t){return t===e._id}))})).pop(),e({type:"DIALOGS_DELETE_MESSAGE",payload:{dialogId:a,messageIds:r,lastMessage:o}}),fetch("".concat(_e,"/api/dialog/delete-message"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({dialogId:a,otherId:s,messageIds:r,socketId:Ae.getSocketId()})}).then().catch((function(){}))}},Be=function(e,t){return function(a){var s,n=[e];s=!(!K.getState().dialogs.dialogs.find((function(e){return e._id===t}))||!K.getState().dialogs.dialogs.find((function(e){return e._id===t})).messages.length)&&K.getState().dialogs.dialogs.find((function(e){return e._id===t})).messages.filter((function(e){return!n.find((function(t){return t===e._id}))})).pop(),a({type:"DIALOGS_DELETE_MESSAGE",payload:{dialogId:t,messageIds:n,lastMessage:s}})}},Ge=function(e,t){var a=e.dialogId;return function(e){var s=K.getState().dialogs.dialogs.find((function(e){return e._id===a})).messages[0];e({type:"DIALOGS_SET_LOADING",payload:a}),fetch("".concat(_e,"/api/dialog/load-messages"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({dialogId:a,lastMessageId:s._id})}).then((function(e){return e.json()})).then((function(t){e({type:"DIALOGS_LOAD_MESSAGES",payload:{dialogId:a,messages:t.reverse(),canLoad:50===t.length}})})).catch((function(){}))}},ze=a(248),Pe=a.n(ze),He=(a(220),a(22)),Je=a(1447),We=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return l.a.createElement(He.b,{style:{textDecoration:"none"},to:"/rooms/".concat(this.props.room._id)},l.a.createElement(Je.a,{className:"room-item",title:"Room ".concat(this.props.room.title)},l.a.createElement(j,{style:{width:40,height:40,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(this.props.room.color,")")},name:this.props.room.title.charAt(0)}),l.a.createElement("div",null,l.a.createElement("p",null,this.props.room.isPrivate&&l.a.createElement(Pe.a,null),this.props.room.title),l.a.createElement("div",{className:"users"},this.props.room.users.map((function(e,t){return l.a.createElement(j,{key:t,style:{width:16,height:16,fontSize:8,backgroundColor:"rgb(".concat(e.color,")")},name:e.name.first.charAt(0)+e.name.last.charAt(0)})}))))))}}]),a}(l.a.Component),qe=a(1448),Ve=a(1449),Ye=a(40),Qe=a(1454);var $e=a(73),Ke=a(49);function Xe(e){var t=new Date(e),a=t.getHours(),s=t.getMinutes();return 1===s.toString().length&&(s="0"+s),1===a.toString().length&&(a="0"+a),a+":"+s}function Ze(e){var t=(e=new Date(e)).getHours(),a=e.getMinutes();1==a.toString().length&&(a="0"+a),1==t.toString().length&&(t="0"+t);(new Date).getTime(),e.getTime();var s=(new Date).getDate()-e.getDate(),n=(new Date).getFullYear()-e.getFullYear(),o=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();if(n>0)return o.toString()+"."+(r<10?"0"+r.toString():r.toString())+"."+(i<10?"0"+i.toString():i.toString());return 0==s&&t+":"+a||1===s&&"Yesterday"||0===n&&i+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][r-1]}function et(e){var t=(e=new Date(e)).getHours(),a=e.getMinutes();1==a.toString().length&&(a="0"+a),1==t.toString().length&&(t="0"+t);var s=((new Date).getTime()-e.getTime())/1e3,n=(new Date).getDay()-e.getDay(),o=(new Date).getMonth()+1-(e.getMonth()+1),r=e.getFullYear(),i=e.getMonth()+1,c=e.getDate();return isNaN(n)||n<0||o>=1?r.toString()+"."+(i<10?"0"+i.toString():i.toString())+"."+(c<10?"0"+c.toString()+" in "+t+":"+a:c.toString()+" in "+t+":"+a):0==n&&((s<60?"just now":s<120&&"1 minute ago")||s<3600&&Math.floor(s/60)+" minutes ago"||s<7200&&"1 hour ago"||s<86400&&Math.floor(s/3600)+" hours ago")||1==n&&"yerstaday in "+t+":"+a||n<7&&n+" days ago in "+t+":"+a||n<31&&Math.ceil(n/7)+" weeks ago in "+t+":"+a}var tt=a(251),at=a.n(tt),st=a(252),nt=a.n(st),ot=a(250),rt=a.n(ot),it=a(148),ct=a.n(it),lt=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={active:!1,left:0,top:0},e}return Object(m.a)(a,[{key:"toggleActive",value:function(){var e,t,a=document.getElementById(this.props.from),s=a.getBoundingClientRect();this.props.bottom?(e=s.y+a.clientHeight,t=s.x):(e=s.y,t=s.x+a.clientWidth),this.setState({left:t,top:e}),this.setState({active:!this.state.active})}},{key:"componentDidMount",value:function(){document.getElementById(this.props.from).addEventListener("mouseenter",this.toggleActive.bind(this)),document.getElementById(this.props.from).addEventListener("mouseleave",this.toggleActive.bind(this))}},{key:"componentWillUnmount",value:function(){document.getElementById(this.props.from).removeEventListener("mouseenter",this.toggleActive.bind(this)),document.getElementById(this.props.from).removeEventListener("mouseleave",this.toggleActive.bind(this))}},{key:"render",value:function(){return l.a.createElement("div",{style:{left:this.state.left,top:this.state.top,transform:this.props.bottom?"none":null},className:"action-menu-container ".concat(this.state.active?"active":"")},l.a.createElement("div",{className:"action-menu"},this.props.actions.map((function(e,t){return e?l.a.createElement(Je.a,{key:t,onClick:function(){e.action()},className:"action-button"},e.text):null}))))}}]),a}(l.a.Component),pt=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={randomId:X(0,1e5)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(He.c,{style:{textDecoration:"none"},onClick:function(t){"/chats/".concat(e.props.user._id)===e.props.history.location.pathname&&t.preventDefault()},className:"dialog-link",to:"/chats/".concat(this.props.user._id)},l.a.createElement(Je.a,{className:"dialog-item"},l.a.createElement(j,{online:this.props.user.online,style:{width:40,height:40,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(this.props.user.color,")")},name:this.props.user.name.first.charAt(0)+this.props.user.name.last.charAt(0)}),l.a.createElement("div",null,l.a.createElement("p",{className:"user-name"},"".concat(this.props.user.name.first," ").concat(this.props.user.name.last)),!this.props.typing&&l.a.createElement("p",{className:"last-message"},this.props.lastMessage.user._id===this.props.myUser._id&&l.a.createElement("span",{style:{color:"#999999"}},"You:\xa0"),this.props.lastMessage.text&&l.a.createElement(l.a.Fragment,null,this.props.lastMessage.text),!this.props.lastMessage.text&&1===this.props.lastMessage.images.length&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},this.props.lastMessage.images[0].name)),!this.props.lastMessage.text&&this.props.lastMessage.images.length>1&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 [",this.props.lastMessage.images.length,"]")),!this.props.lastMessage.text&&!this.props.lastMessage.images.length&&1===this.props.lastMessage.sounds.length&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},this.props.lastMessage.sounds[0].name)),!this.props.lastMessage.text&&!this.props.lastMessage.images.length&&this.props.lastMessage.sounds.length>1&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},"\u0410\u0443\u0434\u0438\u043e [",this.props.lastMessage.sounds.length,"]")),!this.props.lastMessage.text&&!this.props.lastMessage.images.length&&!this.props.lastMessage.sounds.length&&1===this.props.lastMessage.files.length&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},this.props.lastMessage.files[0].name)),!this.props.lastMessage.text&&!this.props.lastMessage.images.length&&!this.props.lastMessage.sounds.length&&this.props.lastMessage.files.length>1&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{color:"#008FF7"}},"\u0424\u0430\u0439\u043b\u044b [",this.props.lastMessage.files.length,"]"))),this.props.typing&&l.a.createElement("p",{className:"last-message typing"},"typing")),l.a.createElement("div",{className:"dialog-info"},l.a.createElement("span",{className:"time-at"},Ze(this.props.lastMessage.createdAt)),l.a.createElement($e.CSSTransitionGroup,{transitionName:"message-status-transition",transitionEnterTimeout:100,transitionLeaveTimeout:100},this.props.lastMessage.user._id===this.props.myUser._id&&!this.props.lastMessage.isError&&this.props.lastMessage.isLoading&&l.a.createElement(rt.a,{style:{marginTop:2,fontSize:16,color:"#B8C3CF"}}),this.props.lastMessage.user._id===this.props.myUser._id&&!this.props.lastMessage.isError&&!this.props.lastMessage.isLoading&&!this.props.lastMessage.isRead&&l.a.createElement(at.a,{style:{marginTop:2,fontSize:16,color:"#B8C3CF"}}),this.props.lastMessage.user._id===this.props.myUser._id&&!this.props.lastMessage.isError&&!this.props.lastMessage.isLoading&&this.props.lastMessage.isRead&&l.a.createElement(nt.a,{style:{marginTop:2,fontSize:16,color:"#008FF7"}}),this.props.lastMessage.user._id!==this.props.myUser._id&&!!this.props.noRead&&l.a.createElement("span",{className:"unread-messages-count"},this.props.noRead),this.props.lastMessage.user._id!==this.props.myUser._id&&!this.props.noRead&&l.a.createElement("span",{style:{height:18}}),this.props.lastMessage.user._id===this.props.myUser._id&&!this.props.lastMessage.isLoading&&this.props.lastMessage.isError&&l.a.createElement(l.a.Fragment,null,l.a.createElement(lt,{actions:[{text:"Retry",action:function(){var t=e.props.lastMessage;t.userId=e.props.user._id,t.dialogId=e.props.dialogId,e.props.dialogsActions.retrySendMessage(t,e.props.myUser.apiToken)}},{text:"Delete",action:function(){e.props.dialogsActions.deleteLocalMessage(e.props.lastMessage._id,e.props.dialogId)}}],from:"message-error-actions-"+this.state.randomId}),l.a.createElement(ct.a,{className:"error",id:"message-error-actions-"+this.state.randomId,style:{marginTop:2,fontSize:16,color:"#FF3333"}}))))))}}]),a}(l.a.Component);var ut=Object(D.b)((function(e){return{myUser:e.user}}),(function(e){return{dialogsActions:Object(x.b)(s,e)}}))(Object(Ke.g)(pt)),dt=a(625),mt=a.n(dt),gt=Object(Ye.a)((function(e){return{root:{backgroundColor:"#008FF7",position:"absolute",bottom:20,right:20,"&:hover":{backgroundColor:"#008FF7"}}}}))(qe.a),ht=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={showBtnAdd:!0,scrollTop:0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.context.toggleHeader(!0)}},{key:"onScroll",value:function(){this.state.scrollTop<this.messagesBlock.getScrollTop()?this.state.showBtnAdd&&this.setState({showBtnAdd:!1}):this.state.showBtnAdd||this.setState({showBtnAdd:!0}),this.setState({scrollTop:this.messagesBlock.getScrollTop()})}},{key:"shouldComponentUpdate",value:function(e,t){return t.scrollTop===this.state.scrollTop}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"render",value:function(){var e,t=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6 sidebar",style:{overflow:"hidden"}},l.a.createElement("h2",{className:"sidebar-title"},"Chats"),l.a.createElement(C.Scrollbars,{ref:function(e){t.messagesBlock=e},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){t.onScroll()},style:{height:"calc(100% - 78px)"},autoHide:!0},this.props.dialogs.isFetching&&(e=l.a.createElement("div",{className:"room-item"},l.a.createElement(Ve.a,{variant:"circle",width:40,height:40}),l.a.createElement(Ve.a,{variant:"text",style:{marginLeft:12,flex:"1 1"}})),l.a.createElement(l.a.Fragment,null,e,e,e,e,e,e,e,e,e,e)),this.props.dialogs.dialogs.map((function(e,t){return e.lastMessage&&l.a.createElement(ut,{key:t,dialogId:e._id,typing:e.typing,noRead:e.noRead,lastMessage:e.lastMessage,user:e.user})}))),!this.props.dialogs.dialogs.find((function(e){return e.lastMessage}))&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(mt.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"You dont have chats, lets create new")),l.a.createElement(Qe.a,{title:"Create dialog",className:"scroll-to-bottom ".concat(this.state.showBtnAdd?"active":""),placement:"top"},l.a.createElement(gt,{color:"primary",size:"small","aria-label":"add",onClick:function(){t.props.history.push({search:"?act=newChat"})}},l.a.createElement(S.a,null)))))}}]),a}(l.a.Component);ht.contextType=f;var ft=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms,dialogs:e.dialogs}}),(function(e){return{dialogsActions:Object(x.b)(s,e)}}))(Object(Ke.g)(ht)),yt=a(37),Et=a.n(yt),bt=a(1457),Ot=a(1455),vt=function(e,t){return function(a){a({type:"ROOMS_SET_GET"}),fetch("".concat(_e,"/api/room/get-all"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({lang:t})}).then((function(e){return e.json()})).then((function(e){a({type:"ROOMS_GET",payload:e}),Ae.joinLang(t)})).catch((function(e){a({type:"ROOMS_GET_ERROR"})}))}},St=function(e){return function(t){t({type:"ROOMS_ADD",payload:e})}},jt=function(e){var t=e.id,a=e.apiToken;return function(e){fetch("".concat(_e,"/api/room/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({id:t,socketId:Ae.getSocketId()})}).then((function(e){return e.json()})).then((function(t){if(t.error)return ee("Error"),void e({type:"ROOMS_JOIN_ERROR",payload:t.errors[0]});t.dialog.messages=t.dialog.messages.reverse(),t.users.map((function(e){e.speaking=!1})),ee(t.title),e({type:"ROOMS_JOIN_ROOM",payload:{room:t,canLoad:50===t.dialog.messages.length}}),Ae.joinRoom({roomId:t._id,lang:t.lang});try{ve(t._id)}catch(a){Ae.leaveRoom({roomId:t._id,lang:t.lang}),e({type:"ROOMS_JOIN_ERROR",payload:{param:"all",msg:"something_goes_wrong"}})}})).catch((function(t){e({type:"ROOMS_JOIN_ERROR",payload:{param:"all",msg:"something_goes_wrong"}})}))}},Rt=function(e,t){return function(a){Se({roomId:e,lang:t}),a({type:"ROOMS_LEAVE_ROOM"})}},_t=function(e,t){return function(a){for(var s=new FormData,n=X(0,1e6),o=[],r=[],i=[],c=0;c<e.images.length;c++)s.append("images"+c,e.images[c].file),e.images[c].file=!1,o.push(e.images[c]);for(var l=0;l<e.files.length;l++)s.append("files"+l,e.files[l].file),e.files[l].file=!1,r.push(e.files[l]);for(var p=0;p<e.sounds.length;p++)s.append("sounds"+p,e.sounds[p].file),e.sounds[p].file=!1,i.push(e.sounds[p]);var u={_id:n,user:K.getState().user,text:e.text,images:o,sounds:i,files:r,isLoading:!0,isError:!1,isRead:!1,recentMessages:e.recentMessages,createdAt:Date.now()};a({type:"ROOMS_ADD_MESSAGE",payload:u});var d=[];e.recentMessages.map((function(e){d.push(e._id)})),e.recentMessages=d,e.socketId=Ae.getSocketId(),s.append("text",e.text),s.append("recentMessages",e.recentMessages),s.append("roomId",e.roomId),s.append("dialogId",e.dialogId),s.append("socketId",Ae.getSocketId()),fetch("".concat(_e,"/api/room/send-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:s}).then((function(e){return e.json()})).then((function(e){if(e.error)return a({type:"ROOMS_ERROR_MESSAGE",payload:n});a({type:"ROOMS_SUCCESS_MESSAGE",payload:{_id:n,_newId:e._id}})})).catch((function(){a({type:"ROOMS_ERROR_MESSAGE",payload:n})}))}},Mt=function(e,t){return function(a){for(var s=new FormData,n=[],o=[],r=[],i=[],c=[],l=[],p=0;p<e.images.length;p++)e.images[p].file?(s.append("images"+p,e.images[p].file),n.push(e.images[p])):i.push(e.images[p].id);for(var u=0;u<e.files.length;u++)e.files[u].file?(s.append("files"+u,e.files[u].file),o.push(e.files[u])):c.push(e.files[u].id);for(var d=0;d<e.sounds.length;d++)e.sounds[d].file?(s.append("sounds"+d,e.sounds[d].file),r.push(e.sounds[d])):l.push(e.sounds[d].id);var m={_id:e._id,user:K.getState().user,text:e.text,images:e.images,sounds:e.sounds,files:e.files,isLoading:!0,isError:!1,recentMessages:e.recentMessages};a({type:"ROOMS_EDIT_MESSAGE",payload:m});var g=[];e.recentMessages.map((function(e){g.push(e._id)})),e.recentMessages=g,e.socketId=Ae.getSocketId(),e.roomId=K.getState().rooms.activeRoom._id,s.append("_id",e._id),s.append("text",e.text),s.append("recentMessages",e.recentMessages),s.append("roomId",e.roomId),s.append("dialogId",e.dialogId),s.append("socketId",Ae.getSocketId()),s.append("oldImages",i),s.append("oldSounds",l),s.append("oldFiles",c),fetch("".concat(_e,"/api/room/edit-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:s}).then((function(e){return e.json()})).then((function(t){if(t.error)return a({type:"ROOMS_ERROR_MESSAGE",payload:e._id});a({type:"ROOMS_SUCCESS_MESSAGE",payload:{_id:e._id,_newId:e._id}})})).catch((function(){a({type:"ROOMS_ERROR_MESSAGE",payload:e._id})}))}},It=function(e,t){var a=e.roomId,s=e.deleteMessages;return function(e){var n=[];s.map((function(e){n.push(e._id)})),e({type:"ROOMS_DELETE_MESSAGE",payload:n}),fetch("".concat(_e,"/api/room/delete-message"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({roomId:a,messageIds:n,socketId:Ae.getSocketId()})}).then().catch((function(){}))}},At=function(e){return function(t){t({type:"ROOMS_DELETE_MESSAGE",payload:[e]})}},kt=function(e,t){return function(a){var s=new FormData,n=[],o={_id:e._id,user:K.getState().user,text:e.text,images:e.images,sounds:[],files:[],isLoading:!0,isError:!1,recentMessages:e.recentMessages,createdAt:Date.now()};a({type:"ROOMS_DELETE_MESSAGE",payload:[e._id]}),a({type:"ROOMS_ADD_MESSAGE",payload:o});for(var r=0;r<e.images.length;r++)s.append("images"+r,e.images[r].file),n.push(e.images[r].path);var i=[];e.recentMessages.map((function(e){i.push(e._id)})),e.recentMessages=i,e.socketId=Ae.getSocketId(),s.append("text",e.text),s.append("recentMessages",e.recentMessages),s.append("roomId",e.roomId),s.append("dialogId",e.dialogId),s.append("socketId",Ae.getSocketId()),fetch("".concat(_e,"/api/room/send-message"),{method:"post",headers:{Authorization:"Bearer ".concat(t)},body:s}).then((function(e){return e.json()})).then((function(t){a({type:"ROOMS_SUCCESS_MESSAGE",payload:{_id:e._id,_newId:t._id}})})).catch((function(){a({type:"ROOMS_ERROR_MESSAGE",payload:e._id})}))}},Nt=function(e,t){var a=e.dialogId,s=e.userId,n=e.roomId;return function(e){var o=K.getState().rooms.activeRoom.dialog.messages.filter((function(e){return!e.isRead&&e.user._id!==s}));setTimeout((function(){o.length&&e({type:"ROOMS_READ_MESSAGES",payload:s})}),750),o.length&&fetch("".concat(_e,"/api/room/read-messages"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({dialogId:a,roomId:n})}).then().catch((function(){}))}},Tt=function(e,t){var a=e.dialogId;e.userId,e.roomId;return function(e){var s=K.getState().rooms.activeRoom.dialog.messages[0];e({type:"ROOMS_SET_LOADING"}),e({type:"ROOMS_LOAD_MESSAGES",payload:{messages:[],canLoad:!1}}),fetch("".concat(_e,"/api/room/load-messages"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({dialogId:a,lastMessageId:s._id})}).then((function(e){return e.json()})).then((function(t){e({type:"ROOMS_LOAD_MESSAGES",payload:{messages:t.reverse(),canLoad:50===t.length}})})).catch((function(){}))}},Ct=a(130),Dt=a.n(Ct),xt=function(e,t){return function(a){fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(e){var t=e.user,s=e.friendStatus;t.friendStatus=s,a({type:"USERS_ADD",payload:t})}))}},wt=function(e){return function(t){fetch("".concat(_e,"/api/user/get-friends"),{method:"get",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){var a=[];e.map((function(e){a.push(e.recipient)})),t({type:"USERS_FRIENDS_GET",payload:{users:a,canLoad:15===a.length}})}))}},Ft=function(e){return function(t){fetch("".concat(_e,"/api/user/get-requested"),{method:"get",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){var a=[];e.map((function(e){a.push(e.recipient)})),t({type:"USERS_REQUESTED_GET",payload:{users:a,canLoad:15===a.length}})}))}},Lt=function(e){return function(t){fetch("".concat(_e,"/api/user/get-pending"),{method:"get",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){var a=[];e.map((function(e){a.push(e.recipient)})),t({type:"USERS_PENDING_GET",payload:{users:a,canLoad:15===a.length}})}))}},Ut=function(e){return function(t){for(var a=[],s=0;s<e.length;s++){var n=e[s].recipient;n.friendStatus=e[s].status,a.push(n)}t({type:"USERS_SET",payload:{friends:a,canLoad:10===a.length}})}},Bt=function(e){return function(t){t({type:"USERS_SET_ACTIVE_USER_ID",payload:e})}},Gt=function(e,t){return function(a){fetch("".concat(_e,"/api/user/request"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(s){a({type:"USERS_SET_FRIEND_STATUS",payload:{userId:e,friendStatus:s}}),K.getState().users.pending.getted&&(K.getState().users.users.find((function(t){return t._id===e}))?a({type:"USERS_PENDING_ADD",payload:{user:K.getState().users.users.find((function(t){return t._id===e}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(e){var t=e.user,s=e.friendStatus;t.friendStatus=s,a({type:"USERS_ADD",payload:t}),a({type:"USERS_PENDING_ADD",payload:{user:t}})})))}))}},zt=function(e,t){return function(a){fetch("".concat(_e,"/api/user/accept-request"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(s){a({type:"USERS_SET_FRIEND_STATUS",payload:{userId:e,friendStatus:s}}),K.getState().users.requested.getted&&a({type:"USERS_REQUESTED_REMOVE",payload:{userId:e}}),K.getState().users.friends.getted&&(K.getState().users.users.find((function(t){return t._id===e}))?a({type:"USERS_FRIENDS_ADD",payload:{user:K.getState().users.users.find((function(t){return t._id===e}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(e){var t=e.user,s=e.friendStatus;t.friendStatus=s,a({type:"USERS_ADD",payload:t}),a({type:"USERS_FRIENDS_ADD",payload:{user:t}})})))}))}},Pt=function(e,t){return function(a){fetch("".concat(_e,"/api/user/remove-request"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(s){a({type:"USERS_SET_FRIEND_STATUS",payload:{userId:e,friendStatus:s}}),K.getState().users.friends.getted&&2===s&&(a({type:"USERS_FRIENDS_REMOVE",payload:{userId:e}}),K.getState().users.requested.getted&&(K.getState().users.users.find((function(t){return t._id===e}))?a({type:"USERS_REQUESTED_ADD",payload:{user:K.getState().users.users.find((function(t){return t._id===e}))}}):fetch("".concat(_e,"/api/user/get"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e})}).then((function(e){return e.json()})).then((function(e){var t=e.user,s=e.friendStatus;t.friendStatus=s,a({type:"USERS_ADD",payload:t}),a({type:"USERS_REQUESTED_ADD",payload:{user:t}})})))),K.getState().users.pending.getted&&0===s&&a({type:"USERS_PENDING_REMOVE",payload:{userId:e}}),K.getState().users.requested.getted&&0===s&&a({type:"USERS_REQUESTED_REMOVE",payload:{userId:e}})}))}},Ht=Object(Ye.a)((function(e){return{root:{color:"#CCD1D6",display:"flex","&$checked":{color:"#008FF7",border:"none"},"&:hover":{backgroundColor:"transparent"}},checked:{}}}))(Ot.a),Jt=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Je.a,{className:"user-item",onClick:function(){e.props.onClick(e.props.user._id)}},l.a.createElement(j,{style:{minWidth:40,height:40,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(this.props.user.color,")")},name:this.props.user.name.first.charAt(0)+this.props.user.name.last.charAt(0)}),l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",width:"calc(100% - 82px)"}},l.a.createElement("p",{className:"user-name"},"".concat(this.props.user.name.first," ").concat(this.props.user.name.last)),!this.props.user.online&&l.a.createElement("p",{className:"last-message"},et(this.props.user.onlineAt)),this.props.user.online&&l.a.createElement("p",{className:"last-message",style:{color:"#35E551"}},"online")),"select"===this.props.type&&l.a.createElement(Ht,{checked:this.props.selected}))}}]),a}(l.a.Component),Wt=Object(D.b)((function(e){return{myUser:e.user}}))(Object(Ke.g)(Jt)),qt=a(1451),Vt=!1,Yt=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={q:"",searchResult:[]},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.users.friends.getted||this.props.usersActions.friendsGet(this.props.user.apiToken)}},{key:"onScroll",value:function(){}},{key:"onSearch",value:function(e){var t=this,a=e.target.value;this.setState({q:a}),Vt&&clearTimeout(Vt),a.length&&/\S/.test(a)&&(Vt=setTimeout((function(){fetch("".concat(_e,"/api/user/search"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t.props.user.apiToken)},body:JSON.stringify({q:t.state.q})}).then((function(e){return e.json()})).then((function(e){t.setState({searchResult:e})}))}),500)),a.length||this.setState({searchResult:[]})}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("input",{type:"text",value:this.state.q,onChange:function(t){e.onSearch(t)},className:"friends-search-input",placeholder:"Search"}),!this.state.searchResult.length&&!this.state.q.length&&l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){e.onScroll()},style:{height:340},autoHide:!0},this.props.users.friends.isFetching&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),this.props.users.friends.users.map((function(t,a){return l.a.createElement(Wt,{key:a,type:e.props.type,selected:"select"===e.props.type&&!!e.props.selectUsers.find((function(e){return e===t._id})),onClick:function(t){e.props.onClick(t)},user:t})})),!this.props.users.friends.users.length&&!this.props.users.friends.isFetching&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(Dt.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"You dont have friends, lets add him"))),(!!this.state.searchResult.length||!!this.state.q.length)&&l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){e.onScroll()},style:{height:340},autoHide:!0},this.state.searchResult.map((function(t,a){return l.a.createElement(Wt,{key:a,type:e.props.type,selected:"select"===e.props.type&&!!e.props.selectUsers.find((function(e){return e===t._id})),onClick:function(t){e.props.onClick(t)},user:t})})),!this.state.searchResult.length&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(Dt.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Users not found"))))}}]),a}(l.a.Component);var Qt=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(Yt)),$t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)"}},Kt={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"max-content",maxWidth:"320px",padding:"20px 0"}},Xt=Object(Ye.a)((function(e){return{root:{color:"#CCD1D6","&$checked":{color:"#008FF7",border:"none"},"&:hover":{backgroundColor:"transparent"}},checked:{}}}))(Ot.a),Zt=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={title:"",isPrivate:!1,step:"create",selectUsers:[],error:!1,errors:[]},e}return Object(m.a)(a,[{key:"onSubmit",value:function(e){var t=this;this.setState({error:!1,errors:[]}),e.preventDefault(),fetch("".concat(_e,"/api/room/create"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.user.apiToken)},body:JSON.stringify({title:this.state.title,isPrivate:this.state.isPrivate,lang:this.props.user.roomLang,selectUsers:this.state.selectUsers})}).then((function(e){return e.json()})).then((function(e){e.error?t.setState({error:!0,errors:e.errors,step:"create"}):(t.props.roomsActions.roomsAdd(e),Ae.createRoom({room:e,lang:t.props.user.roomLang}),t.props.history.push("/rooms/".concat(e._id)))}))}},{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:"create"===this.state.step?$t:Kt,contentLabel:"Create room"},"create"===this.state.step&&l.a.createElement("h2",{className:"modal-title"},"New room"),"invite"===this.state.step&&l.a.createElement("h2",{className:"modal-title"},"Select users"),l.a.createElement("form",{style:{display:"contents"},onSubmit:function(t){e.onSubmit(t)}},"create"===this.state.step&&l.a.createElement(l.a.Fragment,null,l.a.createElement("input",{value:this.state.title,onChange:function(t){e.setState({title:t.target.value})},className:"input-field",type:"text",style:{marginBottom:10},placeholder:"Title",maxLength:50}),this.state.errors.find((function(e){return"title"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"title"===e.param})).msg),l.a.createElement(bt.a,{control:l.a.createElement(Xt,{checked:this.state.isPrivate,onChange:function(){e.setState({isPrivate:!e.state.isPrivate})}}),style:{color:"#667788"},label:"Private theme"}),l.a.createElement("button",{className:"button-blue",onClick:function(){e.setState({step:"invite"})},style:{width:"max-content",marginTop:5}},"Next")),"invite"===this.state.step&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Qt,{onClick:function(t){e.state.selectUsers.find((function(e){return e===t}))?e.setState({selectUsers:Object(U.a)(e.state.selectUsers.filter((function(e){return e!==t})))}):e.setState({selectUsers:[t].concat(Object(U.a)(e.state.selectUsers))})},type:"select",selectUsers:this.state.selectUsers}),l.a.createElement("button",{className:"button-gray",onClick:function(){e.setState({step:"create"})},style:{width:"max-content",marginTop:5}},"Back"),l.a.createElement("button",{className:"button-blue",type:"submit",style:{width:"max-content",marginTop:5}},"Start"))))}}]),a}(l.a.Component);var ea=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(Zt)),ta=a(627),aa=a.n(ta),sa=Object(Ye.a)((function(e){return{root:{backgroundColor:"#008FF7",position:"absolute",bottom:20,right:20,"&:hover":{backgroundColor:"#008FF7"}}}}))(qe.a),na=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={isOpenCreateRoom:!1,scrollTop:0,showBtnAdd:!0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.context.toggleHeader(!0),this.props.rooms.getted||this.props.roomsActions.roomsGet(this.props.user.apiToken,this.props.user.roomLang)}},{key:"onScroll",value:function(){this.state.scrollTop<this.roomsBlock.getScrollTop()?this.state.showBtnAdd&&this.setState({showBtnAdd:!1}):this.state.showBtnAdd||this.setState({showBtnAdd:!0}),this.setState({scrollTop:this.roomsBlock.getScrollTop()})}},{key:"shouldComponentUpdate",value:function(e,t){return t.scrollTop===this.state.scrollTop}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6 sidebar",style:{overflow:"hidden"}},l.a.createElement("h2",{className:"sidebar-title"},"Rooms"),l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){e.onScroll()},style:{height:"calc(100% - 78px)"},autoHide:!0},this.props.rooms.isFetching&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),this.props.rooms.rooms.map((function(e,t){return l.a.createElement(We,{key:t,room:e})}))),!this.props.rooms.isFetching&&!this.props.rooms.isError&&!this.props.rooms.rooms.length&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(T.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Create your first room in this language")),!this.props.rooms.isFetching&&this.props.rooms.isError&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(aa.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"\u0427\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a..."),l.a.createElement("button",{onClick:function(){e.props.roomsActions.roomsGet(e.props.user.apiToken,e.props.user.roomLang)},className:"button-gray",type:"submit",style:{width:"max-content"}},"Retry")),l.a.createElement(Qe.a,{title:"Create room",className:"scroll-to-bottom ".concat(this.state.showBtnAdd?"active":""),placement:"top"},l.a.createElement(sa,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.history.push({search:"?act=newRoom"})}},l.a.createElement(S.a,null)))))}}]),a}(l.a.Component);na.contextType=f;var oa=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(na)),ra=function(e){return function(t){fetch("".concat(_e,"/api/notification/get-all"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){t({type:"NOTIFICATIONS_GET",payload:e})}))}},ia=function(e,t){return function(a){a({type:"NOTIFICATIONS_READ",payload:e}),fetch("".concat(_e,"/api/notification/read"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({id:e,socketId:Ae.getSocketId()})})}},ca=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={randomId:X(0,1e5)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Je.a,{className:"dialog-item",onClick:function(){e.props.notification.isRead||e.props.notificationsActions.notificationRead(e.props.notification._id,e.props.user.apiToken),"invite"===e.props.notification.type&&e.props.history.push("/rooms/".concat(e.props.notification.room._id)),"accept"!==e.props.notification.type&&"request"!==e.props.notification.type||e.props.history.push({search:"?user=".concat(e.props.notification.user._id)})}},l.a.createElement(j,{status:this.props.notification.type,style:{width:40,height:40,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(this.props.notification.user.color,")")},name:this.props.notification.user.name.first.charAt(0)+this.props.notification.user.name.last.charAt(0)}),l.a.createElement("div",null,l.a.createElement("p",{className:"user-name"},"".concat(this.props.notification.user.name.first," ").concat(this.props.notification.user.name.last)),"invite"===this.props.notification.type&&l.a.createElement("p",{className:"last-message"},"Invited you to the room\xa0",l.a.createElement("span",{style:{color:"#008FF7"}},this.props.notification.room.title)),"accept"===this.props.notification.type&&l.a.createElement("p",{className:"last-message"},"Accept your friend request"),"request"===this.props.notification.type&&l.a.createElement("p",{className:"last-message"},"Send you friend request")),l.a.createElement("div",{className:"dialog-info"},l.a.createElement("span",{className:"time-at"},Ze(this.props.notification.createdAt)),l.a.createElement($e.CSSTransitionGroup,{transitionName:"message-status-transition",transitionEnterTimeout:100,transitionLeaveTimeout:100},!this.props.notification.isRead&&l.a.createElement("span",{style:{background:"#FF3333",minWidth:10,height:10,marginTop:5},className:"unread-messages-count"}))))}}]),a}(l.a.Component);var la=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{notificationsActions:Object(x.b)(r,e)}}))(Object(Ke.g)(ca)),pa=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.context.toggleHeader(!0),this.props.notifications.getted||this.props.notificationsActions.notificationsGet(this.props.user.apiToken)}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6 sidebar"},l.a.createElement("h2",{className:"sidebar-title"},"Notifications"),l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",style:{height:"calc(100% - 78px)"},autoHide:!0},this.props.notifications.isFetching&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),this.props.notifications.notifications.map((function(e,t){return l.a.createElement(la,{key:t,notification:e})}))),!this.props.notifications.isFetching&&!this.props.notifications.notifications.length&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(I.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Here will placed your notifications"))))}}]),a}(l.a.Component);pa.contextType=f;var ua=Object(D.b)((function(e){return{user:e.user,notifications:e.notifications}}),(function(e){return{notificationsActions:Object(x.b)(r,e)}}))(Object(Ke.g)(pa)),da=function(e,t,a,s,n){return function(o){e.apiToken=n,o({type:"USER_LOGIN",payload:e});for(var r=0;r<t.length;r++)t[r].user=t[r].users.find((function(e){return e._id!==K.getState().user._id})),t[r].user||(t[r].user=t[r].users[0]),t[r].typing=!1,t[r].getted=!1,t[r].isLoading=!1,t[r].lastMessage&&(t[r].lastMessage.isLoading=!1,t[r].lastMessage.isError=!1),t[r].lastMessage&&t[r].lastMessage.user._id===K.getState().user._id&&(t[r].noRead=0);o({type:"DIALOGS_GET",payload:{dialogs:t,noReadCount:a}}),o({type:"NOTIFICATIONS_SET_NO_READ",payload:s})}},ma=function(){return function(e){e({type:"USER_LOGOUT"})}},ga=function(e){return function(t){t({type:"USER_UPDATE_ROOM_LANG",payload:e})}},ha=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.context.toggleHeader(!0)}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"updateRoomLang",value:function(e){this.props.userActions.updateRoomLang(e),this.props.history.push("/"),this.props.roomsActions.roomsGet(this.props.user.apiToken,e),Ae.joinLang(e),fetch("".concat(_e,"/api/user/update-room-lang"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.user.apiToken)},body:JSON.stringify({lang:e})})}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6 sidebar"},l.a.createElement("h2",{className:"sidebar-title"},"Language"),l.a.createElement("span",{style:{color:"eng"===this.props.user.roomLang?"red":"#000"},onClick:function(){e.updateRoomLang("eng")}},"English"),l.a.createElement("span",{style:{color:"rus"===this.props.user.roomLang?"red":"#000"},onClick:function(){e.updateRoomLang("rus")}},"Russian")))}}]),a}(l.a.Component);ha.contextType=f;var fa=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{userActions:Object(x.b)(i,e),roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(ha)),ya=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={activeTab:"languages"},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return this.props.show&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6 user-header"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(j,{style:{width:32,height:32,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(this.props.user.color,")")},name:this.props.user.name.first.charAt(0)+this.props.user.name.last.charAt(0)})),l.a.createElement("li",{style:{position:"relative"},className:"".concat("messages"===this.state.activeTab?"active":""),onClick:function(){e.setState({activeTab:"messages"})}},l.a.createElement(_.a,{style:{color:"#CCD1D6"}}),!!this.props.dialogs.noReadCount&&l.a.createElement("span",{className:"unread-messages-count",style:{top:11,right:"40%",transform:"translateX(50%)",backgroundColor:"#FF3333"}},this.props.dialogs.noReadCount)),l.a.createElement("li",{className:"".concat("rooms"===this.state.activeTab?"active":""),onClick:function(){e.setState({activeTab:"rooms"})}},l.a.createElement(T.a,{style:{color:"#CCD1D6"}})),l.a.createElement("li",{style:{position:"relative"},className:"".concat("notifications"===this.state.activeTab?"active":""),onClick:function(){e.setState({activeTab:"notifications"})}},l.a.createElement(I.a,{style:{color:"#CCD1D6"}}),!!this.props.notifications.noRead&&l.a.createElement("span",{className:"unread-messages-count",style:{top:11,right:"44%",transform:"translateX(50%)",backgroundColor:"#FF3333"}},this.props.notifications.noRead)),l.a.createElement("li",{className:"".concat("languages"===this.state.activeTab?"active":""),onClick:function(){e.setState({activeTab:"languages"})}},l.a.createElement(k.a,{style:{color:"#CCD1D6"}})))),"messages"===this.state.activeTab&&l.a.createElement(ft,null),"rooms"===this.state.activeTab&&l.a.createElement(oa,null),"notifications"===this.state.activeTab&&l.a.createElement(ua,null),"languages"===this.state.activeTab&&l.a.createElement(fa,null))}}]),a}(l.a.Component),Ea=Object(D.b)((function(e){return{user:e.user,dialogs:e.dialogs,notifications:e.notifications}}))(ya),ba=a(15),Oa=a(1452),va=(a(470),function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:"",error:!1,errors:[],isFetching:!1},e}return Object(m.a)(a,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.state.email&&this.state.password&&(this.setState({isFetching:!0}),fetch("".concat(_e,"/auth/login"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password})}).then((function(e){return e.json()})).then((function(e){e.error?t.setState({error:!0,errors:e.errors}):(t.props.cookies.set("apiToken",e.token,{path:"/"}),t.props.userActions.loginUser(e.user,e.dialogs,e.noReadCount,e.noReadNotifications,e.token),Ae.init(e.token));t.setState({isFetching:!1})})))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"login-page"},l.a.createElement("h1",{className:"logo"},l.a.createElement("span",{style:{color:"#556677"}},"heva"),l.a.createElement("span",{style:{color:"#008FF7"}},"chat")),l.a.createElement("form",{onSubmit:function(t){e.onSubmit(t)},className:"form"},l.a.createElement("input",{value:this.state.email,onChange:function(t){e.setState({email:t.target.value})},className:"input-field",type:"text",name:"email",placeholder:"E-mail"}),this.state.errors.find((function(e){return"email"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"email"===e.param})).msg),l.a.createElement("input",{value:this.state.password,onChange:function(t){e.setState({password:t.target.value})},className:"input-field",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.find((function(e){return"password"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"password"===e.param})).msg),this.state.errors.find((function(e){return"all"===e.param}))&&l.a.createElement("span",{style:{marginTop:30},className:"input-error-label"},this.state.errors.find((function(e){return"all"===e.param})).msg),l.a.createElement("button",{type:"submit",className:"button-gray"},"\u0412\u043e\u0439\u0442\u0438"),l.a.createElement("p",{className:"nav-auth"},"New to the site? ",l.a.createElement(He.b,{to:"/register"},"Sign up"))))}}]),a}(l.a.Component));var Sa=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{userActions:Object(x.b)(i,e)}}))(Object(Oa.a)(va)),ja=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={firstName:"",lastName:"",email:"",password:"",error:!1,errors:[],isFetching:!1},e}return Object(m.a)(a,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.state.email&&this.state.password&&(this.setState({isFetching:!0}),fetch("".concat(_e,"/auth/register"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({firstName:this.state.firstName,lastName:this.state.lastName,email:this.state.email,password:this.state.password})}).then((function(e){return e.json()})).then((function(e){e.error?t.setState({error:!0,errors:e.errors}):(t.props.cookies.set("apiToken",e.token,{path:"/"}),t.props.userActions.loginUser(e.user,e.dialogs,e.noReadCount,e.noReadNotifications,e.token),Ae.init(e.token));t.setState({isFetching:!1})})))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"login-page"},l.a.createElement("h1",{className:"logo"},l.a.createElement("span",{style:{color:"#556677"}},"heva"),l.a.createElement("span",{style:{color:"#008FF7"}},"chat")),l.a.createElement("form",{onSubmit:function(t){e.onSubmit(t)},className:"form"},l.a.createElement("input",{value:this.state.firstName,onChange:function(t){e.setState({firstName:t.target.value})},className:"input-field",type:"text",name:"firstName",placeholder:"First name"}),this.state.errors.find((function(e){return"firstName"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"firstName"===e.param})).msg),l.a.createElement("input",{value:this.state.lastName,onChange:function(t){e.setState({lastName:t.target.value})},className:"input-field",type:"text",name:"lastName",placeholder:"Last name"}),this.state.errors.find((function(e){return"lastName"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"lastName"===e.param})).msg),l.a.createElement("input",{value:this.state.email,onChange:function(t){e.setState({email:t.target.value})},className:"input-field",type:"text",name:"email",placeholder:"E-mail"}),this.state.errors.find((function(e){return"email"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"email"===e.param})).msg),l.a.createElement("input",{value:this.state.password,onChange:function(t){e.setState({password:t.target.value})},className:"input-field",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.find((function(e){return"password"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"password"===e.param})).msg),this.state.errors.find((function(e){return"all"===e.param}))&&l.a.createElement("span",{style:{marginTop:30},className:"input-error-label"},this.state.errors.find((function(e){return"all"===e.param})).msg),l.a.createElement("button",{type:"submit",className:"button-gray"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),l.a.createElement("p",{className:"nav-auth"},"Already have account? ",l.a.createElement(He.b,{to:"/login"},"Log in"))))}}]),a}(l.a.Component);var Ra=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{userActions:Object(x.b)(i,e)}}))(Object(Oa.a)(ja)),_a=a(258),Ma=a.n(_a),Ia=a(33),Aa=(a(962),a(632)),ka=a.n(Aa),Na=a(150),Ta=a.n(Na),Ca=a(149),Da=a.n(Ca),xa=a(633),wa=a.n(xa),Fa=a(96),La=a(630),Ua=a.n(La),Ba=a(631),Ga=a.n(Ba),za=!1,Pa=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={duration:"00:00",audio:!1,randomId:X(0,1e7)},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e,t=this,a=document.getElementsByName(this.props.src),s=Object(Fa.a)(a);try{for(s.s();!(e=s.n()).done;){var n=e.value;n.volume=.5,this.setState({audio:n});break}}catch(o){s.e(o)}finally{s.f()}document.getElementById(this.state.randomId).onloadedmetadata=function(){t.getDuration()}}},{key:"getDuration",value:function(){function e(e){return e<10?"0"+e:e}var t,a=document.getElementsByName(this.props.src),s=0,n=Object(Fa.a)(a);try{for(n.s();!(t=n.n()).done;){s=t.value.duration;break}}catch(o){n.e(o)}finally{n.f()}this.setState({duration:e(parseInt(s/60))+":"+e(parseInt(s%60))})}},{key:"componentWillUnmount",value:function(){za&&this.stopTimer(),this.state.audio&&(this.state.audio.parentElement.className="message-sound",this.state.audio.pause())}},{key:"playAudio",value:function(e){e.stopPropagation();var t=document.getElementsByClassName("message-sounds-element");this.stopTimer();var a,s=Object(Fa.a)(t);try{for(s.s();!(a=s.n()).done;){var n=a.value;n.parentElement.className="message-sound",n.pause()}}catch(l){s.e(l)}finally{s.f()}var o,r=document.getElementsByName(this.props.src),i=Object(Fa.a)(r);try{for(i.s();!(o=i.n()).done;){var c=o.value;c.parentElement.className="message-sound active",c.play()}}catch(l){i.e(l)}finally{i.f()}this.startTimer()}},{key:"changeDurationAudio",value:function(e){e.stopPropagation();var t,a=100*e.nativeEvent.layerX/this.rangeBlock.clientWidth,s=this.state.audio.duration/100*a,n=document.getElementsByName(this.props.src),o=Object(Fa.a)(n);try{for(o.s();!(t=o.n()).done;){t.value.currentTime=s}}catch(l){o.e(l)}finally{o.f()}var r,i=document.getElementsByName(this.props.src+"-range"),c=Object(Fa.a)(i);try{for(c.s();!(r=c.n()).done;){r.value.style.width=100*this.state.audio.currentTime/this.state.audio.duration+"%"}}catch(l){c.e(l)}finally{c.f()}}},{key:"startTimer",value:function(){var e=this;za=setInterval((function(){var t,a=document.getElementsByName(e.props.src+"-range"),s=Object(Fa.a)(a);try{for(s.s();!(t=s.n()).done;){t.value.style.width=100*e.state.audio.currentTime/e.state.audio.duration+"%"}}catch(n){s.e(n)}finally{s.f()}}),100)}},{key:"stopTimer",value:function(){clearInterval(za)}},{key:"viewDurationAudio",value:function(e){var t,a=100*e.nativeEvent.layerX/this.rangeBlock.clientWidth,s=this.state.audio.duration/100*a,n=document.getElementsByName(this.props.src+"-range"),o=Object(Fa.a)(n);try{for(o.s();!(t=o.n()).done;){t.value.style.width=100*s/this.state.audio.duration+"%"}}catch(r){o.e(r)}finally{o.f()}}},{key:"stopAudio",value:function(e){za&&this.stopTimer(),e.stopPropagation();var t,a=document.getElementsByName(this.props.src),s=Object(Fa.a)(a);try{for(s.s();!(t=s.n()).done;){var n=t.value;n.parentElement.className="message-sound",n.pause()}}catch(o){s.e(o)}finally{s.f()}}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"message-sound"},l.a.createElement("audio",{className:"message-sounds-element",id:this.state.randomId,name:this.props.src,src:this.props.src}),l.a.createElement("span",{className:"play",onClick:function(t){e.playAudio(t)}},l.a.createElement(Ua.a,{style:{color:"#008FF7"}})),l.a.createElement("span",{className:"pause",onClick:function(t){e.stopAudio(t)}},l.a.createElement(Ga.a,{style:{color:"#008FF7"}})),l.a.createElement("div",{className:"message-sound-info"},l.a.createElement("p",{className:"message-sounds-name"},this.props.fileName),l.a.createElement("p",{className:"message-sounds-duration"},this.state.duration)),l.a.createElement("div",{className:"message-sound-range",ref:function(t){e.rangeBlock=t},onMouseMove:function(t){e.viewDurationAudio(t)},onMouseEnter:function(){e.stopTimer()},onMouseLeave:function(){e.startTimer()},onClick:function(t){e.changeDurationAudio(t)}},l.a.createElement("span",{className:"range-position",ref:function(t){e.range=t},name:this.props.src+"-range"})))}}]),a}(l.a.Component),Ha=a(256),Ja=a.n(Ha),Wa=function(e,t,a){return l.a.createElement("a",{href:e,onClick:function(e){e.stopPropagation()},key:a,target:"_blank",rel:"noopener noreferrer"},t)},qa=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={randomId:X(0,1e5)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=!0,a=!1;if(this.props.messages[this.props.index-1]){var s=new Date(this.props.message.createdAt),n=new Date(this.props.messages[this.props.index-1].createdAt);s.getFullYear()===n.getFullYear()&&s.getMonth()===n.getMonth()&&s.getDate()===n.getDate()&&(t=!1),Math.abs(s-n)/36e5>1&&(a=!0)}var o=this.props.messages[this.props.index-1]&&this.props.messages[this.props.index-1].user._id!==this.props.message.user._id||!this.props.messages[this.props.index-1]||a;return l.a.createElement(l.a.Fragment,null,t&&l.a.createElement("div",{className:"history-date"},function(e){var t=new Date(e),a=(new Date).getDate()-t.getDate(),s=(new Date).getFullYear()-t.getFullYear(),n=t.getFullYear(),o=t.getMonth()+1,r=t.getDate();return s>0?n.toString()+"."+(o<10?"0"+o.toString():o.toString())+"."+(r<10?"0"+r.toString():r.toString()):(0===a?"Today":1===a&&"Yesterday")||0===s&&r+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][o-1]}(new Date(this.props.message.createdAt))),l.a.createElement("div",{className:"message ".concat(this.props.selected?"selected":""),onClick:function(t){e.props.message.isLoading||e.props.message.isError||(e.props.selected?e.props.unSelect(e.props.message._id):e.props.onSelect(e.props.message))},style:{background:this.props.isRecent?"none":this.props.message.isLoading||this.props.message.isError?"#fff":this.props.message.user._id===this.props.user._id||this.props.message.isRead?"":"#EFF4F8",cursor:this.props.message.isLoading||this.props.message.isError?"default":"",padding:this.props.isRecent?"8px 14px 8px 6px":""}},(o||t)&&!this.props.isRecent&&l.a.createElement("span",{onClick:function(t){t.stopPropagation(),e.props.history.push({search:"?user=".concat(e.props.message.user._id)})}},l.a.createElement(j,{style:{width:32,height:32,fontSize:14,lineHeight:"14px",fontWeight:600,backgroundColor:"rgb(".concat(this.props.message.user.color,")")},name:this.props.message.user.name.first.charAt(0)+this.props.message.user.name.last.charAt(0)})),!o&&!t&&!this.props.isRecent&&l.a.createElement("div",{style:{width:46}}),!this.props.message.isLoading&&!this.props.message.isError&&this.props.canSelect&&l.a.createElement("span",{className:"select-indicator ".concat(this.props.selected?"active":"")},l.a.createElement($e.CSSTransitionGroup,{transitionName:"message-status-transition",transitionEnterTimeout:100,transitionLeaveTimeout:100},this.props.selected&&l.a.createElement(ka.a,{style:{color:"#fff",fontSize:16,position:"absolute",top:0,left:0,right:0,bottom:0,margin:"auto"}}))),l.a.createElement("div",{className:"content col"},(o||t)&&l.a.createElement("h3",{onClick:function(t){t.stopPropagation(),e.props.history.push({search:"?user=".concat(e.props.message.user._id)})},className:"user-name",style:{color:this.props.message.user._id===this.props.user._id?"#FF3333":""}},"".concat(this.props.message.user.name.first," ").concat(this.props.message.user.name.last)," ",l.a.createElement("span",{className:"time-at"},Xe(this.props.message.createdAt))),this.props.message.text&&l.a.createElement("p",{className:"message-text"},l.a.createElement(Ja.a,{componentDecorator:Wa},this.props.message.text.replace(/&nbsp;/g,"").replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/(^\s*(?!.+)\n+)|(\n+\s+(?!.+)$)/g,"").replace(/(\r\n|\r|\n){2,}/g,"$1\n"))),!!this.props.message.recentMessages.length&&this.props.countRecent>1&&l.a.createElement("p",{className:"message-text"},"Attachmend messages [".concat(this.props.message.recentMessages.length,"]")),!!this.props.message.images.length&&l.a.createElement("div",{className:"message-images"},this.props.message.images.map((function(t,a,s){var n,o=!1;return n=s.length<=3&&2!==s.length&&0===a?"100%":"50%",s.length>4&&3===a&&(o=!0),a>3?null:o?l.a.createElement("div",{key:a,className:"image",style:{width:n}},l.a.createElement("div",{className:"image-blur",onClick:function(t){t.stopPropagation(),e.props.openSlider(s)}},l.a.createElement("span",null,"+".concat(s.length-3)),l.a.createElement("img",{draggable:"false",key:a,src:t.path,alt:t.name}))):l.a.createElement("div",{key:a,className:"image",style:{width:n}},l.a.createElement("img",{draggable:"false",onClick:function(t){t.stopPropagation(),e.props.openSlider(s)},src:t.path,alt:t.name}))}))),!!this.props.message.sounds.length&&l.a.createElement("div",{className:"message-sounds"},this.props.message.sounds.map((function(e,t,a){return l.a.createElement(Pa,{key:t,fileName:e.name,src:e.path})}))),!!this.props.message.files.length&&l.a.createElement("div",{className:"message-files"},this.props.message.files.map((function(e,t,a){return l.a.createElement("div",{className:"message-file",key:t,onClick:function(t){t.stopPropagation(),window.open(e.path,"_self")}},l.a.createElement(Da.a,{className:"file-icon",style:{color:"#008FF7"}}),l.a.createElement("div",{className:"message-file-info"},l.a.createElement("p",{className:"message-file-name"},e.name),l.a.createElement("p",{className:"message-file-size"},e.size>999?(e.size/1e3).toFixed(1)+" mb":Math.ceil(e.size)+" kb")),l.a.createElement(wa.a,{className:"download-icon",style:{color:"#008FF7"}}))}))),!!this.props.message.recentMessages.length&&this.props.countRecent<2&&l.a.createElement("div",{className:"message-recent"},this.props.message.recentMessages.map((function(t,a,s){return l.a.createElement(Va,{countRecent:e.props.countRecent+1,isRecent:!0,onSelect:function(){},openSlider:function(t){e.props.openSlider(t)},key:a,message:t,messages:s,index:a})})))),!this.props.isRecent&&l.a.createElement("div",{className:"message-status"},l.a.createElement($e.CSSTransitionGroup,{transitionName:"message-status-transition",transitionEnterTimeout:100,transitionLeaveTimeout:100},!this.props.canSelect&&!this.props.message.isLoading&&!this.props.message.isError&&this.props.message.isEdit&&l.a.createElement(Ta.a,{style:{color:"#B8C3CF"}}))),!this.props.isRecent&&l.a.createElement("div",{className:"message-status"},l.a.createElement($e.CSSTransitionGroup,{transitionName:"message-status-transition",transitionEnterTimeout:100,transitionLeaveTimeout:100},!this.props.canSelect&&this.props.message.user._id===this.props.user._id&&this.props.message.isLoading&&l.a.createElement(rt.a,{style:{color:"#B8C3CF"}}),!this.props.canSelect&&this.props.message.user._id===this.props.user._id&&!this.props.message.isLoading&&!this.props.message.isError&&!this.props.message.isRead&&l.a.createElement(at.a,{style:{color:"#B8C3CF"}}),!this.props.canSelect&&this.props.message.user._id===this.props.user._id&&!this.props.message.isLoading&&!this.props.message.isError&&this.props.message.isRead&&l.a.createElement(nt.a,{style:{color:"#008FF7"}}),!this.props.canSelect&&this.props.message.user._id===this.props.user._id&&!this.props.message.isLoading&&this.props.message.isError&&l.a.createElement(l.a.Fragment,null,l.a.createElement(lt,{actions:[{text:"Retry",action:function(){e.props.retrySendMessage(e.props.message)}},{text:"Delete",action:function(){e.props.deleteLocalMessage(e.props.message._id)}}],from:"message-error-actions-"+this.state.randomId}),l.a.createElement(ct.a,{className:"error",id:"message-error-actions-"+this.state.randomId,style:{color:"#FF3333"}}))))))}}]),a}(l.a.PureComponent);var Va=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(qa)),Ya=a(257),Qa=a.n(Ya),$a=a(634),Ka=a.n($a),Xa=!!document.documentMode,Za=!Xa&&!!window.StyleMedia,es=!1,ts=Object(Ye.a)((function(e){return{root:{backgroundColor:"#fff",position:"absolute",color:"#008FF7",bottom:20,right:20,zIndex:2,"&:hover":{backgroundColor:"#fff"}}}}))(qe.a),as=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={showFabToBottom:!1,activePage:!1,scrollTop:0},e}return Object(m.a)(a,[{key:"scrollToBottom",value:function(){this.messagesBlock&&(Za||Xa?this.messagesBlock.view.scrollTop=1e5:this.messagesBlock.view.scroll({top:1e5,left:0,behavior:"smooth"}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("blur",this.blurPage.bind(this)),window.removeEventListener("mousemove",this.focusPage.bind(this))}},{key:"focusPage",value:function(){var e,t=this;e=!(this.messagesBlock&&this.messagesBlock.getScrollTop()+this.messagesBlock.getClientHeight()<this.messagesBlock.getScrollHeight()),!this.state.activePage&&e&&this.props.unRead.length&&(es&&clearTimeout(es),this.props.readMessages(),this.setState({activePage:!0}),es=setTimeout((function(){t.setState({activePage:!1})}),3e3))}},{key:"blurPage",value:function(){this.setState({activePage:!1})}},{key:"componentDidMount",value:function(){window.addEventListener("blur",this.blurPage.bind(this)),window.addEventListener("mousemove",this.focusPage.bind(this)),this.messagesBlock&&(this.messagesBlock.view.scrollTop=1e5)}},{key:"componentDidUpdate",value:function(e){e.messages.length<this.props.messages.length&&JSON.stringify(e.messages[0])===JSON.stringify(this.props.messages[0])&&(this.messagesBlock.getScrollHeight()-this.messagesBlock.getClientHeight()-this.messagesBlock.getScrollTop()<this.messagesBlock.getClientHeight()/3||e.messages[e.messages.length-1].user._id===this.props.user._id)&&(this.state.activePage&&this.props.readMessages(),this.scrollToBottom(),this.state.showFabToBottom&&this.setState({showFabToBottom:!1})),JSON.stringify(e.messages[0])!==JSON.stringify(this.props.messages[0])&&this.messagesBlock.scrollTop(this.messagesBlock.getScrollHeight()-this.state.scrollTop)}},{key:"shouldComponentUpdate",value:function(e,t){return t.scrollTop===this.state.scrollTop}},{key:"onScroll",value:function(){this.setState({scrollTop:this.messagesBlock.getScrollHeight()-this.messagesBlock.getScrollTop()}),this.messagesBlock.getScrollTop()+this.messagesBlock.getClientHeight()<this.messagesBlock.getScrollHeight()-100?this.state.showFabToBottom||this.setState({showFabToBottom:!0}):this.state.showFabToBottom&&(this.setState({showFabToBottom:!1}),this.props.unRead.length&&this.props.readMessages()),"room"===this.props.type&&this.props.rooms.activeRoom.canLoad&&this.messagesBlock.getScrollTop()<100&&this.props.loadMessages(),"dialog"===this.props.type&&this.props.dialog.canLoad&&this.messagesBlock.getScrollTop()<100&&this.props.loadMessages()}},{key:"viewTypers",value:function(){return 1===this.props.rooms.activeRoom.typers.length?this.props.rooms.activeRoom.typers[0].name.first:2===this.props.rooms.activeRoom.typers.length?"".concat(this.props.rooms.activeRoom.typers[0].name.first," \u0438 ").concat(this.props.rooms.activeRoom.typers[1].name.first):"".concat(this.props.rooms.activeRoom.typers[0].name.first," \u0438 ").concat(this.props.rooms.activeRoom.typers.length-1)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"dialog-wrap"},l.a.createElement(C.Scrollbars,{onScroll:function(){e.onScroll()},ref:function(t){e.messagesBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"dialog scroll",autoHide:!0},("room"===this.props.type&&this.props.rooms.activeRoom.isLoading||"dialog"===this.props.type&&this.props.dialog.isLoading)&&l.a.createElement("div",{className:"dialog-loading"},l.a.createElement(qt.a,{style:{color:"#008FF7"}})),this.props.messages.map((function(t,a,s){return l.a.createElement(Va,{countRecent:0,isRecent:!1,openSlider:function(t){e.props.openSlider(t)},selected:e.props.recentMessages.find((function(e){return e._id===t._id})),canSelect:!!e.props.recentMessages.length,key:a,deleteLocalMessage:function(t){e.props.deleteLocalMessage(t)},retrySendMessage:function(t){e.props.retrySendMessage(t)},index:a,message:t,messages:s,onSelect:function(t){e.props.onSelect(t)},unSelect:function(t){e.props.unSelect(t)}})})),"room"===this.props.type&&l.a.createElement("div",{className:"dialog-typers"},!!this.props.rooms.activeRoom.typers.length&&l.a.createElement("p",{className:"typing"},this.viewTypers()," typing"),!this.props.rooms.activeRoom.typers.length&&l.a.createElement("p",{style:{height:18}})),"dialog"===this.props.type&&l.a.createElement("div",{className:"dialog-typers"},this.props.typing&&l.a.createElement("p",{className:"typing"},this.props.userName," typing"),!this.props.typing&&l.a.createElement("p",{style:{height:18}}))),l.a.createElement(ts,{className:"scroll-to-bottom ".concat(this.state.showFabToBottom?"active":""),color:"primary",size:"small","aria-label":"add",onClick:function(){e.scrollToBottom()}},!!this.props.unRead.length&&l.a.createElement("span",{className:"unread-messages-count"},this.props.unRead.length),l.a.createElement(Ka.a,{style:{color:"#99AABB"}})),"dialog"===this.props.type&&this.props.loading&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),!this.props.messages.length&&!this.props.loading&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(Qa.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Write your first message to ",this.props.to)))}}]),a}(l.a.Component),ss=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}))(as),ns=a(74),os=(a(1423),a(88)),rs=a.n(os),is=a(635),cs=a.n(is),ls=function(e,t,a){return l.a.createElement("a",{href:e,onClick:function(e){e.stopPropagation()},key:a,target:"_blank",rel:"noopener noreferrer"},t)},ps=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"dialog-attachment"},!!this.props.recentMessages.length&&l.a.createElement("div",{className:"message-attachment"},l.a.createElement(Je.a,{className:"btn-cancel-select",style:{width:60},onClick:function(){e.props.unSelectRecentMessages()}},l.a.createElement(rs.a,{style:{color:"#99AABB"}})),1===this.props.recentMessages.length&&l.a.createElement("div",{className:"col message-recent"},l.a.createElement("h3",{className:"user-name"},"".concat(this.props.recentMessages[0].user.name.first," ").concat(this.props.recentMessages[0].user.name.last)," ",l.a.createElement("span",{className:"time-at"},Xe(this.props.recentMessages[0].createdAt))),l.a.createElement("p",{className:"message-text"},l.a.createElement(Ja.a,{componentDecorator:ls},this.props.recentMessages[0].text?this.props.recentMessages[0].text:"\u0412\u043b\u043e\u0436\u0435\u043d\u0438\u044f [".concat(this.props.recentMessages[0].images.length+this.props.recentMessages[0].files.length+this.props.recentMessages[0].sounds.length+this.props.recentMessages[0].recentMessages.length,"]")))),this.props.recentMessages.length>1&&l.a.createElement("div",{className:"col message-recent"},l.a.createElement("h3",{className:"user-name"},"Attachment messages"),l.a.createElement("p",{className:"message-text"},"".concat(this.props.recentMessages.length," messages")))),!!this.props.images.length&&l.a.createElement("div",{className:"image-attachment"},this.props.images.map((function(t,a,s){return l.a.createElement("div",{key:a,className:"image-container",style:{marginRight:s[a+1]?5:0}},l.a.createElement("span",{className:"btn-delete-image",onClick:function(){e.props.removeImage(t.id)}},l.a.createElement(rs.a,{style:{color:"#fff"}})),l.a.createElement("img",{src:t.path,alt:"Attach"}))}))),!!this.props.sounds.length&&l.a.createElement("div",{className:"sound-attachment"},this.props.sounds.map((function(t,a,s){return l.a.createElement("div",{key:a,className:"sound-container"},l.a.createElement(Je.a,{className:"btn-cancel-select",style:{minWidth:60},onClick:function(){e.props.removeSound(t.id)}},l.a.createElement(rs.a,{style:{color:"#99AABB"}})),l.a.createElement(cs.a,{style:{color:"#008FF7"}}),l.a.createElement("p",{className:"sound-attachment-name"},t.name))}))),!!this.props.files.length&&l.a.createElement("div",{className:"sound-attachment"},this.props.files.map((function(t,a,s){return l.a.createElement("div",{key:a,className:"sound-container"},l.a.createElement(Je.a,{className:"btn-cancel-select",style:{minWidth:60},onClick:function(){e.props.removeFile(t.id)}},l.a.createElement(rs.a,{style:{color:"#99AABB"}})),l.a.createElement(Da.a,{style:{color:"#008FF7"}}),l.a.createElement("p",{className:"sound-attachment-name"},t.name))}))))}}]),a}(l.a.Component),us=a(637),ds=a.n(us),ms=a(636),gs=a.n(ms),hs=(a(1424),{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",padding:"0",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.5);",border:"none",width:"100%",height:"100vh"}}),fs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={index:0},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:!0,onRequestClose:function(){e.props.close()},style:hs,contentLabel:"Slider"},l.a.createElement("div",{className:"slider-close",onClick:function(){e.props.close()}},l.a.createElement(rs.a,{style:{color:"#fff",fontSize:30,opacity:.5}})),this.props.images[this.state.index-1]&&l.a.createElement("div",{className:"slider-prev",onClick:function(){e.setState({index:e.state.index-1})}},l.a.createElement(gs.a,{style:{color:"#fff",fontSize:45,opacity:.5}})),l.a.createElement("div",{className:"slider-image-container",onClick:function(){e.props.close()}},l.a.createElement("img",{className:"slider-image",src:this.props.images[this.state.index].path,alt:"Media from user"})),this.props.images[this.state.index+1]&&l.a.createElement("div",{className:"slider-next",onClick:function(){e.setState({index:e.state.index+1})}},l.a.createElement(ds.a,{style:{color:"#fff",fontSize:45,opacity:.5}})))}}]),a}(l.a.Component),ys=a(653),Es=a(638),bs=a.n(Es),Os=a(1450),vs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={inputMessageHeight:0,text:""},e}return Object(m.a)(a,[{key:"setText",value:function(e){this.setState({text:e})}},{key:"onPaste",value:function(e){for(var t=(e.clipboardData||e.originalEvent.clipboardData).items,a=0;a<t.length;a++)if("file"===t[a].kind){var s=t[a].getAsFile();this.props.addFile(s,!0)}}},{key:"componentDidUpdate",value:function(){this.props.isEdit&&(/\S/.test(this.state.text)||this.props.attachedRecentMessages.length||this.props.images.length||this.props.files.length||this.props.sounds.length||this.props.cancelEditMessage())}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"dialog-input ".concat(this.props.isShow?"":"d-none")},l.a.createElement(Os.a,{component:"label",className:"btn-add-files"},l.a.createElement(bs.a,{style:{transform:"rotate(45deg)",color:"#008FF7"}}),l.a.createElement("input",{type:"file",multiple:!0,onChange:function(t){e.props.addFile(t)},id:"uploadFile",style:{display:"none"},accept:"image/jpeg,image/gif,image/jpeg,image/png,application/pdf,text/plain,application/x-zip-compressed,application/zip,application/msword,audio/mpeg"})),l.a.createElement("textarea",{className:"col input-message",id:"input-message",onPaste:function(t){e.onPaste(t)},onKeyDown:function(t){(38!==t.keyCode||e.props.isEdit||e.state.text.length||e.props.setLastEditMessage(),13!==t.keyCode||t.shiftKey)||(t.preventDefault(),(/\S/.test(e.state.text)||e.props.attachedRecentMessages.length||e.props.images.length||e.props.files.length||e.props.sounds.length)&&(e.props.isEdit?(e.props.sendEditMessage(e.state.text),e.setState({text:""})):(e.props.sendMessage(e.state.text),e.setState({text:""})),document.getElementById("input-message").style.maxHeight="60px"))},onInput:function(){var e=document.getElementById("input-message");e.style.height="5px",e.style.height=e.scrollHeight+"px",e.scrollHeight>179?e.style.maxHeight="179px":e.style.maxHeight=e.scrollHeight+"px"},onChange:function(t){e.props.typing(t.target.value,e.state.text),e.setState({text:t.target.value})},value:this.state.text}),!this.state.text&&l.a.createElement("div",{className:"placeholder"},"Write message..."),!this.props.isEdit&&l.a.createElement($e.CSSTransitionGroup,{transitionName:"btn-send-message",transitionEnterTimeout:100,transitionLeaveTimeout:100},(/\S/.test(this.state.text)||!!this.props.files.length||!!this.props.images.length||!!this.props.sounds.length||!!this.props.attachedRecentMessages.length)&&l.a.createElement(Os.a,{onClick:function(){e.props.sendMessage(e.state.text),e.setState({text:""}),document.getElementById("input-message").style.maxHeight="60px"},className:"btn-send-message"},l.a.createElement(Qa.a,{style:{color:"#008FF7"}}))),this.props.isEdit&&l.a.createElement($e.CSSTransitionGroup,{transitionName:"btn-send-message",transitionEnterTimeout:100,transitionLeaveTimeout:100},JSON.stringify({text:this.props.editMessage.text,images:this.props.editMessage.images,sounds:this.props.editMessage.sounds,files:this.props.editMessage.files,attachedRecentMessages:this.props.editMessage.recentMessages})!==JSON.stringify({text:this.state.text,images:this.props.images,sounds:this.props.sounds,files:this.props.files,attachedRecentMessages:this.props.attachedRecentMessages})&&l.a.createElement(Os.a,{ref:function(e){e&&e.style.setProperty("margin-right","0","important")},onClick:function(){e.props.sendEditMessage(e.state.text),e.setState({text:""}),document.getElementById("input-message").style.maxHeight="60px"},className:"btn-send-message"},l.a.createElement(Ta.a,{style:{color:"#008FF7"}})),l.a.createElement(Os.a,{ref:function(e){e&&e.style.setProperty("margin-left","0","important")},onClick:function(){e.props.cancelEditMessage(),document.getElementById("input-message").style.maxHeight="60px"},className:"btn-send-message"},l.a.createElement(rs.a,{style:{color:"#008FF7"}}))),l.a.createElement(ys.a,{handleHeight:!0,onResize:function(t,a){e.setState({inputMessageHeight:a})}}))}}]),a}(l.a.Component),Ss=a(641),js=a.n(Ss),Rs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={inputMessageHeight:0},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"dialog-input"},l.a.createElement(Je.a,{className:"btn-reply",onClick:function(){e.props.addAttachmentRecentMessage()}},"Reply"),l.a.createElement(Je.a,{className:"btn-forward",onClick:function(){e.props.addAttachmentForwardMessage()}},"Forward"),l.a.createElement("div",{className:"col"}),!this.props.recentMessages.find((function(t){return t.user._id!==e.props.user._id}))&&1===this.props.recentMessages.length&&l.a.createElement(Je.a,{className:"btn-edit-message",onClick:function(){e.props.setEditMessage()}},l.a.createElement(Ta.a,{style:{color:"#99AABB"}})),!this.props.recentMessages.find((function(t){return t.user._id!==e.props.user._id}))&&l.a.createElement(Je.a,{className:"btn-delete-message",onClick:function(){e.props.deleteMessage()}},l.a.createElement(js.a,{style:{color:"#99AABB"}})),l.a.createElement(Je.a,{className:"btn-cancel-select",onClick:function(){e.props.cancelAttachmentRecentMessage()}},l.a.createElement(rs.a,{style:{color:"#99AABB"}})))}}]),a}(l.a.Component),_s=Object(D.b)((function(e){return{user:e.user}}))(Rs),Ms=!1,Is=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={recentMessages:[],attachedRecentMessages:s.props.dialogs.forwardMessages,sounds:[],files:[],images:[],inputMessageHeight:0,isOpenSlider:!1,sliderImages:[],isEdit:!1,editMessage:{},canTyping:!0,drag:!1},s.dropRef=l.a.createRef(),s.dragCounter=0,s.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},s.handleDragIn=function(e){e.preventDefault(),e.stopPropagation(),s.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&s.setState({drag:!0})},s.handleDragOut=function(e){e.preventDefault(),e.stopPropagation(),s.dragCounter--,0===s.dragCounter&&s.setState({drag:!1})},s.handleDrop=function(e){e.preventDefault(),e.stopPropagation(),s.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(s.handleDropFiles(e.dataTransfer.files),e.dataTransfer.clearData(),s.dragCounter=0)},s.handleDropFiles=function(e){for(var t=0;t<e.length;t++)s.addFile(e,!1,!0)},s.inputMessage=l.a.createRef(),s}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.dialogs.forwardMessages.length&&this.props.dialogsActions.setForward([]);var e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop);var t=Object(w.a)({},JSON.parse(localStorage.getItem("drafts")));t["draft-"+this.props.dialogId]&&this.inputMessage.current.setText(t["draft-"+this.props.dialogId])}},{key:"componentWillUnmount",value:function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}},{key:"sendMessage",value:function(e){if(/\S/.test(e)||this.state.attachedRecentMessages.length||this.state.images.length||this.state.files.length||this.state.sounds.length){var t=Object(w.a)({},JSON.parse(localStorage.getItem("drafts")));switch(t["draft-"+this.props.dialogId]="",localStorage.setItem("drafts",JSON.stringify(t)),this.props.type){case"room":this.props.roomsActions.sendMessage({text:e,roomId:this.props.roomId,images:this.state.images,files:this.state.files,sounds:this.state.sounds,dialogId:this.props.dialogId,recentMessages:this.state.attachedRecentMessages},this.props.user.apiToken);break;case"dialog":this.props.dialogsActions.sendMessage({text:e,userId:this.props.userId,images:this.state.images,files:this.state.files,sounds:this.state.sounds,dialogId:this.props.dialogId,recentMessages:this.state.attachedRecentMessages},this.props.user.apiToken)}this.setState({attachedRecentMessages:[],images:[],sounds:[],files:[]}),this.inputMessage.current.setText("")}}},{key:"sendEditMessage",value:function(e){if(/\S/.test(e)||this.state.attachedRecentMessages.length||this.state.images.length||this.state.sounds.length||this.state.files.length){switch(this.props.type){case"room":this.props.roomsActions.editMessage({_id:this.state.editMessage._id,text:e,roomId:this.props.roomId,images:this.state.images,files:this.state.files,sounds:this.state.sounds,dialogId:this.props.dialogId,recentMessages:this.state.attachedRecentMessages},this.props.user.apiToken);break;case"dialog":this.props.dialogsActions.editMessage({_id:this.state.editMessage._id,text:e,userId:this.props.userId,images:this.state.images,files:this.state.files,sounds:this.state.sounds,dialogId:this.props.dialogId,recentMessages:this.state.attachedRecentMessages},this.props.user.apiToken)}this.cancelEditMessage()}}},{key:"deleteMessage",value:function(){switch(this.props.type){case"room":this.props.roomsActions.deleteMessage({roomId:this.props.roomId,deleteMessages:this.state.recentMessages},this.props.user.apiToken);break;case"dialog":this.props.dialogsActions.deleteMessage({otherId:this.props.userId,dialogId:this.props.dialogId,deleteMessages:this.state.recentMessages},this.props.user.apiToken)}this.setState({recentMessages:[]})}},{key:"retrySendMessage",value:function(e){switch(this.props.type){case"room":e.roomId=this.props.rooms.activeRoom._id,e.dialogId=this.props.dialogId,this.props.roomsActions.retrySendMessage(e,this.props.user.apiToken);break;case"dialog":e.userId=this.props.userId,e.dialogId=this.props.dialogId,this.props.dialogsActions.retrySendMessage(e,this.props.user.apiToken)}}},{key:"deleteLocalMessage",value:function(e){switch(this.props.type){case"room":this.props.roomsActions.deleteLocalMessage(e);break;case"dialog":this.props.dialogsActions.deleteLocalMessage(e,this.props.dialogId)}}},{key:"addAttachmentRecentMessage",value:function(){this.setState({attachedRecentMessages:this.state.recentMessages,recentMessages:[]})}},{key:"addAttachmentForwardMessage",value:function(){this.props.dialogsActions.setForward(this.state.recentMessages),this.setState({recentMessages:[]})}},{key:"cancelAttachmentRecentMessage",value:function(){this.setState({recentMessages:[]})}},{key:"setEditMessage",value:function(){this.inputMessage.current.setText(this.state.recentMessages[0].text),this.state.recentMessages[0].images.map((function(e,t){e.id=t})),this.state.recentMessages[0].sounds.map((function(e,t){e.id=t})),this.state.recentMessages[0].files.map((function(e,t){e.id=t})),this.setState({images:this.state.recentMessages[0].images,sounds:this.state.recentMessages[0].sounds,files:this.state.recentMessages[0].files,recentMessages:[],attachedRecentMessages:this.state.recentMessages[0].recentMessages,isEdit:!0,editMessage:this.state.recentMessages[0]})}},{key:"setLastEditMessage",value:function(){var e=this,t=this.props.messages.slice().reverse().find((function(t){return t.user._id===e.props.user._id}));t.images.map((function(e,t){e.id=t})),t.sounds.map((function(e,t){e.id=t})),t.files.map((function(e,t){e.id=t})),t&&(this.inputMessage.current.setText(t.text),this.setState({images:t.images,sounds:t.sounds,files:t.files,recentMessages:[],attachedRecentMessages:t.recentMessages,isEdit:!0,editMessage:t}))}},{key:"cancelEditMessage",value:function(){this.inputMessage.current.setText(""),this.setState({images:[],sounds:[],files:[],recentMessages:[],attachedRecentMessages:[],isEdit:!1,editMessage:{}})}},{key:"readMessages",value:function(){var e=this;switch(Ms&&clearTimeout(Ms),this.props.type){case"room":Ms=setTimeout((function(){e.props.roomsActions.readMessages({dialogId:e.props.dialogId,roomId:e.props.roomId,userId:e.props.user._id},e.props.user.apiToken)}),1e3);break;case"dialog":Ms=setTimeout((function(){e.props.dialogsActions.readMessages({dialogId:e.props.dialogId,otherId:e.props.userId,userId:e.props.user._id},e.props.user.apiToken)}),1e3)}}},{key:"loadMessages",value:function(){switch(this.props.type){case"room":this.props.roomsActions.loadMessages({dialogId:this.props.dialogId},this.props.user.apiToken);break;case"dialog":this.props.dialogsActions.loadMessages({dialogId:this.props.dialogId},this.props.user.apiToken)}}},{key:"addFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(U.a)(this.state.sounds),n=Object(U.a)(this.state.files),o=Object(U.a)(this.state.images),r=s.length+n.length+o.length;if(!t&&!a){for(var i=0;i<e.target.files.length;i++){if(r>9){ns.b.error("Max upload 10 attachment!",{position:ns.b.POSITION.TOP_CENTER});break}var c={path:(window.URL||window.webkitURL).createObjectURL(new Blob([e.target.files[i]],{type:e.target.files[i].type})),file:e.target.files[i],name:e.target.files[i].name,type:e.target.files[i].name.split(".").pop(),size:e.target.files[i].size/1e3};"png"!==c.type&&"jpg"!==c.type&&"jpeg"!==c.type&&"gif"!==c.type||(c.id=o.length,o.push(c)),"txt"!==c.type&&"pdf"!==c.type&&"docx"!==c.type&&"zip"!==c.type&&"doc"!==c.type||(c.id=n.length,n.push(c)),"mp3"===c.type&&(c.id=s.length,s.push(c)),r++}e.target.value=null}if(t)if(r>9)ns.b.error("Max upload 10 attachment!",{position:ns.b.POSITION.TOP_CENTER});else{var l={id:o.length,path:(window.URL||window.webkitURL).createObjectURL(new Blob([e],{type:e.type})),file:e,name:e.name,type:e.name.split(".").pop()};o.push(l)}if(a)for(var p=0;p<e.length;p++){if(r>9){ns.b.error("Max upload 10 attachment!",{position:ns.b.POSITION.TOP_CENTER});break}var u={path:(window.URL||window.webkitURL).createObjectURL(new Blob([e[p]],{type:e[p].type})),file:e[p],name:e[p].name,type:e[p].name.split(".").pop(),size:e[p].size/1e3};"png"!==u.type&&"jpg"!==u.type&&"jpeg"!==u.type&&"gif"!==u.type||(u.id=o.length,o.push(u)),"txt"!==u.type&&"pdf"!==u.type&&"docx"!==u.type&&"zip"!==u.type&&"doc"!==u.type||(u.id=n.length,n.push(u)),"mp3"===u.type&&(u.id=s.length,s.push(u)),r++}this.setState({sounds:s,files:n,images:o})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.canTyping===t.canTyping}},{key:"typing",value:function(e,t){var a=this;if(e>t&&!this.state.isEdit&&this.state.canTyping){switch(this.setState({canTyping:!1}),this.props.type){case"room":Ae.typingRoom(this.props.rooms.activeRoom._id);break;case"dialog":Ae.typingDialog(this.props.userId,this.props.user._id)}setTimeout((function(){a.setState({canTyping:!0})}),2500)}if(!this.state.isEdit){var s=Object(w.a)({},JSON.parse(localStorage.getItem("drafts")));s["draft-"+this.props.dialogId]=e,s["draft-"+this.props.dialogId]&&/\S/.test(s["draft-"+this.props.dialogId])||delete s["draft-"+this.props.dialogId],localStorage.setItem("drafts",JSON.stringify(s))}}},{key:"render",value:function(){var e,t=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"dialog-container",ref:this.dropRef},this.state.drag&&l.a.createElement("div",{className:"drag-and-drop-container"},l.a.createElement("div",{className:"data-empty"},l.a.createElement(Da.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Drag & drop files here to attach"))),this.state.isOpenSlider&&l.a.createElement(fs,{images:this.state.sliderImages,close:function(){t.setState({isOpenSlider:!1,sliderImages:[]})}}),l.a.createElement(ss,{loadMessages:function(){t.loadMessages()},retrySendMessage:function(e){t.retrySendMessage(e)},deleteLocalMessage:function(e){t.deleteLocalMessage(e)},messages:this.props.messages,to:this.props.to,dialog:this.props.dialog,userName:this.props.userName,typing:this.props.typing,loading:this.props.loading,type:this.props.type,unRead:this.props.messages.filter((function(e){return!e.isRead&&e.user._id!==t.props.user._id})),recentMessages:this.state.recentMessages,openSlider:function(e){t.setState({sliderImages:e,isOpenSlider:!0})},onSelect:function(e){t.setState({recentMessages:[].concat(Object(U.a)(t.state.recentMessages),[e])})},unSelect:function(e){t.setState({recentMessages:Object(U.a)(t.state.recentMessages.filter((function(t){return t._id!==e})))})},readMessages:function(){t.readMessages()}}),l.a.createElement($e.CSSTransitionGroup,{transitionName:"scroll-to-bottom",transitionEnterTimeout:100,transitionLeaveTimeout:100},(!!this.state.attachedRecentMessages.length||!!this.state.images.length||!!this.state.sounds.length||!!this.state.files.length)&&l.a.createElement(ps,{images:this.state.images,recentMessages:this.state.attachedRecentMessages,files:this.state.files,sounds:this.state.sounds,unSelectRecentMessages:function(){t.setState({attachedRecentMessages:[]})},removeImage:function(e){t.setState({images:Object(U.a)(t.state.images.filter((function(t){return t.id!==e})))})},removeSound:function(e){t.setState({sounds:Object(U.a)(t.state.sounds.filter((function(t){return t.id!==e})))})},removeFile:function(e){t.setState({files:Object(U.a)(t.state.files.filter((function(t){return t.id!==e})))})}})),l.a.createElement(vs,(e={isShow:!this.state.recentMessages.length,ref:this.inputMessage,cancelEditMessage:function(){t.cancelEditMessage()},isEdit:this.state.isEdit,editMessage:this.state.editMessage,sendEditMessage:function(e){t.sendEditMessage(e)}},Object(Ia.a)(e,"cancelEditMessage",(function(){t.cancelEditMessage()})),Object(Ia.a)(e,"images",this.state.images),Object(Ia.a)(e,"sounds",this.state.sounds),Object(Ia.a)(e,"files",this.state.files),Object(Ia.a)(e,"attachedRecentMessages",this.state.attachedRecentMessages),Object(Ia.a)(e,"sendMessage",(function(e){t.sendMessage(e)})),Object(Ia.a)(e,"typing",(function(e,a){t.typing(e,a)})),Object(Ia.a)(e,"addFile",(function(e,a){t.addFile(e,a)})),Object(Ia.a)(e,"setLastEditMessage",(function(){t.setLastEditMessage()})),e)),!!this.state.recentMessages.length&&l.a.createElement(_s,{addAttachmentRecentMessage:function(){t.addAttachmentRecentMessage()},cancelAttachmentRecentMessage:function(){t.cancelAttachmentRecentMessage()},addAttachmentForwardMessage:function(){t.addAttachmentForwardMessage()},deleteMessage:function(){t.deleteMessage()},recentMessages:this.state.recentMessages,setEditMessage:function(){t.setEditMessage()}})))}}]),a}(l.a.Component);var As=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms,dialogs:e.dialogs}}),(function(e){return{roomsActions:Object(x.b)(n,e),dialogsActions:Object(x.b)(s,e)}}))(Is),ks={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",textAlign:"center"}},Ns=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,style:ks,contentLabel:"Error join room"},l.a.createElement(ct.a,{style:{color:"#FF3333",fontSize:60}}),l.a.createElement("h2",{className:"modal-title"},"Error"),l.a.createElement("p",{className:"modal-text"},this.props.rooms.activeRoom.error.msg),l.a.createElement("button",{className:"button-blue",type:"submit",style:{width:"max-content"},onClick:function(){e.props.history.push("/")}},"Back"))}}]),a}(l.a.Component),Ts=Object(D.b)((function(e){return{rooms:e.rooms}}))(Object(Ke.g)(Ns)),Cs=a(642),Ds=a.n(Cs),xs=a(643),ws=a.n(xs),Fs=a(644),Ls=a.n(Fs),Us=Object(Ye.a)((function(e){return{root:{backgroundColor:"#fff",color:"#008FF7",zIndex:2,"&:hover":{backgroundColor:"#fff"}}}}))(qe.a),Bs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return l.a.createElement(C.Scrollbars,{renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"theme-members scroll",autoHide:!0},this.props.users.map((function(e,t){return l.a.createElement("div",{key:t,className:"member"},l.a.createElement(j,{name:e.name.first.charAt(0)+e.name.last.charAt(0),style:{fontSize:30,borderRadius:0,width:"100%",height:"100%",backgroundColor:"rgb(".concat(e.color,")")}}),e.speaking&&l.a.createElement("span",{className:"speaking"}))})))}}]),a}(l.a.Component),Gs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.audio.srcObject=this.props.stream}},{key:"render",value:function(){var e=this;return l.a.createElement("audio",{ref:function(t){e.audio=t},style:{display:"none"},autoPlay:!0,controls:!0})}}]),a}(l.a.PureComponent),zs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.toggleHeader(!1);var t=setInterval((function(){Ae.getSocketId()&&(e.props.roomsActions.joinRoom({id:e.props.match.params.id,apiToken:e.props.user.apiToken}),clearInterval(t))}),100)}},{key:"componentWillUnmount",value:function(){this.props.roomsActions.leaveRoom(this.props.rooms.activeRoom._id,this.props.rooms.activeRoom.lang)}},{key:"render",value:function(){var e=this;return this.props.rooms.activeRoom&&this.props.rooms.activeRoom.error?l.a.createElement(Ts,{isOpen:!0}):this.props.rooms.activeRoom&&l.a.createElement(l.a.Fragment,null,this.props.rooms.activeRoom.remoteStream&&l.a.createElement(Gs,{stream:this.props.rooms.activeRoom.remoteStream}),l.a.createElement("div",{className:"col-xl-3 col-lg-6 col-md-6"},l.a.createElement("div",{className:"theme-header"},l.a.createElement(Os.a,{className:"back-btn",onClick:function(){e.props.history.push("/")}},l.a.createElement(Ma.a,{fontSize:"small",style:{color:"#008FF7"}})),l.a.createElement("div",{className:"theme-info",id:this.props.rooms.activeRoom._id},l.a.createElement("h2",{className:"theme-title"},this.props.rooms.activeRoom.title),l.a.createElement("h3",{className:"theme-online-counter"},this.props.rooms.activeRoom.users.length+1," online")),l.a.createElement(lt,{actions:this.props.rooms.activeRoom.ownerId===this.props.user._id?[{text:"Invite friends",action:function(){e.props.history.push({search:"?act=invite"})}},{text:"Edit room",action:function(){e.props.history.push({search:"?act=editRoom"})}},{text:"Delete room",action:function(){e.props.history.push({search:"?act=deleteRoom"})}}]:[{text:"Invite friends",action:function(){e.props.history.push({search:"?act=invite"})}}],from:this.props.rooms.activeRoom._id,bottom:!0})),l.a.createElement("div",{className:"theme-sidebar"},l.a.createElement(As,{messages:this.props.rooms.activeRoom.dialog.messages,type:"room",to:this.props.rooms.activeRoom.title,dialogId:this.props.rooms.activeRoom.dialog._id,roomId:this.props.rooms.activeRoom._id}))),l.a.createElement("div",{className:"col-xl-9 col-lg-6 col-md-6 theme-screen"},this.props.rooms.activeRoom&&l.a.createElement(Bs,{users:this.props.rooms.activeRoom.users}),l.a.createElement("div",{className:"media-options"},l.a.createElement(Us,{className:"media-option ".concat(this.props.media.micOn?"active":""),onClick:function(){be()}},l.a.createElement(Ds.a,{style:{color:this.props.media.micOn?"#fff":"#008FF7"}})),l.a.createElement(Us,{className:"media-option ".concat(this.props.media.musicOn?"":"active"),onClick:function(){Oe()}},l.a.createElement(ws.a,{style:{color:this.props.media.musicOn?"#008FF7":"#fff"}})),l.a.createElement(Us,{className:"media-option reject",onClick:function(){e.props.history.push("/")}},l.a.createElement(Ls.a,{style:{color:"#fff"}})))))}}]),a}(l.a.Component);zs.contextType=f;var Ps=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms,media:e.media}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(zs)),Hs=(Object(Ye.a)((function(e){return{root:{backgroundColor:"#008FF7",position:"absolute",bottom:20,right:20,"&:hover":{backgroundColor:"#008FF7"}}}}))(qe.a),function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={showBtnAdd:!0,scrollTop:0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.context.toggleHeader(!0)}},{key:"onScroll",value:function(){this.state.scrollTop<this.messagesBlock.getScrollTop()?this.state.showBtnAdd&&this.setState({showBtnAdd:!1}):this.state.showBtnAdd||this.setState({showBtnAdd:!0}),this.setState({scrollTop:this.messagesBlock.getScrollTop()})}},{key:"shouldComponentUpdate",value:function(e,t){return t.scrollTop===this.state.scrollTop}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-md-9",style:{order:2}}),l.a.createElement("div",{className:"col-md-9",style:{order:4}}))}}]),a}(l.a.Component));Hs.contextType=f;var Js=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms,dialogs:e.dialogs}}))(Hs),Ws=a(645),qs=a.n(Ws),Vs=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={showBtnAdd:!0,scrollTop:0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.toggleHeader(!0),window.innerWidth<769&&this.context.toggleHeader(!1),this.props.dialogs.dialogs.find((function(t){return t.user._id===e.props.match.params.id}))?(this.props.dialogsActions.updateOnline(this.props.match.params.id,this.props.user.apiToken),this.props.dialogs.dialogs.find((function(t){return t.user._id===e.props.match.params.id})).getted||this.props.dialogsActions.dialogLoad(this.props.match.params.id,this.props.user.apiToken)):this.props.dialogsActions.dialogGet(this.props.match.params.id,this.props.user.apiToken)}},{key:"componentWillUnmount",value:function(){this.context.toggleHeader(!1)}},{key:"render",value:function(){var e=this,t=this.props.dialogs.dialogs.find((function(t){return t.user._id===e.props.match.params.id}));return l.a.createElement(l.a.Fragment,null,t&&!t.isNotFound&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-9 col-lg-6 col-md-6 dialog-header",style:{order:2}},l.a.createElement(Os.a,{className:"back-btn",onClick:function(){e.props.history.push("/")}},l.a.createElement(Ma.a,{fontSize:"small",style:{color:"#008FF7"}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{display:"contents"},onClick:function(){e.props.history.push({search:"?user=".concat(t.user._id)})}},l.a.createElement(j,{style:{width:32,height:32,fontSize:14,fontWeight:600,backgroundColor:"rgb(".concat(t.user.color,")")},name:t.user.name.first.charAt(0)+t.user.name.last.charAt(0)})),l.a.createElement("div",{className:"user-info",onClick:function(){e.props.history.push({search:"?user=".concat(t.user._id)})}},l.a.createElement("p",{className:"user-name"},"".concat(t.user.name.first," ").concat(t.user.name.last)),!t.user.online&&l.a.createElement("p",{className:"last-message"},et(t.user.onlineAt)),t.user.online&&l.a.createElement("p",{className:"last-message",style:{color:"#35E551"}},"online")))),l.a.createElement("div",{className:"col-xl-9 col-lg-6 col-md-6",style:{order:4}},l.a.createElement(As,{messages:t.messages,loading:t&&!t.getted,type:"dialog",userName:t.user.name.first,typing:t.typing,userId:t.user._id,to:t.user.name.first,dialogId:t._id,dialog:t}))),t&&t.isNotFound&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"col-xl-9 col-lg-6 col-md-6",style:{order:2}}),l.a.createElement("div",{className:"col-xl-9 col-lg-6 col-md-6",style:{order:4}},l.a.createElement("div",{className:"data-empty"},l.a.createElement(qs.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"User not found")))))}}]),a}(l.a.PureComponent);Vs.contextType=f;var Ys=Object(D.b)((function(e){return{user:e.user,dialogs:e.dialogs}}),(function(e){return{dialogsActions:Object(x.b)(s,e),usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(Vs)),Qs=[{path:"/login",exact:!0,type:"auth",title:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f",component:function(){return l.a.createElement(Sa,null)}},{path:"/register",exact:!0,type:"auth",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",component:function(){return l.a.createElement(Ra,null)}},{path:"/",exact:!0,type:"user",title:"Home",component:function(){return l.a.createElement(Js,null)}},{path:"/languages",exact:!0,type:"user",title:"Languages",component:function(){return l.a.createElement(fa,null)}},{path:"/chats/:id",exact:!0,type:"user",title:"",component:function(){return l.a.createElement(Ys,{key:X(0,1e3)})}},{path:"/rooms/:id",exact:!0,type:"user",title:"",component:function(){return l.a.createElement(Ps,null)}}],$s=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return 404}}]),a}(l.a.Component),Ks=a(131),Xs=a.n(Ks),Zs=a(650),en=a.n(Zs),tn=a(646),an=a.n(tn),sn=a(649),nn=a.n(sn),on=a(648),rn=a.n(on),cn=a(647),ln=a.n(cn),pn=Object(Ye.a)((function(e){return{root:{backgroundColor:"#EDF0F3",boxShadow:"none!important","&:hover":{backgroundColor:"#008FF7"},"&:hover svg":{color:"#fff!important"},"& svg":{transition:"all 0.25s"}}}}))(qe.a),un=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(j,{style:{width:80,height:80,fontSize:28,lineHeight:"28px",fontWeight:600,backgroundColor:"rgb(".concat(this.props.user.color,")")},name:this.props.user.name.first.charAt(0)+this.props.user.name.last.charAt(0)}),l.a.createElement("p",{className:"user-profile-name"},this.props.user.name.first," ",this.props.user.name.last),l.a.createElement("p",{className:"user-profile-city"},"Moscow"),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"user-btn"},l.a.createElement(He.c,{style:{textDecoration:"none"},onClick:function(t){"/chats/".concat(e.props.user._id)===e.props.history.location.pathname&&t.preventDefault()},className:"dialog-link",to:"/chats/".concat(this.props.user._id)},l.a.createElement(pn,{color:"primary",size:"small","aria-label":"add",onClick:function(){}},l.a.createElement(an.a,{style:{color:"#99AABB"}}))),l.a.createElement("p",null,"Message")),0===this.props.user.friendStatus&&l.a.createElement("div",{className:"user-btn"},l.a.createElement(pn,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.usersActions.sendRequest(e.props.userId,e.props.myUser.apiToken)}},l.a.createElement(ln.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"+ Friend")),2===this.props.user.friendStatus&&l.a.createElement("div",{className:"user-btn"},l.a.createElement(pn,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.usersActions.acceptRequest(e.props.userId,e.props.myUser.apiToken)}},l.a.createElement(rn.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Accept")),(2===this.props.user.friendStatus||1===this.props.user.friendStatus)&&l.a.createElement("div",{className:"user-btn"},l.a.createElement(pn,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.usersActions.removeRequest(e.props.userId,e.props.myUser.apiToken)}},l.a.createElement(nn.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Decline")),3===this.props.user.friendStatus&&l.a.createElement("div",{className:"user-btn"},l.a.createElement(pn,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.usersActions.removeRequest(e.props.userId,e.props.myUser.apiToken)}},l.a.createElement(en.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Remove"))))}}]),a}(l.a.Component);var dn=Object(D.b)((function(e){return{users:e.users,myUser:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(un)),mn=a(362),gn=a.n(mn),hn=a(651),fn=a.n(hn),yn=a(652),En=a.n(yn),bn=Object(Ye.a)((function(e){return{root:{backgroundColor:"#EDF0F3",boxShadow:"none!important","&:hover":{backgroundColor:"#008FF7"},"&:hover svg":{color:"#fff!important"},"& svg":{transition:"all 0.25s"}}}}))(qe.a),On=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={activeTab:"main"},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(j,{style:{width:80,height:80,fontSize:28,lineHeight:"28px",fontWeight:600,backgroundColor:"rgb(".concat(this.props.user.color,")")},name:this.props.user.name.first.charAt(0)+this.props.user.name.last.charAt(0)}),l.a.createElement("p",{className:"user-profile-name"},this.props.user.name.first," ",this.props.user.name.last),l.a.createElement("p",{className:"user-profile-city"},"Moscow"),l.a.createElement("div",{className:"user-btn"},l.a.createElement(bn,{color:"primary",size:"small","aria-label":"add",onClick:function(){}},l.a.createElement(fn.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Settings")),l.a.createElement("div",{className:"user-btn"},l.a.createElement(bn,{color:"primary",size:"small","aria-label":"add",onClick:function(){e.props.history.push({search:"?modal=contacts"})}},l.a.createElement(gn.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Contacts")),l.a.createElement("div",{className:"user-btn"},l.a.createElement(bn,{color:"primary",size:"small","aria-label":"add",onClick:function(){}},l.a.createElement(En.a,{style:{color:"#99AABB"}})),l.a.createElement("p",null,"Media")))}}]),a}(l.a.Component);var vn=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(On)),Sn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"300px"}},jn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.users.users.find((function(t){return t._id===e.props.userId}))||this.props.user._id===this.props.userId||this.props.usersActions.userGet(this.props.userId,this.props.user.apiToken)}},{key:"render",value:function(){var e=this,t=this.props.users.users.find((function(t){return t._id===e.props.userId}));return l.a.createElement(Et.a,{isOpen:!0,onRequestClose:function(){e.props.close()},style:Sn,contentLabel:"User"},t&&l.a.createElement(dn,{userId:this.props.userId,user:t}),this.props.user._id===this.props.userId&&l.a.createElement(vn,null))}}]),a}(l.a.Component);var Rn=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(jn)),_n=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.users.requested.getted||this.props.usersActions.requestedGet(this.props.user.apiToken)}},{key:"onScroll",value:function(){}},{key:"render",value:function(){var e=this;return l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){e.onScroll()},style:{height:340},autoHide:!0},this.props.users.requested.isFetching&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),this.props.users.requested.users.map((function(e,t){return l.a.createElement(Wt,{key:t,user:e})})),!this.props.users.requested.users.length&&!this.props.users.requested.isFetching&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(Dt.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Incoming requests will be displayed here")))}}]),a}(l.a.Component);var Mn=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(_n)),In=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.users.pending.getted||this.props.usersActions.pendingGet(this.props.user.apiToken)}},{key:"onScroll",value:function(){}},{key:"render",value:function(){var e=this;return l.a.createElement(C.Scrollbars,{ref:function(t){e.roomsBlock=t},renderTrackVertical:function(e){return l.a.createElement("div",{className:"track-vertical"})},renderThumbVertical:function(e){return l.a.createElement("div",{className:"thumb-vertical"})},className:"scroll",onScroll:function(){e.onScroll()},style:{height:340},autoHide:!0},this.props.users.pending.isFetching&&l.a.createElement(qt.a,{style:{color:"#008FF7",position:"absolute",left:0,right:0,margin:"auto",top:"calc(50% - 20px)"}}),this.props.users.pending.users.map((function(e,t){return l.a.createElement(Wt,{key:t,user:e})})),!this.props.users.pending.users.length&&!this.props.users.pending.isFetching&&l.a.createElement("div",{className:"data-empty"},l.a.createElement(Dt.a,{style:{color:"#B8C3CF",fontSize:54,margin:"0 auto",display:"block"}}),l.a.createElement("p",null,"Outgoing requests will be displayed here")))}}]),a}(l.a.Component);var An=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(In)),kn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"max-content",maxWidth:"320px",padding:"20px 0"}},Nn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={activeTab:"friends"},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:kn,contentLabel:"Contacts"},l.a.createElement("h2",{className:"modal-title"},"Contacts"),l.a.createElement("div",{className:"contacts-tabs"},l.a.createElement("span",{className:"friends"===this.state.activeTab?"active":"",onClick:function(){e.setState({activeTab:"friends"})}},"Friends"),l.a.createElement("span",{className:"inbox"===this.state.activeTab?"active":"",onClick:function(){e.setState({activeTab:"inbox"})}},"Inbox"),l.a.createElement("span",{className:"outbox"===this.state.activeTab?"active":"",onClick:function(){e.setState({activeTab:"outbox"})}},"Outbox")),"friends"===this.state.activeTab&&l.a.createElement(Qt,{onClick:function(t){e.props.history.push({search:"?user=".concat(t)})},type:"normal"}),"inbox"===this.state.activeTab&&l.a.createElement(Mn,null),"outbox"===this.state.activeTab&&l.a.createElement(An,null))}}]),a}(l.a.Component);var Tn=Object(D.b)((function(e){return{users:e.users,user:e.user}}),(function(e){return{usersActions:Object(x.b)(o,e)}}))(Object(Ke.g)(Nn)),Cn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"max-content",maxWidth:"320px",padding:"20px 0"}},Dn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:Cn,contentLabel:"Create room"},l.a.createElement("h2",{className:"modal-title"},"New chat"),l.a.createElement(Qt,{onClick:function(t){e.props.history.push("/chats/".concat(t))}}))}}]),a}(l.a.Component);var xn=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(Dn)),wn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"max-content",maxWidth:"320px",padding:"20px 0"}},Fn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={selectUsers:[],error:!1,errors:[]},e}return Object(m.a)(a,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),fetch("".concat(_e,"/api/room/invite"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.user.apiToken)},body:JSON.stringify({id:this.props.rooms.activeRoom._id,selectUsers:this.state.selectUsers})}).then((function(){t.setState({selectUsers:[]}),ns.b.success("Invited sents!",{position:ns.b.POSITION.TOP_CENTER}),t.props.close()}))}},{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:wn,contentLabel:"Create room"},l.a.createElement("h2",{className:"modal-title"},"Select users"),l.a.createElement("form",{style:{display:"contents"},onSubmit:function(t){e.onSubmit(t)}},l.a.createElement(Qt,{onClick:function(t){e.state.selectUsers.find((function(e){return e===t}))?e.setState({selectUsers:Object(U.a)(e.state.selectUsers.filter((function(e){return e!==t})))}):e.setState({selectUsers:[t].concat(Object(U.a)(e.state.selectUsers))})},type:"select",selectUsers:this.state.selectUsers}),!this.state.selectUsers.length&&l.a.createElement("button",{className:"button-gray",onClick:function(){e.props.close()},style:{width:"max-content",marginTop:5}},"Back"),!!this.state.selectUsers.length&&l.a.createElement("button",{className:"button-blue",type:"submit",style:{width:"max-content",marginTop:5}},"Invite")))}}]),a}(l.a.Component);var Ln=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(Fn)),Un={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)"}},Bn=Object(Ye.a)((function(e){return{root:{color:"#CCD1D6","&$checked":{color:"#008FF7",border:"none"},"&:hover":{backgroundColor:"transparent"}},checked:{}}}))(Ot.a),Gn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={title:e.props.rooms.activeRoom.title,isPrivate:e.props.rooms.activeRoom.isPrivate,error:!1,errors:[]},e}return Object(m.a)(a,[{key:"onSubmit",value:function(e){var t=this;this.setState({error:!1,errors:[]}),e.preventDefault(),fetch("".concat(_e,"/api/room/edit"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.user.apiToken)},body:JSON.stringify({id:this.props.rooms.activeRoom._id,title:this.state.title,isPrivate:this.state.isPrivate})}).then((function(e){return e.json()})).then((function(e){e.error?t.setState({error:!0,errors:e.errors}):t.props.close()}))}},{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:Un,contentLabel:"Edit room"},l.a.createElement("h2",{className:"modal-title"},"Edit room"),l.a.createElement("form",{style:{display:"contents"},onSubmit:function(t){e.onSubmit(t)}},l.a.createElement("input",{value:this.state.title,onChange:function(t){e.setState({title:t.target.value})},className:"input-field",type:"text",style:{marginBottom:10},placeholder:"Title",maxLength:50}),this.state.errors.find((function(e){return"title"===e.param}))&&l.a.createElement("span",{className:"input-error-label"},this.state.errors.find((function(e){return"title"===e.param})).msg),l.a.createElement(bt.a,{control:l.a.createElement(Bn,{checked:this.state.isPrivate,onChange:function(){e.setState({isPrivate:!e.state.isPrivate})}}),style:{color:"#667788"},label:"Private theme"}),this.state.title===this.props.rooms.activeRoom.title&&this.state.isPrivate===this.props.rooms.activeRoom.isPrivate&&l.a.createElement("button",{className:"button-gray",onClick:function(){e.props.close()},style:{width:"max-content",marginTop:5}},"Back"),(this.state.title!==this.props.rooms.activeRoom.title||this.state.isPrivate!==this.props.rooms.activeRoom.isPrivate)&&l.a.createElement("button",{className:"button-blue",type:"submit",style:{width:"max-content",marginTop:5}},"Save")))}}]),a}(l.a.Component);var zn=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(Gn)),Pn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",flexWrap:"wrap"}},Hn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"onSubmit",value:function(){var e=this;fetch("".concat(_e,"/api/room/delete"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.user.apiToken)},body:JSON.stringify({id:this.props.rooms.activeRoom._id})}).then((function(){e.props.close()}))}},{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:Pn,contentLabel:"Delete room"},l.a.createElement("h2",{className:"modal-title",style:{width:"100%"}},"You sure?"),l.a.createElement("button",{className:"button-blue",onClick:function(){e.props.close()},style:{width:"max-content",marginTop:5}},"Back"),l.a.createElement("button",{className:"button-gray",onClick:function(){e.onSubmit()},style:{width:"max-content",marginTop:5}},"Delete"))}}]),a}(l.a.Component),Jn=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}))(Object(Ke.g)(Hn)),Wn={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.25)",zIndex:4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",minWidth:"300px",marginRight:"-50%",transform:"translate(-50%, -50%)",borderRadius:"10px",boxShadow:"0px 5px 30px rgba(0, 0, 0, 0.16)",display:"flex",justifyContent:"center",flexWrap:"wrap",width:"max-content",maxWidth:"320px",padding:"20px 0"}},qn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(Et.a,{isOpen:this.props.isOpen,onRequestClose:function(){e.props.close()},style:Wn,contentLabel:"Forward messages"},l.a.createElement("h2",{className:"modal-title"},"Forward messages"),l.a.createElement(Qt,{onClick:function(t){e.props.history.push("/chats/".concat(t))}}))}}]),a}(l.a.Component);var Vn=Object(D.b)((function(e){return{user:e.user,rooms:e.rooms}}),(function(e){return{roomsActions:Object(x.b)(n,e)}}))(Object(Ke.g)(qn)),Yn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={act:Xs.a.parse(e.props.location.search,{ignoreQueryPrefix:!0}).act,user:Xs.a.parse(e.props.location.search,{ignoreQueryPrefix:!0}).user,modal:Xs.a.parse(e.props.location.search,{ignoreQueryPrefix:!0}).modal},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.history.listen((function(t){e.setState({act:Xs.a.parse(t.search,{ignoreQueryPrefix:!0}).act,user:Xs.a.parse(t.search,{ignoreQueryPrefix:!0}).user,modal:Xs.a.parse(t.search,{ignoreQueryPrefix:!0}).modal})}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ea,{isOpen:"newRoom"===this.state.act,close:function(){e.props.history.push({search:""})}}),l.a.createElement(xn,{isOpen:"newChat"===this.state.act,close:function(){e.props.history.push({search:""})}}),this.state.user&&l.a.createElement(Rn,{userId:this.state.user,close:function(){e.props.history.push({search:""})}}),l.a.createElement(Tn,{isOpen:"contacts"===this.state.modal,close:function(){e.props.history.push({search:""})}}),l.a.createElement(Ln,{isOpen:"invite"===this.state.act&&this.props.rooms.activeRoom,close:function(){e.props.history.push({search:""})}}),"editRoom"===this.state.act&&this.props.rooms.activeRoom&&this.props.user._id===this.props.rooms.activeRoom.ownerId&&l.a.createElement(zn,{isOpen:"editRoom"===this.state.act&&this.props.rooms.activeRoom,close:function(){e.props.history.push({search:""})}}),"deleteRoom"===this.state.act&&this.props.rooms.activeRoom&&this.props.user._id===this.props.rooms.activeRoom.ownerId&&l.a.createElement(Jn,{isOpen:"deleteRoom"===this.state.act&&this.props.rooms.activeRoom,close:function(){e.props.history.push({search:""})}}),l.a.createElement(Vn,{isOpen:!!this.props.dialogs.forwardMessages.length,close:function(t){e.props.dispatch({type:"DIALOGS_SET_FORWARD",payload:[]})}}))}}]),a}(l.a.Component),Qn=Object(D.b)((function(e){return{rooms:e.rooms,user:e.user,dialogs:e.dialogs}}))(Object(Ke.g)(Yn)),$n=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={isRender:!1},e.PrivateRoute=function(t){var a=t.children,s=Object(ba.a)(t,["children"]);return l.a.createElement(Ke.b,Object.assign({},s,{render:function(){return e.props.user.isAuth?l.a.createElement(l.a.Fragment,null,a,l.a.createElement(Qn,null)):l.a.createElement(Ke.a,{to:{pathname:"/login"}})}}))},e.AuthRoute=function(t){var a=t.children,s=Object(ba.a)(t,["children"]);return l.a.createElement(Ke.b,Object.assign({},s,{render:function(){return e.props.user.isAuth?l.a.createElement(Ke.a,{to:{pathname:"/"}}):a}}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.history.listen((function(){Z(e.props.history.location.pathname,Qs)})),Z(this.props.history.location.pathname,Qs);var t=this.props.cookies.get("apiToken");t?fetch("".concat(_e,"/api/user/me"),{method:"get",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(a){var s=a.user,n=a.dialogs,o=a.noReadCount,r=a.noReadNotifications;Ae.init(t),e.props.userActions.loginUser(s,n,o,r,t),e.setState({isRender:!0})})).catch((function(){e.setState({isRender:!0})})):this.setState({isRender:!0})}},{key:"render",value:function(){var e=this;return this.state.isRender&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Ke.d,null,Qs.map((function(t,a){switch(t.type){case"auth":return l.a.createElement(e.AuthRoute,{key:a,path:t.path,exact:t.exact},l.a.createElement(t.component,null));case"user":return l.a.createElement(e.PrivateRoute,{key:a,path:t.path,exact:t.exact},l.a.createElement(t.component,null));default:return!1}})),l.a.createElement(Ke.b,{component:$s})))}}]),a}(l.a.Component);var Kn=Object(D.b)((function(e){return{user:e.user}}),(function(e){return{userActions:Object(x.b)(i,e),usersActions:Object(x.b)(o,e)}}))(Object(Oa.a)(Object(Ke.g)($n))),Xn=function(e){Object(g.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).toggleHeader=function(e){s.setState({userHeader:e})},s.state={userHeader:!1,toggleHeader:s.toggleHeader},s}return Object(m.a)(a,[{key:"render",value:function(){return l.a.createElement(f.Provider,{value:this.state},l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"row"},this.props.user.isAuth&&l.a.createElement(Ea,{show:this.state.userHeader}),l.a.createElement(Kn,null))))}}]),a}(l.a.Component),Zn=Object(D.b)((function(e){return{user:e.user}}))(Xn);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var eo=a(1453);Et.a.setAppElement("#root"),u.a.render(l.a.createElement(eo.a,null,l.a.createElement(D.a,{store:K},l.a.createElement(He.a,null,l.a.createElement(Zn,null),l.a.createElement(ns.a,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},220:function(e,t,a){},470:function(e,t,a){},658:function(e,t,a){e.exports=a(1427)},887:function(e,t,a){},888:function(e,t,a){},893:function(e,t,a){},938:function(e,t){},987:function(e,t){}},[[658,1,2]]]);
//# sourceMappingURL=main.d1da64ce.chunk.js.map