{"version":3,"sources":["Pages/PageSettings.js","Partials/User/Avatar.js","Redux/reducers/user.js","Redux/constants.js","Redux/reducers/rooms.js","Redux/reducers/media.js","Redux/reducers/dialogs.js","Redux/reducers/index.js","Redux/store.js","Controllers/FunctionsController.js","Controllers/WebRtcController.js","config.js","Controllers/SocketController.js","Redux/actions/dialogs.js","Partials/Room/RoomItem.js","Partials/Loading.js","Controllers/TimeController.js","Partials/ActionMenu.js","Partials/Dialog/DialogItem.js","Sidebar/Messages.js","Redux/actions/rooms.js","Modals/CreateRoom.js","Sidebar/Rooms.js","Sidebar/Notifications.js","Redux/actions/user.js","Sidebar/Languages.js","Partials/UserSidebar.js","Pages/Auth/Login.js","Pages/Auth/Register.js","Partials/Chat/Audio.js","Partials/Chat/Message.js","Partials/Chat/Dialog.js","Partials/Chat/Attachment.js","Partials/Chat/Slider.js","Partials/Chat/InputMessage.js","Partials/Chat/ToolbarMessage.js","Partials/Chat/Chat.js","Modals/RoomJoinError.js","Pages/User/Room.js","Pages/User/Main.js","Pages/User/Dialog.js","Router/config.js","Pages/NoMatch.js","Router/index.js","App.js","serviceWorker.js","index.js"],"names":["PageSettings","React","createContext","Avatar","className","style","this","props","name","toUpperCase","Component","INITIAL_STATE","isAuth","user","state","action","type","payload","roomLang","isFetching","getted","activeRoom","isError","rooms","room","typers","canLoad","isLoading","remoteStream","error","users","filter","_id","map","roomId","userId","dialog","messages","message","_newId","isEdit","find","x","isRead","speaking","micOn","musicOn","dialogs","noReadCount","dialogId","lastMessage","noRead","sort","a","b","Date","createdAt","editLast","messageIds","typing","combineReducers","media","createStore","rootReducer","applyMiddleware","ReduxThunk","randomInteger","min","max","rand","Math","random","floor","setTitle","path","routeArray","pageTitle","i","length","title","document","setForceTitle","WebRtcPeerConnection","activeRoomId","localStream","speechEvents","RTCPeerConnection","window","mozRTCPeerConnection","webkitRTCPeerConnection","RTCSessionDescription","mozRTCSessionDescription","RTCIceCandidate","mozRTCIceCandidate","getAudioTracks","enabled","store","dispatch","lang","close","SocketController","leaveRoom","stop","e","candidate","addIceCandidate","sdpAnswer","answer","sdp","setRemoteDescription","stream","MediaStream","getReceivers","forEach","sender","addTrack","track","hark","on","sendRoomSpeaking","sendRoomStopSpeaking","urlApi","socket","activeLang","init","apiToken","io","transports","emit","getState","setTimeout","answerSdp","WebRtcController","last","getSocketId","id","joinLang","createRoom","joinRoom","sendMessageRoom","typingRoom","sendRoomIceCandidate","sendRoomOfferSdp","offerSdp","typingDialog","otherId","dialogsGet","fetch","method","headers","Accept","Authorization","then","response","json","existDialog","dialogGet","body","JSON","stringify","isNotFound","reverse","dialogLoad","sendMessage","formData","FormData","images","files","sounds","append","file","push","localMessage","text","recentMessages","now","m","socketId","messageRes","catch","editMessage","oldImages","oldFiles","oldSounds","readMessages","retrySendMessage","deleteMessage","deleteMessages","y","pop","deleteLocalMessage","loadMessages","lastMessageId","RoomItem","textDecoration","to","Button","width","height","fontSize","fontWeight","backgroundColor","color","charAt","isPrivate","index","key","first","showLoading","element","getHM","date","time","hours","getHours","minutes","getMinutes","toString","ActionMenu","active","left","top","getElementById","from","rect","getBoundingClientRect","setState","clientWidth","addEventListener","toggleActive","bind","removeEventListener","actions","onClick","DialogItem","randomId","history","location","pathname","preventDefault","myUser","getTime","day_diff","getDate","year_diff","getFullYear","year","month","getMonth","day","LastMessageDate","marginTop","dialogsActions","connect","bindActionCreators","withRouter","CustomFab","withStyles","theme","root","position","bottom","right","Fab","Messages","showBtnAdd","scrollTop","context","toggleHeader","messagesBlock","getScrollTop","nextProps","nextState","ref","renderTrackVertical","renderThumbVertical","onScroll","autoHide","Skeleton","variant","marginLeft","flex","margin","display","Tooltip","placement","size","aria-label","contextType","roomsGet","err","roomsAdd","errors","param","msg","customStylesModal","overlay","zIndex","content","minWidth","marginRight","transform","borderRadius","boxShadow","CustomCheckbox","border","checked","Checkbox","CreateRoom","roomsActions","isOpen","onRequestClose","contentLabel","onSubmit","value","onChange","target","marginBottom","placeholder","FormControlLabel","control","label","Rooms","isOpenCreateRoom","roomsBlock","overflow","Notifications","loginUser","logoutUser","updateRoomLang","Languages","userActions","UserSidebar","activeTab","Login","email","password","data","cookies","set","token","withCookies","Register","audioDurationInterval","Audio","duration","audio","thisAudio","getElementsByName","src","volume","onloadedmetadata","getDuration","padZero","v","t","parseInt","stopTimer","parentElement","pause","stopPropagation","otherAudio","getElementsByClassName","play","startTimer","nativeEvent","layerX","rangeBlock","currentTime","thisRange","setInterval","clearInterval","playAudio","stopAudio","fileName","onMouseMove","viewDurationAudio","onMouseEnter","onMouseLeave","changeDurationAudio","range","componentDecorator","href","rel","Message","isHistoryDate","moreHour","date1","date2","abs","isFirst","timeAt","selected","unSelect","onSelect","background","isRecent","cursor","padding","lineHeight","canSelect","replace","countRecent","image","isBlur","openSlider","alt","sound","open","toFixed","ceil","sliderImages","transitionName","transitionEnterTimeout","transitionLeaveTimeout","PureComponent","waitActiveUser","Dialog","showFabToBottom","activePage","view","scroll","getScrollHeight","behavior","blurPage","focusPage","getClientHeight","unRead","clearTimeout","prevProps","scrollToBottom","LinearProgress","viewTypers","userName","loading","CircularProgress","Attachment","unSelectRecentMessages","removeImage","removeSound","removeFile","Slider","opacity","InputMessage","inputMessageHeight","event","items","clipboardData","originalEvent","kind","getAsFile","addFile","test","attachedRecentMessages","cancelEditMessage","isShow","IconButton","component","multiple","accept","onPaste","onKeyDown","keyCode","setLastEditMessage","shiftKey","sendEditMessage","maxHeight","onInput","inputMessage","scrollHeight","node","setProperty","handleHeight","onResize","ToolbarMessage","addAttachmentRecentMessage","setEditMessage","cancelAttachmentRecentMessage","waitFastRead","waitDraft","Chat","isOpenSlider","canTyping","drag","dropRef","createRef","dragCounter","handleDrag","handleDragIn","dataTransfer","handleDragOut","handleDrop","handleDropFiles","clearData","div","current","drafts","parse","localStorage","getItem","setText","setItem","lastMyMessage","slice","paste","counter","toast","POSITION","TOP_CENTER","URL","webkitURL","createObjectURL","Blob","split","newText","prevText","textAlign","RoomJoinError","Members","srcObject","autoPlay","Room","waitSocket","match","params","Main","order","routes","exact","NoMatch","AppRouter","isRender","PrivateRoute","children","rest","render","AuthRoute","listen","get","route","App","userHeader","Provider","Boolean","hostname","Modal","setAppElement","ReactDOM","CookiesProvider","navigator","serviceWorker","ready","registration","unregister","console"],"mappings":"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","file":"static/js/main.6997a5f5.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nexport const PageSettings = React.createContext();","import React from 'react'\r\n\r\nclass Avatar extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className=\"user-avatar\" style={this.props.style}>\r\n                <span>{this.props.name.toUpperCase()}</span>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Avatar","import { \r\n    USER_LOGIN,\r\n    USER_LOGOUT,\r\n    USER_UPDATE_ROOM_LANG\r\n} from '../constants'\r\n\r\nconst INITIAL_STATE = {\r\n    isAuth: false\r\n}\r\n\r\nconst user = (state = INITIAL_STATE, action) => {\r\n    switch(action.type) {\r\n        case USER_LOGIN: {\r\n            return { ...state, ...action.payload, isAuth: true }\r\n        }\r\n        case USER_LOGOUT:\r\n            return { isAuth: false }\r\n        case USER_UPDATE_ROOM_LANG:\r\n            return { ...state, roomLang: action.payload }\r\n        default: \r\n            return state\r\n    }\r\n}\r\n\r\nexport default user","// User\r\nexport const USER_LOGIN = 'USER_LOGIN'\r\nexport const USER_LOGOUT = 'USER_LOGOUT'\r\nexport const USER_UPDATE_ROOM_LANG = 'USER_UPDATE_ROOM_LANG'\r\n\r\n// Rooms\r\nexport const ROOMS_GET = 'ROOMS_GET'\r\nexport const ROOMS_ADD = 'ROOMS_ADD'\r\nexport const ROOMS_DELETE = 'ROOMS_DELETE'\r\nexport const ROOMS_EDIT = 'ROOMS_EDIT'   \r\nexport const ROOMS_JOIN_ROOM = 'ROOMS_JOIN_ROOM'   \r\nexport const ROOMS_LEAVE_ROOM = 'ROOMS_LEAVE_ROOM'        \r\nexport const ROOMS_USER_JOIN_ROOM = 'ROOMS_USER_JOIN_ROOM' \r\nexport const ROOMS_USER_LEAVE_ROOM = 'ROOMS_USER_LEAVE_ROOM'\r\nexport const ROOMS_ADD_MESSAGE = 'ROOMS_ADD_MESSAGE'\r\nexport const ROOMS_SUCCESS_MESSAGE = 'ROOMS_SUCCESS_MESSAGE'\r\nexport const ROOMS_ERROR_MESSAGE = 'ROOMS_ERROR_MESSAGE'\r\nexport const ROOMS_EDIT_MESSAGE = 'ROOMS_EDIT_MESSAGE'\r\nexport const ROOMS_READ_MESSAGE = 'ROOMS_READ_MESSAGE'\r\nexport const ROOMS_JOIN_ERROR = 'ROOMS_JOIN_ERROR'\r\nexport const ROOMS_DELETE_MESSAGE = 'ROOMS_DELETE_MESSAGE'\r\nexport const ROOMS_READ_MESSAGES = 'ROOMS_READ_MESSAGES'\r\nexport const ROOMS_ADD_TYPER = 'ROOMS_ADD_TYPER'\r\nexport const ROOMS_REMOVE_TYPER = 'ROOMS_REMOVE_TYPER'\r\nexport const ROOMS_LOAD_MESSAGES = 'ROOMS_LOAD_MESSAGES'\r\nexport const ROOMS_SET_LOADING = 'ROOMS_SET_LOADING'\r\nexport const ROOMS_SET_REMOTE_STREAM = 'ROOMS_SET_REMOTE_STREAM'\r\nexport const ROOMS_SET_SPEAKING_STATUS = 'ROOMS_SET_SPEAKING_STATUS'\r\nexport const ROOMS_USER_JOIN_IN_ROOM = 'ROOMS_USER_JOIN_IN_ROOM'\r\nexport const ROOMS_USER_LEAVE_IN_ROOM = 'ROOMS_USER_LEAVE_IN_ROOM'\r\nexport const ROOMS_GET_ERROR = 'ROOMS_GET_ERROR'\r\nexport const ROOMS_SET_GET = 'ROOMS_SET_GET' \r\n\r\n// Dialogs\r\nexport const DIALOGS_GET = 'DIALOGS_GET'\r\nexport const DIALOGS_ADD = 'DIALOGS_ADD'\r\nexport const DIALOGS_ADD_MESSAGE = 'DIALOGS_ADD_MESSAGE'\r\nexport const DIALOGS_SUCCESS_MESSAGE = 'DIALOGS_SUCCESS_MESSAGE'\r\nexport const DIALOGS_ERROR_MESSAGE = 'DIALOGS_ERROR_MESSAGE'\r\nexport const DIALOGS_READ_MESSAGES = 'DIALOGS_READ_MESSAGES'\r\nexport const DIALOGS_LOAD = 'DIALOGS_LOAD'\r\nexport const DIALOGS_SET_TYPER = 'DIALOGS_SET_TYPER'\r\nexport const DIALOGS_EDIT_MESSAGE = 'DIALOGS_EDIT_MESSAGE'\r\nexport const DIALOGS_DELETE_MESSAGE = 'DIALOGS_DELETE_MESSAGE'\r\nexport const DIALOGS_SET_LOADING = 'DIALOGS_SET_LOADING'\r\nexport const DIALOGS_LOAD_MESSAGES = 'DIALOGS_LOAD_MESSAGES'\r\n\r\n// Media\r\nexport const MEDIA_TOGGLE_MICROPHONE = 'MEDIA_TOGGLE_MICROPHONE'\r\nexport const MEDIA_TOGGLE_MUSIC = 'MEDIA_TOGGLE_MUSIC'","import { \r\n    ROOMS_GET,\r\n    ROOMS_ADD,\r\n    ROOMS_DELETE,\r\n    ROOMS_EDIT,\r\n    ROOMS_JOIN_ROOM,\r\n    ROOMS_LEAVE_ROOM,\r\n    ROOMS_USER_JOIN_ROOM,\r\n    ROOMS_USER_LEAVE_ROOM,\r\n    ROOMS_ADD_MESSAGE,\r\n    ROOMS_SUCCESS_MESSAGE,\r\n    ROOMS_ERROR_MESSAGE,\r\n    ROOMS_EDIT_MESSAGE,\r\n    ROOMS_READ_MESSAGE,\r\n    ROOMS_JOIN_ERROR,\r\n    ROOMS_DELETE_MESSAGE,\r\n    ROOMS_READ_MESSAGES,\r\n    ROOMS_ADD_TYPER,\r\n    ROOMS_REMOVE_TYPER,\r\n    ROOMS_LOAD_MESSAGES,\r\n    ROOMS_SET_LOADING,\r\n    ROOMS_SET_REMOTE_STREAM,\r\n    ROOMS_SET_SPEAKING_STATUS,\r\n    ROOMS_USER_LEAVE_IN_ROOM,\r\n    ROOMS_USER_JOIN_IN_ROOM,\r\n    ROOMS_SET_GET,\r\n    ROOMS_GET_ERROR\r\n} from '../constants'\r\n\r\nconst INITIAL_STATE = {\r\n    isFetching: true,\r\n    getted: false,\r\n    activeRoom: false,\r\n    isError: false,\r\n    rooms: []\r\n}\r\n\r\nconst rooms = (state = INITIAL_STATE, action) => {\r\n    switch(action.type) {\r\n        case ROOMS_GET: {\r\n            return { ...state, rooms: action.payload, isFetching: false, getted: true }\r\n        }\r\n        case ROOMS_SET_GET: {\r\n            return { ...state, isFetching: true, getted: false, isError: false }\r\n        }\r\n        case ROOMS_GET_ERROR: {\r\n            return { ...state, isFetching: false, getted: true, isError: true }\r\n        }\r\n        case ROOMS_ADD:\r\n            return { ...state, rooms: [ action.payload, ...state.rooms ]  }\r\n        case ROOMS_JOIN_ROOM:\r\n            return { ...state, activeRoom: {...action.payload.room, typers: [], canLoad: action.payload.canLoad, isLoading: false, remoteStream: false} }\r\n        case ROOMS_JOIN_ERROR:\r\n            return { ...state, activeRoom: { error: action.payload } }\r\n        case ROOMS_USER_LEAVE_IN_ROOM:\r\n            return { ...state, activeRoom: { ...state.activeRoom, users: [\r\n                ...state.activeRoom.users.filter(user => {                        \r\n                    return user._id !== action.payload\r\n                })\r\n            ] } }\r\n        case ROOMS_USER_JOIN_IN_ROOM:\r\n            return { ...state, activeRoom: { ...state.activeRoom, users: [ ...state.activeRoom.users, action.payload ] } }\r\n        case ROOMS_LEAVE_ROOM:\r\n            return { ...state, activeRoom: false }\r\n        case ROOMS_USER_JOIN_ROOM:\r\n            return { ...state, rooms: state.rooms.map(room => \r\n                action.payload.roomId === room._id ? \r\n                { ...room, users: [ action.payload.user, ...room.users ] } :\r\n                room\r\n            ) }\r\n        case ROOMS_USER_LEAVE_ROOM:\r\n            return { ...state, rooms: state.rooms.map(room => \r\n                action.payload.roomId === room._id ? \r\n                { ...room, users: [\r\n                        ...room.users.filter(user => {                        \r\n                            return user._id !== action.payload.userId\r\n                        })\r\n                    ]\r\n                } :\r\n                room\r\n            ) }\r\n        case ROOMS_ADD_MESSAGE: \r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: [ ...state.activeRoom.dialog.messages, action.payload ] } } }\r\n        case ROOMS_SUCCESS_MESSAGE: \r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: state.activeRoom.dialog.messages.map(message => \r\n                action.payload._id === message._id ? \r\n                { ...message, isLoading: false, _id: action.payload._newId } :\r\n                message\r\n            ) } } }\r\n        case ROOMS_ERROR_MESSAGE: \r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: state.activeRoom.dialog.messages.map(message => \r\n                action.payload === message._id ? \r\n                { ...message, isLoading: false, isError: true } :\r\n                message\r\n            ) } } }\r\n        case ROOMS_EDIT_MESSAGE: \r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: state.activeRoom.dialog.messages.map(message => \r\n                action.payload._id === message._id ? \r\n                { ...message, ...action.payload, isEdit: true } :\r\n                message\r\n            ) } } }\r\n        case ROOMS_DELETE_MESSAGE:\r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: [\r\n                ...state.activeRoom.dialog.messages.filter(message => {        \r\n                    return !action.payload.find(x => x === message._id)\r\n                })\r\n            ]\r\n            } } }\r\n        case ROOMS_READ_MESSAGE:\r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: state.activeRoom.dialog.messages.map(message => \r\n                !message.isRead && message.user._id === action.payload ? \r\n                { ...message, isRead: true } :\r\n                message\r\n            ) } } }\r\n        case ROOMS_READ_MESSAGES:\r\n            return { ...state, activeRoom: { ...state.activeRoom, dialog: { ...state.activeRoom.dialog, messages: state.activeRoom.dialog.messages.map(message => \r\n                !message.isRead && message.user._id !== action.payload ? \r\n                { ...message, isRead: true } :\r\n                message\r\n            ) } } }\r\n        case ROOMS_SET_REMOTE_STREAM:\r\n            return { ...state, activeRoom: { ...state.activeRoom, remoteStream: action.payload } }\r\n        case ROOMS_SET_LOADING:\r\n            return { ...state, activeRoom: { ...state.activeRoom, canLoad: false, isLoading: true } }\r\n        case ROOMS_LOAD_MESSAGES:\r\n            return { ...state, activeRoom: { ...state.activeRoom, isLoading: false, canLoad: action.payload.canLoad, dialog: { ...state.activeRoom.dialog, messages: [...action.payload.messages, ...state.activeRoom.dialog.messages] } } }\r\n        case ROOMS_ADD_TYPER: \r\n            return { ...state, activeRoom: { ...state.activeRoom, typers: [ action.payload, ...state.activeRoom.typers ] } }\r\n        case ROOMS_REMOVE_TYPER: \r\n            return { ...state, activeRoom: { ...state.activeRoom, typers: [ ...state.activeRoom.typers.filter(user => {        \r\n                return user._id !== action.payload\r\n            }) ] } }\r\n        case ROOMS_SET_SPEAKING_STATUS: \r\n            return { ...state, activeRoom: { ...state.activeRoom, users: state.activeRoom.users.map(user => \r\n                user._id === action.payload.userId ?\r\n                { ...user, speaking: action.payload.speaking } :\r\n                user\r\n            ) } }\r\n        default: \r\n            return state\r\n    }\r\n}\r\n\r\nexport default rooms","import { \r\n    MEDIA_TOGGLE_MICROPHONE,\r\n    MEDIA_TOGGLE_MUSIC\r\n} from '../constants'\r\n\r\nconst INITIAL_STATE = {\r\n    micOn: false,\r\n    musicOn: true\r\n}\r\n\r\nconst user = (state = INITIAL_STATE, action) => {\r\n    switch(action.type) {\r\n        case MEDIA_TOGGLE_MICROPHONE: {\r\n            return { ...state, micOn: action.payload }\r\n        }\r\n        case MEDIA_TOGGLE_MUSIC: {\r\n            return { ...state, musicOn: action.payload }\r\n        }\r\n        default: \r\n            return state\r\n    }\r\n}\r\n\r\nexport default user","import { \r\n    DIALOGS_ADD,\r\n    DIALOGS_GET,\r\n    DIALOGS_ADD_MESSAGE,\r\n    DIALOGS_SUCCESS_MESSAGE,\r\n    DIALOGS_ERROR_MESSAGE,\r\n    DIALOGS_READ_MESSAGES,\r\n    DIALOGS_LOAD,\r\n    DIALOGS_SET_TYPER,\r\n    DIALOGS_EDIT_MESSAGE,\r\n    DIALOGS_DELETE_MESSAGE,\r\n    DIALOGS_SET_LOADING,\r\n    DIALOGS_LOAD_MESSAGES\r\n} from '../constants'\r\n\r\nconst INITIAL_STATE = {\r\n    isFetching: true,\r\n    dialogs: []\r\n}\r\n\r\nconst dialogs = (state = INITIAL_STATE, action) => {\r\n    switch(action.type) {\r\n        case DIALOGS_GET: {\r\n            return { ...state, dialogs: action.payload.dialogs, isFetching: false, noReadCount: action.payload.noReadCount }\r\n        }\r\n        case DIALOGS_ADD:\r\n            return { ...state, dialogs: [ action.payload, ...state.dialogs ]  }\r\n        case DIALOGS_LOAD:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                { ...dialog, messages: action.payload.messages, getted: true, canLoad: action.payload.canLoad } :\r\n                dialog\r\n            ) }\r\n        case DIALOGS_ADD_MESSAGE:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                { ...dialog, messages: [\r\n                        ...dialog.messages,\r\n                        action.payload.message\r\n                    ],\r\n                    lastMessage: action.payload.message,\r\n                    noRead: action.payload.noRead ? dialog.noRead + 1 : dialog.noRead,\r\n                } :\r\n                dialog\r\n            ).sort((a, b) => {\r\n                if(!(a.lastMessage && b.lastMessage))\r\n                    return 0\r\n\r\n                a = new Date(a.lastMessage.createdAt);\r\n                b = new Date(b.lastMessage.createdAt);\r\n                \r\n                return a>b ? -1 : a<b ? 1 : 0;\r\n            }), noReadCount: action.payload.noReadCount ? state.noReadCount+1 : state.noReadCount }\r\n        case DIALOGS_SUCCESS_MESSAGE: \r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                { ...dialog, messages: dialog.messages.map(message => \r\n                        action.payload._id === message._id ? \r\n                        { ...message, isLoading: false, _id: action.payload._newId } :\r\n                        message\r\n                    ),\r\n                    lastMessage: { ...dialog.lastMessage, isLoading: false }\r\n                } :\r\n                dialog\r\n            ) }\r\n        case DIALOGS_ERROR_MESSAGE: \r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                { ...dialog, messages: dialog.messages.map(message => \r\n                        action.payload._id === message._id ? \r\n                        { ...message, isLoading: false, isError: true } :\r\n                        message\r\n                    ),\r\n                    lastMessage: { ...dialog.lastMessage, isLoading: false, isError: true }\r\n                } :\r\n                dialog\r\n            ) }\r\n        case DIALOGS_READ_MESSAGES:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                { ...dialog, messages: dialog.messages.map(message => \r\n                        !message.isRead && message.user._id === action.payload.userId ? \r\n                        { ...message, isRead: true } :\r\n                        message\r\n                    ),\r\n                    noRead: action.payload.noRead ? 0 : dialog.noRead,\r\n                    lastMessage: { ...dialog.lastMessage, isRead: true }\r\n                } :\r\n                dialog\r\n            ), noReadCount: action.payload.noReadCount ? state.noReadCount-1 : state.noReadCount }\r\n        case DIALOGS_EDIT_MESSAGE:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                    { ...dialog, messages: dialog.messages.map(message => \r\n                        action.payload.message._id === message._id ? \r\n                        { ...message, ...action.payload.message, isEdit: true } :\r\n                        message\r\n                    ),\r\n                    lastMessage: action.payload.editLast ? { ...dialog.lastMessage, ...action.payload.message } : dialog.lastMessage\r\n                } :\r\n                dialog\r\n            ) }\r\n        case DIALOGS_DELETE_MESSAGE:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                    { ...dialog, messages: [ ...dialog.messages.filter(message => {        \r\n                        return !action.payload.messageIds.find(x => x === message._id)\r\n                    })],\r\n                    lastMessage: action.payload.lastMessage\r\n                } :\r\n                dialog\r\n            ).sort((a, b) => {\r\n                if(!(a.lastMessage && b.lastMessage))\r\n                    return 0\r\n\r\n                a = new Date(a.lastMessage.createdAt);\r\n                b = new Date(b.lastMessage.createdAt);\r\n                \r\n                return a>b ? -1 : a<b ? 1 : 0;\r\n            }) }\r\n        case DIALOGS_SET_LOADING:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                    { ...dialog, canLoad: false, isLoading: true } :\r\n                dialog\r\n            )\r\n            }\r\n        case DIALOGS_LOAD_MESSAGES:\r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.dialogId === dialog._id ? \r\n                    { ...dialog,  isLoading: false, canLoad: action.payload.canLoad, messages: [...action.payload.messages, ...dialog.messages] } :\r\n                dialog\r\n            )\r\n            }\r\n        case DIALOGS_SET_TYPER: \r\n            return { ...state, dialogs: state.dialogs.map(dialog => \r\n                action.payload.userId === dialog.user._id ? \r\n                { ...dialog, typing: action.payload.typing } :\r\n                dialog\r\n            ) }\r\n        default: \r\n            return state\r\n    }\r\n}\r\n\r\nexport default dialogs","import { combineReducers } from 'redux'\r\n\r\nimport user from './user'\r\nimport rooms from './rooms'\r\nimport media from './media'\r\nimport dialogs from './dialogs'\r\n\r\nexport default combineReducers({\r\n    user,\r\n    rooms,\r\n    media,\r\n    dialogs\r\n})","import { createStore, applyMiddleware } from 'redux'\r\n\r\nimport rootReducer from './reducers'\r\nimport ReduxThunk from 'redux-thunk'\r\n\r\nexport default createStore(rootReducer, applyMiddleware(ReduxThunk))","export function randomInteger(min, max) {\r\n    let rand = min + Math.random() * (max + 1 - min);\r\n    return Math.floor(rand);\r\n}\r\n\r\n\r\nexport function setTitle(path, routeArray) {\r\n\tvar pageTitle;\r\n\tfor (var i=0; i < routeArray.length; i++) {\r\n\t\tif (routeArray[i].path === path) {\r\n\t\t\tpageTitle = 'Hevachat | ' + routeArray[i].title;\r\n\t\t}\r\n\t}\r\n\tdocument.title = (pageTitle) ? pageTitle : 'Hevachat';\r\n}\r\n\r\nexport function setForceTitle(title) {\r\n\tdocument.title = 'Hevachat | ' + title;\r\n}","import adapter from 'webrtc-adapter'\r\nimport SocketController from './SocketController';\r\nimport store from '../Redux/store';\r\nimport { ROOMS_SET_REMOTE_STREAM, MEDIA_TOGGLE_MICROPHONE, MEDIA_TOGGLE_MUSIC } from '../Redux/constants';\r\nimport hark from 'hark'\r\n\r\nlet WebRtcPeerConnection = false\r\nlet activeRoomId = false\r\nlet localStream = false\r\nlet remoteStream = false\r\nlet speechEvents = false\r\n\r\nconst RTCPeerConnection = RTCPeerConnection || window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\nconst RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.RTCSessionDescription;\r\nconst RTCIceCandidate = window.mozRTCIceCandidate || window.RTCIceCandidate;\r\n\r\nconst mediaConstraints = {\r\n    offerToReceiveAudio: true,\r\n    offerToReceiveVideo: false\r\n}\r\n\r\nconst options = {\r\n    iceServers: [\r\n        {\r\n          urls: 'turn:89.223.100.223:3478',\r\n          credential: 'TkYUraQew3RjwTA2JPjAaWL1Q7FIamc',\r\n          username: 'hevachat'\r\n        }\r\n    ],\r\n};\r\n\r\n// const getMedia = navigator.mediaDevices.getUserMedia || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\r\n\r\nfunction getUserMedia(callback) {    \r\n    // getMedia({\r\n    //     audio: true,\r\n    //     video: false\r\n    // }).then(callback);\r\n\r\n    function onerror(e) {\r\n        console.log(JSON.stringify(e, null, '\\t'));\r\n    }\r\n}\r\n\r\nfunction onRoomOffer(error, offer) {\r\n    if(error) return console.log(error);\r\n\r\n    SocketController.sendRoomOfferSdp({roomId: activeRoomId, offerSdp: offer.sdp})\r\n}\r\n\r\nfunction onRoomIceCandidate(e) {  \r\n    if(e.candidate) {\r\n        SocketController.sendRoomIceCandidate({roomId: activeRoomId, candidate: e.candidate})\r\n    } \r\n}\r\n\r\nexport default { \r\n    // Global functions\r\n    toggleMicrophone() {\r\n        localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled\r\n        store.dispatch({\r\n            type: MEDIA_TOGGLE_MICROPHONE,\r\n            payload: localStream.getAudioTracks()[0].enabled\r\n        })\r\n    },\r\n    toggleMusic() {\r\n        remoteStream.getAudioTracks()[0].enabled = !remoteStream.getAudioTracks()[0].enabled\r\n\r\n        store.dispatch({\r\n            type: MEDIA_TOGGLE_MUSIC,\r\n            payload: remoteStream.getAudioTracks()[0].enabled\r\n        })\r\n    },\r\n\r\n    // Rooms conference\r\n    connectRoom: (roomId) => {\r\n        activeRoomId = roomId\r\n        \r\n        getUserMedia((stream) => {\r\n            localStream = stream\r\n            let audioCtx = new (window.AudioContext || window.webkitAudioContext)()\r\n            let dest = audioCtx.createMediaStreamDestination ();\r\n\r\n            localStream.getAudioTracks()[0].enabled = false\r\n\r\n            WebRtcPeerConnection = new RTCPeerConnection(options)\r\n            \r\n            WebRtcPeerConnection.addStream(stream)\r\n\r\n            WebRtcPeerConnection.onicecandidate = onRoomIceCandidate\r\n\r\n            WebRtcPeerConnection.createOffer(mediaConstraints).then((offer) => {\r\n                WebRtcPeerConnection.setLocalDescription(offer);\r\n                \r\n                onRoomOffer(null, offer)\r\n            });\r\n        })\r\n    },\r\n    leaveRoom({roomId, lang}) {\r\n        if(WebRtcPeerConnection) {\r\n            WebRtcPeerConnection.close()\r\n            WebRtcPeerConnection = false\r\n        }\r\n\r\n        if(activeRoomId) {\r\n            SocketController.leaveRoom({roomId, lang})\r\n            activeRoomId = false\r\n        }\r\n\r\n        if(localStream) {\r\n            localStream.getAudioTracks()[0].stop()\r\n            localStream = false\r\n        }\r\n\r\n        if(remoteStream) {\r\n            remoteStream.getAudioTracks()[0].stop()\r\n            remoteStream = false\r\n        }\r\n\r\n        if(speechEvents) {\r\n            speechEvents.stop()\r\n            speechEvents = false\r\n        }\r\n    },\r\n    roomOnIceCandidate: (e) => {\r\n        let candidate = new RTCIceCandidate(e)\r\n        WebRtcPeerConnection.addIceCandidate(candidate)\r\n    },\r\n    onRoomAnswerSdp: (sdpAnswer) => {\r\n        let answer = new RTCSessionDescription({\r\n            type: 'answer',\r\n            sdp: sdpAnswer\r\n        })\r\n        \r\n        WebRtcPeerConnection.setRemoteDescription(answer);\r\n\r\n        let stream = new MediaStream();\r\n\r\n        WebRtcPeerConnection.getReceivers().forEach(function (sender) {\r\n            stream.addTrack(sender.track);\r\n        });\r\n\r\n        remoteStream = stream\r\n\r\n        store.dispatch({\r\n            type: ROOMS_SET_REMOTE_STREAM,\r\n            payload: stream\r\n        })\r\n\r\n        speechEvents = hark(localStream, {});\r\n \r\n        speechEvents.on('speaking', function() {\r\n            SocketController.sendRoomSpeaking({roomId: activeRoomId})\r\n        });\r\n    \r\n        speechEvents.on('stopped_speaking', function() {\r\n            SocketController.sendRoomStopSpeaking({roomId: activeRoomId})\r\n        });\r\n    }\r\n}","export const urlApi = 'http://151.248.123.145:8000'","import io from 'socket.io-client'\r\nimport store from '../Redux/store'\r\nimport {\r\n    ROOMS_ADD,\r\n    ROOMS_JOIN_ROOM,\r\n    ROOMS_USER_JOIN_ROOM,\r\n    ROOMS_USER_LEAVE_ROOM,\r\n    ROOMS_ADD_MESSAGE,\r\n    ROOMS_DELETE_MESSAGE,\r\n    ROOMS_READ_MESSAGE,\r\n    ROOMS_EDIT_MESSAGE,\r\n    ROOMS_ADD_TYPER,\r\n    ROOMS_REMOVE_TYPER,\r\n    ROOMS_SET_SPEAKING_STATUS,\r\n    ROOMS_USER_JOIN_IN_ROOM,\r\n    ROOMS_USER_LEAVE_IN_ROOM,\r\n    DIALOGS_ADD_MESSAGE,\r\n    DIALOGS_READ_MESSAGES,\r\n    DIALOGS_SET_TYPER,\r\n    DIALOGS_EDIT_MESSAGE,\r\n    DIALOGS_DELETE_MESSAGE,\r\n    DIALOGS_ADD\r\n} from '../Redux/constants'\r\nimport WebRtcController from './WebRtcController'\r\nimport {urlApi} from '../config'\r\n\r\nlet socket = null\r\nlet activeLang = false\r\n\r\nexport default { \r\n    init: (apiToken) => {\r\n        socket = io(urlApi, {transports: ['websocket', 'polling', 'flashsocket']})\r\n        socket.on('connect', () => {\r\n            socket.emit('auth', apiToken)\r\n        })\r\n\r\n        socket.on('createRoom', room => {\r\n            store.dispatch({\r\n                type: ROOMS_ADD,\r\n                payload: room\r\n            })\r\n        })\r\n\r\n        socket.on('joinRoom', ({roomId, user}) => {\r\n            store.dispatch({\r\n                type: ROOMS_USER_JOIN_ROOM,\r\n                payload: {roomId, user}\r\n            })\r\n        })\r\n\r\n        socket.on('joinInRoom', (user) => {\r\n            store.dispatch({\r\n                type: ROOMS_USER_JOIN_IN_ROOM,\r\n                payload: user\r\n            })\r\n        })\r\n\r\n        socket.on('leaveRoom', ({roomId, userId}) => {\r\n            store.dispatch({\r\n                type: ROOMS_USER_LEAVE_ROOM,\r\n                payload: {roomId, userId}\r\n            })\r\n        })\r\n\r\n        socket.on('leaveInRoom', (userId) => {\r\n            store.dispatch({\r\n                type: ROOMS_USER_LEAVE_IN_ROOM,\r\n                payload: userId\r\n            })\r\n        })\r\n\r\n        socket.on('sendMessageRoom', (message) => {\r\n            store.dispatch({\r\n                type: ROOMS_ADD_MESSAGE,\r\n                payload: message\r\n            })\r\n        })\r\n\r\n        socket.on('deleteMessageRoom', (messageIds) => {\r\n            store.dispatch({\r\n                type: ROOMS_DELETE_MESSAGE,\r\n                payload: messageIds\r\n            })\r\n        })\r\n\r\n        socket.on('readMessagesRoom', roomId => {\r\n            if(store.getState().rooms.activeRoom && store.getState().rooms.activeRoom._id === roomId)\r\n                store.dispatch({\r\n                    type: ROOMS_READ_MESSAGE,\r\n                    payload: store.getState().user._id\r\n                })\r\n        })\r\n\r\n        socket.on('editMessageRoom', message => {\r\n            store.dispatch({\r\n                type: ROOMS_EDIT_MESSAGE,\r\n                payload: message\r\n            })\r\n        })\r\n\r\n        socket.on('typingRoom', user => {\r\n            if(!store.getState().rooms.activeRoom.typers.find(x => x._id === user._id)) {\r\n                store.dispatch({\r\n                    type: ROOMS_ADD_TYPER,\r\n                    payload: user\r\n                })\r\n    \r\n                setTimeout(() => {\r\n                    store.dispatch({\r\n                        type: ROOMS_REMOVE_TYPER,\r\n                        payload: user._id\r\n                    })\r\n                }, 2500)\r\n            }\r\n        })\r\n\r\n        socket.on('roomAnswerSdp', answerSdp => {\r\n            WebRtcController.onRoomAnswerSdp(answerSdp)\r\n        })\r\n\r\n        socket.on('roomOnIceCandidate', candidate => {\r\n            WebRtcController.roomOnIceCandidate(candidate)\r\n        })\r\n\r\n        socket.on('roomSpeaking', userId => {\r\n            store.dispatch({\r\n                type: ROOMS_SET_SPEAKING_STATUS,\r\n                payload: {userId, speaking: true}\r\n            })\r\n        })\r\n\r\n        socket.on('roomStopSpeaking', userId => {\r\n            store.dispatch({\r\n                type: ROOMS_SET_SPEAKING_STATUS,\r\n                payload: {userId, speaking: false}\r\n            })\r\n        })\r\n\r\n        socket.on('sendMessageDialog', message => {\r\n            if(store.getState().dialogs.dialogs.find(x => x._id === message.dialogId)) {\r\n                let noReadCount = false\r\n\r\n                if(\r\n                    message.user._id !== store.getState().user._id &&\r\n                    !store.getState().dialogs.dialogs.find(x => x._id === message.dialogId).noRead\r\n                ) {\r\n                    noReadCount = true\r\n                }\r\n\r\n                store.dispatch({\r\n                    type: DIALOGS_ADD_MESSAGE,\r\n                    payload: {message, dialogId: message.dialogId, noRead: message.user._id !== store.getState().user._id, noReadCount}\r\n                })\r\n            } else {\r\n                let dialog = {\r\n                    lastMessage: message,\r\n                    _id: message.dialogId,\r\n                    users: [store.getState().user, message.user],\r\n                    user: message.user,\r\n                    getted: false,\r\n                    typing: false,\r\n                    noRead: 1,\r\n                    messages: []\r\n                }\r\n                store.dispatch({\r\n                    type: DIALOGS_ADD,\r\n                    payload: dialog\r\n                })\r\n            }\r\n        })\r\n\r\n        socket.on('readMessagesDialog', ({dialogId, userId}) => {\r\n            store.dispatch({\r\n                type: DIALOGS_READ_MESSAGES,\r\n                payload: {dialogId, userId, noRead: userId !== store.getState().user._id, noReadCount: userId !== store.getState().user._id}\r\n            })\r\n        })\r\n\r\n        socket.on('editMessageDialog', ({message, dialogId}) => {\r\n            let last = store.getState().dialogs.dialogs.find(x => x._id === dialogId).lastMessage\r\n\r\n            let editLast\r\n            if(last)\r\n                editLast = message._id === last._id\r\n            else \r\n                editLast = false\r\n\r\n            store.dispatch({\r\n                type: DIALOGS_EDIT_MESSAGE,\r\n                payload: {message, dialogId, editLast}\r\n            })\r\n        })\r\n\r\n        socket.on('deleteMessageDialog', ({messageIds, dialogId, lastMessage}) => {\r\n            store.dispatch({\r\n                type: DIALOGS_DELETE_MESSAGE,\r\n                payload: {dialogId, messageIds, lastMessage}\r\n            })\r\n        })\r\n\r\n        socket.on('typingDialog', userId => {\r\n            if(store.getState().dialogs.dialogs.find(x => x.user._id === userId)) {\r\n                store.dispatch({\r\n                    type: DIALOGS_SET_TYPER,\r\n                    payload: {userId, typing: true}\r\n                })\r\n    \r\n                setTimeout(() => {\r\n                    store.dispatch({\r\n                        type: DIALOGS_SET_TYPER,\r\n                        payload: {userId, typing: false}\r\n                    })\r\n                }, 2500)\r\n            }\r\n        })\r\n    },\r\n    getSocketId: () => {\r\n        return socket.id\r\n    },\r\n    joinLang: lang => {\r\n        if(activeLang)\r\n            socket.emit('leaveLang', lang)\r\n        \r\n        socket.emit('joinLang', lang)\r\n        activeLang = lang\r\n    },\r\n    createRoom: ({room, lang}) => {\r\n        socket.emit('createRoom', {room, lang})\r\n    },\r\n    joinRoom: ({roomId, lang}) => {\r\n        socket.emit('joinRoom', {roomId, lang, userId: store.getState().user._id})\r\n        // console.log(123)\r\n    },\r\n    leaveRoom: ({roomId, lang}) => {\r\n        socket.emit('leaveRoom', {roomId, lang})\r\n    },\r\n    sendMessageRoom: ({roomId, message}) => {\r\n        socket.emit('sendMessageRoom', {roomId, message})\r\n    },\r\n    typingRoom: (roomId) => {\r\n        socket.emit('typingRoom', roomId)\r\n    },\r\n\r\n    // Room conference\r\n    sendRoomIceCandidate: ({roomId, candidate}) => {\r\n        socket.emit('roomIceCandidate', {roomId, candidate})\r\n    },\r\n    sendRoomOfferSdp: ({roomId, offerSdp}) => {\r\n        socket.emit('roomOfferSdp', {roomId, offerSdp})\r\n    },\r\n    sendRoomSpeaking: ({roomId}) => {\r\n        socket.emit('roomSpeaking', roomId)\r\n    },\r\n    sendRoomStopSpeaking: ({roomId}) => {\r\n        socket.emit('roomStopSpeaking', roomId)\r\n    },\r\n    typingDialog: (otherId, userId) => {\r\n        socket.emit('typingDialog', {otherId, userId})\r\n    }\r\n}\r\n\r\n","import { \r\n    DIALOGS_GET,\r\n    DIALOGS_ADD,\r\n    DIALOGS_ADD_MESSAGE,\r\n    DIALOGS_SUCCESS_MESSAGE,\r\n    DIALOGS_ERROR_MESSAGE,\r\n    DIALOGS_READ_MESSAGES,\r\n    DIALOGS_LOAD,\r\n    DIALOGS_EDIT_MESSAGE,\r\n    DIALOGS_DELETE_MESSAGE,\r\n    DIALOGS_SET_LOADING,\r\n    DIALOGS_LOAD_MESSAGES\r\n} from '../constants'\r\nimport store from '../store';\r\nimport { randomInteger, setForceTitle } from '../../Controllers/FunctionsController';\r\nimport SocketController from '../../Controllers/SocketController';\r\nimport {urlApi} from '../../config'\r\n\r\nexport const dialogsGet = (apiToken) => (dispatch) => {\r\n    fetch(`${urlApi}/api/dialog/get-all`, {\r\n        method: \"post\",\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${apiToken}`,\r\n        }\r\n    })\r\n    .then((response) => response.json())\r\n    .then((dialogs) => {\r\n        for (let i = 0; i < dialogs.length; i++) {\r\n            let existDialog = store.getState().dialogs.dialogs.find(x => x._id === dialogs[i]._id)\r\n            \r\n            if(existDialog) {\r\n                dialogs[i] = existDialog\r\n            } else {\r\n                dialogs[i].user = dialogs[i].users.find(user => user._id !== store.getState().user._id)\r\n\r\n                if(!dialogs[i].user)\r\n                    dialogs[i].user = dialogs[i].users[0]\r\n\r\n                dialogs[i].typers = []\r\n            }\r\n        }\r\n\r\n        dispatch({\r\n            type: DIALOGS_GET,\r\n            payload: dialogs\r\n        })\r\n    });\r\n}\r\n\r\nexport const dialogGet = (userId, apiToken) => (dispatch) => {\r\n    fetch(`${urlApi}/api/dialog/get`, {\r\n        method: \"post\",\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${apiToken}`,\r\n        },\r\n        body: JSON.stringify({\r\n            userId\r\n        })\r\n    })\r\n    .then((response) => response.json())\r\n    .then(({dialog, messages}) => {\r\n        if(!dialog.error) {\r\n            dialog.user = dialog.users.find(user => user._id !== store.getState().user._id)\r\n\r\n            if(!dialog.user)\r\n                dialog.user = dialog.users[0]\r\n\r\n            dialog.typing = false\r\n\r\n            dialog.getted = true\r\n\r\n            dialog.messages = messages.reverse()\r\n            dialog.lastMessage = false\r\n            dialog.canLoad = messages.length === 50\r\n            dialog.isLoading = false\r\n\r\n            dispatch({\r\n                type: DIALOGS_ADD,\r\n                payload: dialog\r\n            })\r\n        } else {\r\n            let dialog = {\r\n                getted: true,\r\n                isNotFound: true,\r\n                user: {_id: userId}\r\n            }\r\n\r\n            dispatch({\r\n                type: DIALOGS_ADD,\r\n                payload: dialog\r\n            })\r\n        }\r\n    });\r\n}\r\n\r\nexport const dialogLoad = (userId, apiToken) => (dispatch) => {\r\n    fetch(`${urlApi}/api/dialog/get`, {\r\n        method: \"post\",\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${apiToken}`,\r\n        },\r\n        body: JSON.stringify({\r\n            userId\r\n        })\r\n    })\r\n    .then((response) => response.json())\r\n    .then(({dialog, messages}) => {\r\n        dialog.messages = messages.reverse()\r\n\r\n        dispatch({\r\n            type: DIALOGS_LOAD,\r\n            payload: {dialogId: dialog._id, messages: dialog.messages, canLoad: messages.length === 50}\r\n        })\r\n    });\r\n}\r\n\r\nexport const sendMessage = (message, apiToken) => (dispatch) => {\r\n    let formData = new FormData()\r\n    let _id = randomInteger(0, 1000000)\r\n    let images = []\r\n    let files = []\r\n    let sounds = []\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        formData.append('images'+i, message.images[i].file)\r\n        message.images[i].file = false\r\n        images.push(message.images[i])\r\n    }\r\n\r\n    for (let i = 0; i < message.files.length; i++) {\r\n        formData.append('files'+i, message.files[i].file)\r\n        message.files[i].file = false\r\n        files.push(message.files[i])\r\n    }\r\n\r\n    for (let i = 0; i < message.sounds.length; i++) {\r\n        formData.append('sounds'+i, message.sounds[i].file)\r\n        message.sounds[i].file = false\r\n        sounds.push(message.sounds[i])\r\n    }\r\n\r\n    let localMessage = {\r\n        _id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images,\r\n        sounds,\r\n        files,\r\n        isLoading: true,\r\n        isError: false,\r\n        isRead: false,\r\n        recentMessages: message.recentMessages,\r\n        createdAt: Date.now(),\r\n    }\r\n    \r\n    dispatch({\r\n        type: DIALOGS_ADD_MESSAGE,\r\n        payload: {message: localMessage, dialogId: message.dialogId}\r\n    })\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('userId', message.userId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n\r\n    fetch(`${urlApi}/api/dialog/send-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                // 'Accept': 'application/json',\r\n                // 'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            if(messageRes.error) {\r\n                return dispatch({\r\n                    type: DIALOGS_ERROR_MESSAGE,\r\n                    payload: {_id, dialogId: message.dialogId}\r\n                })\r\n            }\r\n            dispatch({\r\n                type: DIALOGS_SUCCESS_MESSAGE,\r\n                payload: {_id, _newId: messageRes._id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: DIALOGS_ERROR_MESSAGE,\r\n                payload: {_id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n}\r\n\r\nexport const editMessage = (message, apiToken) => (dispatch) => {\r\n    let formData = new FormData()\r\n\r\n    let images = []\r\n    let files = []\r\n    let sounds = []\r\n\r\n    let oldImages = []\r\n    let oldFiles = []\r\n    let oldSounds = []\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        if(message.images[i].file) {\r\n            formData.append('images'+i, message.images[i].file)\r\n\r\n            images.push(message.images[i])\r\n        } else {\r\n            oldImages.push(message.images[i].id)\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < message.files.length; i++) {\r\n        if(message.files[i].file) {\r\n            formData.append('files'+i, message.files[i].file)\r\n\r\n            files.push(message.files[i])\r\n        } else {\r\n            oldFiles.push(message.files[i].id)\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < message.sounds.length; i++) {\r\n        if(message.sounds[i].file) {\r\n            formData.append('sounds'+i, message.sounds[i].file)\r\n\r\n            sounds.push(message.sounds[i])\r\n        } else {\r\n            oldSounds.push(message.sounds[i].id)\r\n        }        \r\n    }\r\n\r\n    let localMessage = {\r\n        _id: message._id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images: message.images,\r\n        sounds: message.sounds,\r\n        files: message.files,\r\n        isLoading: true,\r\n        isError: false,\r\n        recentMessages: message.recentMessages,\r\n    }\r\n\r\n    let last = store.getState().dialogs.dialogs.find(x => x._id === message.dialogId).messages[store.getState().dialogs.dialogs.find(x => x._id === message.dialogId).messages.length-1]\r\n    \r\n    dispatch({\r\n        type: DIALOGS_EDIT_MESSAGE,\r\n        payload: {\r\n            message: localMessage, \r\n            dialogId: message.dialogId, \r\n            editLast: last._id === message._id\r\n        }\r\n    })\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n    \r\n    formData.append('_id', message._id)\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('userId', message.userId)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n    formData.append('oldImages', oldImages)\r\n    formData.append('oldSounds', oldSounds)\r\n    formData.append('oldFiles', oldFiles)\r\n\r\n    fetch(`${urlApi}/api/dialog/edit-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            if(messageRes.error) {\r\n                return dispatch({\r\n                    type: DIALOGS_ERROR_MESSAGE,\r\n                    payload: {_id: message._id, dialogId: message.dialogId}\r\n                })\r\n            }\r\n            dispatch({\r\n                type: DIALOGS_SUCCESS_MESSAGE,\r\n                payload: {_id: message._id, _newId: message._id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: DIALOGS_ERROR_MESSAGE,\r\n                payload: {_id: message._id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n}\r\n\r\nexport const readMessages = ({dialogId, userId, otherId}, apiToken) => (dispatch) => {\r\n    let readMessages = store.getState().dialogs.dialogs.find(dialog => dialog._id === dialogId).messages.filter(x => !x.isRead && x.user._id !== userId)\r\n\r\n    setTimeout(() => {\r\n        if(!!readMessages.length) {\r\n            dispatch({\r\n                type: DIALOGS_READ_MESSAGES,\r\n                payload: {dialogId, userId: otherId, noRead: true, noReadCount: true}\r\n            })\r\n        }\r\n    }, 750)\r\n\r\n    if(!!readMessages.length) {\r\n        fetch(`${urlApi}/api/dialog/read-messages`, {\r\n                method: \"post\",\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json',\r\n                    Authorization: `Bearer ${apiToken}`,\r\n                },\r\n                body: JSON.stringify({\r\n                    dialogId,\r\n                    otherId,\r\n                    socketId: SocketController.getSocketId()\r\n                })\r\n            })\r\n            .then()\r\n            .catch(() => {\r\n                \r\n            })\r\n    }\r\n}\r\n\r\nexport const retrySendMessage = (message, apiToken) => (dispatch) => {\r\n    let dialogId = message.dialogId\r\n    let formData = new FormData()\r\n    let images = []\r\n\r\n    let localMessage = {\r\n        _id: message._id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images: message.images,\r\n        sounds: [],\r\n        files: [],\r\n        isLoading: true,\r\n        isError: false,\r\n        recentMessages: message.recentMessages,\r\n        createdAt: Date.now(),\r\n    }\r\n\r\n    dispatch({\r\n        type: DIALOGS_DELETE_MESSAGE,\r\n        payload: {dialogId, messageIds: [message._id], lastMessage: false}\r\n    })\r\n\r\n    dispatch({\r\n        type: DIALOGS_ADD_MESSAGE,\r\n        payload: {message: localMessage, dialogId: message.dialogId}\r\n    })\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        formData.append('images'+i, message.images[i].file)\r\n\r\n        images.push(message.images[i].path)\r\n    }\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('userId', message.userId)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n\r\n    fetch(`${urlApi}/api/dialog/send-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                // 'Accept': 'application/json',\r\n                // 'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            if(messageRes.error) {\r\n                return dispatch({\r\n                    type: DIALOGS_ERROR_MESSAGE,\r\n                    payload: {_id: message._id, dialogId: message.dialogId}\r\n                })\r\n            }\r\n            dispatch({\r\n                type: DIALOGS_SUCCESS_MESSAGE,\r\n                payload: {_id: message._id, _newId: messageRes._id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: DIALOGS_ERROR_MESSAGE,\r\n                payload: {_id: message._id, dialogId: message.dialogId}\r\n            })\r\n        })\r\n}\r\n\r\nexport const deleteMessage = ({dialogId, otherId, deleteMessages}, apiToken) => (dispatch) => {\r\n    let messageIds = []\r\n    deleteMessages.map(m => {\r\n        messageIds.push(m._id)\r\n    })\r\n\r\n    let lastMessage\r\n\r\n    if(store.getState().dialogs.dialogs.find(x => x._id === dialogId) && !!store.getState().dialogs.dialogs.find(x => x._id === dialogId).messages.length)\r\n        lastMessage = store.getState().dialogs.dialogs.find(x => x._id === dialogId).messages.filter(x => !messageIds.find(y => y === x._id)).pop()\r\n    else \r\n        lastMessage = false\r\n\r\n    dispatch({\r\n        type: DIALOGS_DELETE_MESSAGE,\r\n        payload: {dialogId, messageIds, lastMessage}\r\n    })\r\n\r\n    fetch(`${urlApi}/api/dialog/delete-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                dialogId,\r\n                otherId,\r\n                messageIds,\r\n                socketId: SocketController.getSocketId()\r\n            })\r\n        })\r\n        .then()\r\n        .catch(() => {\r\n            \r\n        })\r\n}\r\n\r\nexport const deleteLocalMessage = (_id, dialogId) => (dispatch) => {\r\n    let messageIds = [_id]\r\n\r\n    let lastMessage\r\n    if(store.getState().dialogs.dialogs.find(x => x._id === dialogId) && !!store.getState().dialogs.dialogs.find(x => x._id === dialogId).messages.length)\r\n        lastMessage = store.getState().dialogs.dialogs.find(x => x._id === dialogId).messages.filter(x => !messageIds.find(y => y === x._id)).pop()\r\n    else \r\n        lastMessage = false\r\n\r\n    dispatch({\r\n        type: DIALOGS_DELETE_MESSAGE,\r\n        payload: {dialogId, messageIds, lastMessage}\r\n    })\r\n}\r\n\r\nexport const loadMessages = ({dialogId}, apiToken) => (dispatch) => {\r\n    let lastMessage = store.getState().dialogs.dialogs.find(x => x._id === dialogId).messages[0]\r\n\r\n    dispatch({\r\n        type: DIALOGS_SET_LOADING,\r\n        payload: dialogId\r\n    })\r\n\r\n    dispatch({\r\n        type: DIALOGS_LOAD_MESSAGES,\r\n        payload: {dialogId,  messages: [], canLoad: false}\r\n    })\r\n\r\n    fetch(`${urlApi}/api/dialog/load-messages`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                dialogId,\r\n                lastMessageId: lastMessage._id\r\n            })\r\n        }) \r\n        .then(response => response.json())\r\n        .then(messages => {\r\n            dispatch({\r\n                type: DIALOGS_LOAD_MESSAGES,\r\n                payload: {dialogId,  messages: messages.reverse(), canLoad: messages.length  === 50}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            \r\n        })\r\n}","// App\r\nimport React from 'react'\r\n\r\nimport Avatar from '../User/Avatar'\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\n\r\nimport '../../Css/Partials/RoomItem.css'\r\nimport { Link } from 'react-router-dom';\r\n\r\n// Material\r\nimport Button from '@material-ui/core/Button';\r\n\r\nclass RoomItem extends React.Component {\r\n    render() {\r\n        return (\r\n            <Link style={{textDecoration: 'none'}} to={`/rooms/${this.props.room._id}`}>\r\n                <Button className=\"room-item\" title={`Room ${this.props.room.title}`}>\r\n                    <Avatar style={{width: 40, height: 40, fontSize: 14, fontWeight: 600, backgroundColor: `rgb(${this.props.room.color})`}} name={this.props.room.title.charAt(0)} />\r\n                    <div>\r\n                        <p>{this.props.room.isPrivate && <LockOutlinedIcon />}{this.props.room.title}</p>\r\n                        <div className=\"users\">\r\n                            {this.props.room.users.map((user, index) => \r\n                                <Avatar key={index} style={{width: 16, height: 16, fontSize: 8, backgroundColor: `rgb(${user.color})`}} name={user.name.first.charAt(0)+user.name.last.charAt(0)} />\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </Button>\r\n            </Link>\r\n        )\r\n    }\r\n}\r\n\r\nexport default RoomItem","import React from 'react'\r\n\r\nexport default function showLoading(element) {\r\n    return <>\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n        {element}\r\n    </>\r\n}","export function getHM(date) {\r\n    var time = new Date(date)\r\n\r\n    var hours = time.getHours()\r\n    var minutes = time.getMinutes()\r\n\r\n    if (minutes.toString().length === 1) {\r\n        minutes = \"0\" + minutes;\r\n    }\r\n    if (hours.toString().length === 1) {\r\n        hours = \"0\" + hours;\r\n    }\r\n\r\n    return hours + \":\" + minutes\r\n}\r\n\r\nexport function timeAt(date) {\r\n    var time = new Date(date)\r\n\r\n    var day_diff = new Date().getDate() - time.getDate(),\r\n        year_diff = new Date().getFullYear() - time.getFullYear();\r\n    var year = time.getFullYear(),\r\n        month = time.getMonth()+1,\r\n        day = time.getDate();\r\n        \r\n    if (year_diff > 0)\r\n        return (\r\n            year.toString()+'.'\r\n            +((month<10) ? '0'+month.toString() : month.toString())+'.'\r\n            +((day<10) ? '0'+day.toString() : day.toString())\r\n        );\r\n\r\n    var arr=[\r\n        'January',\r\n        'February',\r\n        'March',\r\n        'April',\r\n        'May',\r\n        'June',\r\n        'July',\r\n        'August',\r\n        'September',\r\n        'October',\r\n        'November',\r\n        'December'\r\n    ];\r\n\r\n    var r =\r\n    ( \r\n        (\r\n            day_diff === 0 && 'Today'\r\n        )\r\n        || (day_diff === 1 && 'Yesterday')\r\n        || (year_diff === 0 && day + ' ' + arr[month-1])\r\n    );\r\n    return r;\r\n}\r\n\r\nexport function LastMessageDate(time) {\r\n    var time = new Date(time)\r\n\r\n    var hours = time.getHours()\r\n    var minutes = time.getMinutes()\r\n\r\n    if (minutes.toString().length == 1) {\r\n        minutes = \"0\" + minutes;\r\n    }\r\n    if (hours.toString().length == 1) {\r\n        hours = \"0\" + hours;\r\n    }\r\n\r\n    var diff = (((new Date()).getTime() - time.getTime()) / 1000),\r\n        day_diff = new Date().getDate() - time.getDate(),\r\n        year_diff = new Date().getFullYear() - time.getFullYear();\r\n    var year = time.getFullYear(),\r\n        month = time.getMonth()+1,\r\n        day = time.getDate();\r\n        \r\n    if (year_diff > 0)\r\n        return (\r\n            year.toString()+'.'\r\n            +((month<10) ? '0'+month.toString() : month.toString())+'.'\r\n            +((day<10) ? '0'+day.toString() : day.toString())\r\n        );\r\n\r\n    var arr=[\r\n        'January',\r\n        'February',\r\n        'March',\r\n        'April',\r\n        'May',\r\n        'June',\r\n        'July',\r\n        'August',\r\n        'September',\r\n        'October',\r\n        'November',\r\n        'December'\r\n    ];\r\n\r\n    var r =\r\n    ( \r\n        (\r\n            day_diff == 0 && \r\n            (hours + ':' +  minutes)\r\n        )\r\n        || (day_diff === 1 && 'Yesterday')\r\n        || (year_diff === 0 && day + ' ' + arr[month-1])\r\n    );\r\n\r\n    return r;\r\n}","import React from 'react'\r\n\r\n// Material\r\nimport Button from '@material-ui/core/Button';\r\n\r\n// Icons\r\n\r\n\r\nclass ActionMenu extends React.Component {\r\n    state = {\r\n        active: false,\r\n        left: 0,\r\n        top: 0\r\n    }\r\n\r\n    toggleActive() {\r\n        let element = document.getElementById(this.props.from)\r\n        let rect = element.getBoundingClientRect()\r\n        \r\n        this.setState({left: rect.x+element.clientWidth, top: rect.y})\r\n        this.setState({active: !this.state.active})\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.getElementById(this.props.from).addEventListener('mouseenter', this.toggleActive.bind(this))\r\n        document.getElementById(this.props.from).addEventListener('mouseleave', this.toggleActive.bind(this))\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.getElementById(this.props.from).removeEventListener('mouseenter', this.toggleActive.bind(this))\r\n        document.getElementById(this.props.from).removeEventListener('mouseleave', this.toggleActive.bind(this))\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div style={{left: this.state.left, top: this.state.top}} className={`action-menu-container ${this.state.active ? 'active' : ''}`}>\r\n                <div className={`action-menu`}>\r\n                    {this.props.actions.map((action, index) => {\r\n                        return <Button key={index} onClick={() => {action.action()}} className=\"action-button\">{action.text}</Button>\r\n                    })}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default ActionMenu","// App\r\nimport React from 'react'\r\n\r\nimport Avatar from '../User/Avatar'\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\n\r\nimport '../../Css/Partials/RoomItem.css'\r\nimport { NavLink, withRouter } from 'react-router-dom';\r\n\r\n// Material\r\nimport Button from '@material-ui/core/Button';\r\nimport { LastMessageDate } from '../../Controllers/TimeController';\r\nimport { connect } from 'react-redux';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\nimport QueryBuilderIcon from '@material-ui/icons/QueryBuilder';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\n\r\nimport * as dialogsActions from '../../Redux/actions/dialogs'\r\nimport { bindActionCreators } from 'redux'\r\n\r\nimport ActionMenu from '../ActionMenu'\r\nimport { randomInteger } from '../../Controllers/FunctionsController';\r\n\r\nclass DialogItem extends React.Component {\r\n    state = {\r\n        randomId: randomInteger(0, 100000)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <NavLink style={{textDecoration: 'none'}} onClick={(e) => {\r\n                if(`/chats/${this.props.user._id}` === this.props.history.location.pathname)\r\n                    e.preventDefault()\r\n            }} className=\"dialog-link\" to={`/chats/${this.props.user._id}`}>\r\n                <Button className={`dialog-item`}>\r\n                    <Avatar style={{width: 40, height: 40, fontSize: 14, fontWeight: 600, backgroundColor: `rgb(${this.props.user.color})`}} name={this.props.user.name.first.charAt(0) + this.props.user.name.last.charAt(0)} />\r\n                    <div>\r\n                        <p className=\"user-name\">{`${this.props.user.name.first} ${this.props.user.name.last}`}</p>\r\n                        {!this.props.typing && <p className=\"last-message\">\r\n                            {this.props.lastMessage.user._id === this.props.myUser._id && <span style={{color: '#999999'}}>You:&nbsp;</span>}\r\n                            {this.props.lastMessage.text && <>{this.props.lastMessage.text}</>}\r\n                            \r\n                            {!this.props.lastMessage.text && \r\n                            this.props.lastMessage.images.length === 1 && \r\n                                <><span style={{color: '#008FF7'}}>{this.props.lastMessage.images[0].name}</span></>\r\n                            }\r\n\r\n                            {!this.props.lastMessage.text && \r\n                            this.props.lastMessage.images.length > 1 && \r\n                                <><span style={{color: '#008FF7'}}>Фотографии [{this.props.lastMessage.images.length}]</span></>\r\n                            }\r\n\r\n                            {!this.props.lastMessage.text && \r\n                            !this.props.lastMessage.images.length && \r\n                            this.props.lastMessage.sounds.length === 1 &&\r\n                                <><span style={{color: '#008FF7'}}>{this.props.lastMessage.sounds[0].name}</span></>\r\n                            }\r\n\r\n                            {!this.props.lastMessage.text && \r\n                            !this.props.lastMessage.images.length && \r\n                            this.props.lastMessage.sounds.length > 1 &&\r\n                                <><span style={{color: '#008FF7'}}>Аудио [{this.props.lastMessage.sounds.length}]</span></>\r\n                            }\r\n\r\n                            {!this.props.lastMessage.text && \r\n                            !this.props.lastMessage.images.length && \r\n                            !this.props.lastMessage.sounds.length &&\r\n                            this.props.lastMessage.files.length === 1 &&\r\n                                <><span style={{color: '#008FF7'}}>{this.props.lastMessage.files[0].name}</span></>\r\n                            }\r\n\r\n                            {!this.props.lastMessage.text && \r\n                            !this.props.lastMessage.images.length && \r\n                            !this.props.lastMessage.sounds.length &&\r\n                            this.props.lastMessage.files.length > 1 &&\r\n                                <><span style={{color: '#008FF7'}}>Файлы [{this.props.lastMessage.files.length}]</span></>\r\n                            }\r\n                        </p>}\r\n                        {this.props.typing && <p className=\"last-message typing\">{this.props.user.name.first} typing</p>}\r\n                    </div>\r\n                    <div className=\"dialog-info\">\r\n                        <span className=\"time-at\">{LastMessageDate(this.props.lastMessage.createdAt)}</span>\r\n                        {(this.props.lastMessage.user._id === this.props.myUser._id && !this.props.lastMessage.isError && this.props.lastMessage.isLoading) && <QueryBuilderIcon style={{marginTop: 2, fontSize: 16, color: '#B8C3CF'}} />}\r\n                        {(this.props.lastMessage.user._id === this.props.myUser._id && !this.props.lastMessage.isError && !this.props.lastMessage.isLoading && !this.props.lastMessage.isRead) && <DoneIcon style={{marginTop: 2, fontSize: 16, color: '#B8C3CF'}} />}\r\n                        {(this.props.lastMessage.user._id === this.props.myUser._id && !this.props.lastMessage.isError && !this.props.lastMessage.isLoading && this.props.lastMessage.isRead) && <DoneAllIcon style={{marginTop: 2, fontSize: 16, color: '#008FF7'}} />}\r\n                        {(this.props.lastMessage.user._id !== this.props.myUser._id && !!this.props.noRead) && <span className=\"unread-messages-count\">{this.props.noRead}</span>}\r\n                        {(this.props.lastMessage.user._id !== this.props.myUser._id && !this.props.noRead) && <span style={{height: 18}}></span>}\r\n                        {(this.props.lastMessage.user._id === this.props.myUser._id && !this.props.lastMessage.isLoading && this.props.lastMessage.isError) && <>\r\n                            <ActionMenu actions={[\r\n                                {text: 'Retry', action: () => {\r\n                                    let message = this.props.lastMessage\r\n                                    message.userId = this.props.user._id\r\n                                    message.dialogId = this.props.dialogId\r\n                                    this.props.dialogsActions.retrySendMessage(message, this.props.myUser.apiToken)\r\n                                }},\r\n                                {text: 'Delete', action: () => {\r\n                                    this.props.dialogsActions.deleteLocalMessage(this.props.lastMessage._id, this.props.dialogId)\r\n                                }},\r\n                            ]} from={'message-error-actions-'+this.state.randomId} />\r\n                            <ErrorOutlineIcon className='error' id={'message-error-actions-'+this.state.randomId} style={{marginTop: 2, fontSize: 16, color: '#FF3333'}} />\r\n                        </>}\r\n                    </div>\r\n                </Button>\r\n            </NavLink>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        myUser: state.user,\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        dialogsActions: bindActionCreators(dialogsActions, dispatch)\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(DialogItem))","// App\r\nimport React from 'react'\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\nimport {PageSettings} from '../Pages/PageSettings'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as dialogsActions from '../Redux/actions/dialogs'\r\nimport { bindActionCreators } from 'redux'\r\nimport RoomItem from '../Partials/Room/RoomItem'\r\n\r\n// Material\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { withStyles, Tooltip } from '@material-ui/core'\r\nimport showLoading from '../Partials/Loading'\r\nimport DialogItem from '../Partials/Dialog/DialogItem';\r\nimport { withRouter } from 'react-router-dom';\r\nimport ChatBubbleIcon from '@material-ui/icons/ChatBubble';\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#008FF7',\r\n        position: 'absolute',\r\n        bottom: 20,\r\n        right: 20,\r\n        '&:hover': {\r\n            backgroundColor: '#008FF7',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Messages extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    state = {\r\n        showBtnAdd: true,\r\n        scrollTop: 0\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n\r\n        // if(!this.props.dialogs.getted) {\r\n        //     this.props.dialogsActions.dialogsGet(this.props.user.apiToken)\r\n        // }\r\n    }\r\n\r\n    onScroll() {\r\n        if(this.state.scrollTop < this.messagesBlock.getScrollTop()) {\r\n            if(this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: false})\r\n        } else {\r\n            if(!this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: true})\r\n        }\r\n\r\n        this.setState({scrollTop: this.messagesBlock.getScrollTop()})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if(nextState.scrollTop !== this.state.scrollTop) {\r\n            return false\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <> \r\n                <div className=\"col-xl-3 col-lg-6 col-md-6 sidebar\">\r\n                    <h2 className=\"sidebar-title\">Chats</h2>\r\n\r\n                    <Scrollbars\r\n                        ref={(ref) => {this.messagesBlock = ref}}\r\n                        renderTrackVertical={props => <div className=\"track-vertical\"/>}\r\n                        renderThumbVertical={props => <div className=\"thumb-vertical\"/>}\r\n                        className=\"scroll\"\r\n                        onScroll={() => {this.onScroll()}}\r\n                        style={{height: 'calc(100% - 78px)'}}\r\n                        autoHide\r\n                    >\r\n                        {this.props.dialogs.isFetching && showLoading(<div className=\"room-item\">\r\n                            <Skeleton variant=\"circle\" width={40} height={40} />\r\n                            <Skeleton variant=\"text\" style={{marginLeft: 12, flex: '1 1'}} />\r\n                        </div>)}\r\n                        {this.props.dialogs.dialogs.map((dialog, index) => {\r\n                            return dialog.lastMessage && (\r\n                                <DialogItem key={index} dialogId={dialog._id} typing={dialog.typing} noRead={dialog.noRead} lastMessage={dialog.lastMessage} user={dialog.user} />\r\n                            )\r\n                        })}\r\n                    </Scrollbars>\r\n\r\n                    {!this.props.dialogs.dialogs.find(x => x.lastMessage) && <div className=\"data-empty\">\r\n                        <ChatBubbleIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                        <p>You dont have chats, lets create new</p>\r\n                    </div>}\r\n\r\n                    <Tooltip title=\"Create dialog\" className={`scroll-to-bottom ${this.state.showBtnAdd ? 'active' : ''}`} placement=\"top\">\r\n                        <CustomFab color=\"primary\" size=\"small\" aria-label=\"add\" onClick={() => {}}>\r\n                            <AddIcon />\r\n                        </CustomFab>\r\n                    </Tooltip>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms,\r\n        dialogs: state.dialogs\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        dialogsActions: bindActionCreators(dialogsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Messages))\r\n","import { \r\n    ROOMS_GET,\r\n    ROOMS_ADD,\r\n    ROOMS_JOIN_ROOM,\r\n    ROOMS_LEAVE_ROOM,\r\n    ROOMS_ADD_MESSAGE,\r\n    ROOMS_SUCCESS_MESSAGE,\r\n    ROOMS_ERROR_MESSAGE,\r\n    ROOMS_EDIT_MESSAGE,\r\n    ROOMS_READ_MESSAGE,\r\n    ROOMS_JOIN_ERROR,\r\n    ROOMS_DELETE_MESSAGE,\r\n    ROOMS_READ_MESSAGES,\r\n    ROOMS_LOAD_MESSAGES,\r\n    ROOMS_SET_LOADING,\r\n    ROOMS_GET_ERROR,\r\n    ROOMS_SET_GET\r\n} from '../constants'\r\nimport SocketController from '../../Controllers/SocketController';\r\nimport store from '../store';\r\nimport WebRtcController from '../../Controllers/WebRtcController'\r\nimport { randomInteger, setForceTitle } from '../../Controllers/FunctionsController';\r\nimport {urlApi} from '../../config'\r\n\r\nexport const roomsGet = (apiToken, lang) => (dispatch) => {\r\n    dispatch({\r\n        type: ROOMS_SET_GET,\r\n    })\r\n\r\n    fetch(`${urlApi}/api/room/get-all`, {\r\n        method: \"post\",\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${apiToken}`,\r\n        },\r\n        body: JSON.stringify({\r\n            lang\r\n        })\r\n    })\r\n    .then((response) => response.json())\r\n    .then((rooms) => {\r\n        dispatch({\r\n            type: ROOMS_GET,\r\n            payload: rooms\r\n        })\r\n\r\n        SocketController.joinLang(lang)\r\n    })\r\n    .catch((err) => {\r\n        dispatch({\r\n            type: ROOMS_GET_ERROR,\r\n        })\r\n    })\r\n}\r\n\r\nexport const roomsAdd = room => (dispatch) => {\r\n    dispatch({\r\n        type: ROOMS_ADD,\r\n        payload: room\r\n    })\r\n}\r\n\r\nexport const joinRoom = ({id, apiToken}) => (dispatch) => {\r\n    fetch(`${urlApi}/api/room/get`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                id,\r\n                socketId: SocketController.getSocketId()\r\n            })\r\n        })\r\n        .then(response => response.json())\r\n        .then(room => {\r\n            if(room.error) {\r\n                setForceTitle('Error')\r\n\r\n                dispatch({\r\n                    type: ROOMS_JOIN_ERROR,\r\n                    payload: room.errors[0]\r\n                })\r\n                \r\n                return\r\n            }\r\n\r\n            room.dialog.messages = room.dialog.messages.reverse()\r\n\r\n            room.users.map(x => {\r\n                x.speaking = false\r\n            })\r\n\r\n            setForceTitle(room.title)\r\n\r\n            dispatch({\r\n                type: ROOMS_JOIN_ROOM,\r\n                payload: {room, canLoad: room.dialog.messages.length === 50}\r\n            })\r\n            \r\n            SocketController.joinRoom({roomId: room._id, lang: room.lang})\r\n            WebRtcController.connectRoom(room._id)\r\n        })\r\n        .catch((err) => {\r\n            dispatch({\r\n                type: ROOMS_JOIN_ERROR,\r\n                payload: {param: 'all', msg: 'something_goes_wrong'}\r\n            })\r\n        })\r\n}\r\n\r\nexport const leaveRoom = (roomId, lang) => (dispatch) => {\r\n    WebRtcController.leaveRoom({roomId, lang})\r\n    dispatch({\r\n        type: ROOMS_LEAVE_ROOM\r\n    })\r\n}\r\n\r\nexport const sendMessage = (message, apiToken) => (dispatch) => {\r\n    let formData = new FormData()\r\n    let _id = randomInteger(0, 1000000)\r\n    let images = []\r\n    let files = []\r\n    let sounds = []\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        formData.append('images'+i, message.images[i].file)\r\n        message.images[i].file = false\r\n        images.push(message.images[i])\r\n    }\r\n\r\n    for (let i = 0; i < message.files.length; i++) {\r\n        formData.append('files'+i, message.files[i].file)\r\n        message.files[i].file = false\r\n        files.push(message.files[i])\r\n    }\r\n\r\n    for (let i = 0; i < message.sounds.length; i++) {\r\n        formData.append('sounds'+i, message.sounds[i].file)\r\n        message.sounds[i].file = false\r\n        sounds.push(message.sounds[i])\r\n    }\r\n\r\n    let localMessage = {\r\n        _id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images,\r\n        sounds,\r\n        files,\r\n        isLoading: true,\r\n        isError: false,\r\n        isRead: false,\r\n        recentMessages: message.recentMessages,\r\n        createdAt: Date.now(),\r\n    }\r\n    \r\n    dispatch({\r\n        type: ROOMS_ADD_MESSAGE,\r\n        payload: localMessage\r\n    })\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('roomId', message.roomId)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n    // formData.append('apiToken', apiToken)\r\n\r\n    fetch(`${urlApi}/api/room/send-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                // 'Accept': 'application/json',\r\n                // 'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            if(messageRes.error) {\r\n                return dispatch({\r\n                    type: ROOMS_ERROR_MESSAGE,\r\n                    payload: _id\r\n                })\r\n            }\r\n            dispatch({\r\n                type: ROOMS_SUCCESS_MESSAGE,\r\n                payload: {_id, _newId: messageRes._id}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: ROOMS_ERROR_MESSAGE,\r\n                payload: _id\r\n            })\r\n        })\r\n}\r\n\r\nexport const editMessage = (message, apiToken) => (dispatch) => {\r\n    let formData = new FormData()\r\n\r\n    let images = []\r\n    let files = []\r\n    let sounds = []\r\n\r\n    let oldImages = []\r\n    let oldFiles = []\r\n    let oldSounds = []\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        if(message.images[i].file) {\r\n            formData.append('images'+i, message.images[i].file)\r\n\r\n            images.push(message.images[i])\r\n        } else {\r\n            oldImages.push(message.images[i].id)\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < message.files.length; i++) {\r\n        if(message.files[i].file) {\r\n            formData.append('files'+i, message.files[i].file)\r\n\r\n            files.push(message.files[i])\r\n        } else {\r\n            oldFiles.push(message.files[i].id)\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < message.sounds.length; i++) {\r\n        if(message.sounds[i].file) {\r\n            formData.append('sounds'+i, message.sounds[i].file)\r\n\r\n            sounds.push(message.sounds[i])\r\n        } else {\r\n            oldSounds.push(message.sounds[i].id)\r\n        }        \r\n    }\r\n\r\n    let localMessage = {\r\n        _id: message._id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images: message.images,\r\n        sounds: message.sounds,\r\n        files: message.files,\r\n        isLoading: true,\r\n        isError: false,\r\n        recentMessages: message.recentMessages,\r\n    }\r\n    \r\n    dispatch({\r\n        type: ROOMS_EDIT_MESSAGE,\r\n        payload: localMessage\r\n    })\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n    message.roomId = store.getState().rooms.activeRoom._id\r\n    \r\n    formData.append('_id', message._id)\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('roomId', message.roomId)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n    formData.append('oldImages', oldImages)\r\n    formData.append('oldSounds', oldSounds)\r\n    formData.append('oldFiles', oldFiles)\r\n\r\n    fetch(`${urlApi}/api/room/edit-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            if(messageRes.error) {\r\n                return dispatch({\r\n                    type: ROOMS_ERROR_MESSAGE,\r\n                    payload: message._id\r\n                })\r\n            }\r\n            dispatch({\r\n                type: ROOMS_SUCCESS_MESSAGE,\r\n                payload: {_id: message._id, _newId: message._id}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: ROOMS_ERROR_MESSAGE,\r\n                payload: message._id\r\n            })\r\n        })\r\n}\r\n\r\nexport const deleteMessage = ({roomId, deleteMessages}, apiToken) => (dispatch) => {\r\n    let messageIds = []\r\n    deleteMessages.map(m => {\r\n        messageIds.push(m._id)\r\n    })\r\n\r\n    dispatch({\r\n        type: ROOMS_DELETE_MESSAGE,\r\n        payload: messageIds\r\n    })\r\n\r\n    fetch(`${urlApi}/api/room/delete-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                roomId,\r\n                messageIds,\r\n                socketId: SocketController.getSocketId()\r\n            })\r\n        })\r\n        .then()\r\n        .catch(() => {\r\n            \r\n        })\r\n}\r\n\r\nexport const deleteLocalMessage = (_id) => (dispatch) => {\r\n    dispatch({\r\n        type: ROOMS_DELETE_MESSAGE,\r\n        payload: [_id]\r\n    })\r\n}\r\n\r\nexport const retrySendMessage = (message, apiToken) => (dispatch) => {\r\n    let formData = new FormData()\r\n    let images = []\r\n\r\n    let localMessage = {\r\n        _id: message._id,\r\n        user: store.getState().user,\r\n        text: message.text,\r\n        images: message.images,\r\n        sounds: [],\r\n        files: [],\r\n        isLoading: true,\r\n        isError: false,\r\n        recentMessages: message.recentMessages,\r\n        createdAt: Date.now(),\r\n    }\r\n\r\n    dispatch({\r\n        type: ROOMS_DELETE_MESSAGE,\r\n        payload: [message._id]\r\n    })\r\n\r\n    dispatch({\r\n        type: ROOMS_ADD_MESSAGE,\r\n        payload: localMessage\r\n    })\r\n\r\n    for (let i = 0; i < message.images.length; i++) {\r\n        formData.append('images'+i, message.images[i].file)\r\n\r\n        images.push(message.images[i].path)\r\n    }\r\n\r\n    let recentMessages = []\r\n\r\n    message.recentMessages.map(m => {\r\n        recentMessages.push(m._id)\r\n    })\r\n\r\n    message.recentMessages = recentMessages\r\n    message.socketId = SocketController.getSocketId()\r\n\r\n    formData.append('text', message.text)\r\n    formData.append('recentMessages', message.recentMessages)\r\n    formData.append('roomId', message.roomId)\r\n    formData.append('dialogId', message.dialogId)\r\n    formData.append('socketId', SocketController.getSocketId())\r\n\r\n    fetch(`${urlApi}/api/room/send-message`, {\r\n            method: \"post\",\r\n            headers: {\r\n                // 'Accept': 'application/json',\r\n                // 'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: formData\r\n        })\r\n        .then(response => response.json())\r\n        .then(messageRes => {\r\n            dispatch({\r\n                type: ROOMS_SUCCESS_MESSAGE,\r\n                payload: {_id: message._id, _newId: messageRes._id}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            dispatch({\r\n                type: ROOMS_ERROR_MESSAGE,\r\n                payload: message._id\r\n            })\r\n        })\r\n}\r\n\r\nexport const readMessages = ({dialogId, userId, roomId}, apiToken) => (dispatch) => {\r\n    let readMessages = store.getState().rooms.activeRoom.dialog.messages.filter(x => !x.isRead && x.user._id !== userId)\r\n\r\n    setTimeout(() => {\r\n        if(!!readMessages.length) {\r\n            dispatch({\r\n                type: ROOMS_READ_MESSAGES,\r\n                payload: userId\r\n            })\r\n        }\r\n    }, 750)\r\n\r\n    if(!!readMessages.length) {\r\n        fetch(`${urlApi}/api/room/read-messages`, {\r\n                method: \"post\",\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json',\r\n                    Authorization: `Bearer ${apiToken}`,\r\n                },\r\n                body: JSON.stringify({\r\n                    dialogId,\r\n                    roomId\r\n                })\r\n            })\r\n            .then()\r\n            .catch(() => {\r\n                \r\n            })\r\n    }\r\n}\r\n\r\nexport const loadMessages = ({dialogId, userId, roomId}, apiToken) => (dispatch) => {\r\n    let lastMessage = store.getState().rooms.activeRoom.dialog.messages[0]\r\n\r\n    dispatch({\r\n        type: ROOMS_SET_LOADING\r\n    })\r\n\r\n    dispatch({\r\n        type: ROOMS_LOAD_MESSAGES,\r\n        payload: {messages: [], canLoad: false}\r\n    })\r\n\r\n    fetch(`${urlApi}/api/room/load-messages`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                dialogId,\r\n                lastMessageId: lastMessage._id\r\n            })\r\n        })\r\n        .then(response => response.json())\r\n        .then(messages => {\r\n            dispatch({\r\n                type: ROOMS_LOAD_MESSAGES,\r\n                payload: {messages: messages.reverse(), canLoad: messages.length  === 50}\r\n            })\r\n        })\r\n        .catch(() => {\r\n            \r\n        })\r\n}","// App\r\nimport React from 'react'\r\nimport Modal from 'react-modal';\r\n\r\n// Material\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as roomsActions from '../Redux/actions/rooms'\r\nimport { bindActionCreators } from 'redux'\r\nimport {urlApi} from '../config'\r\n\r\nimport SocketController from '../Controllers/SocketController';\r\n\r\nconst customStylesModal = {\r\n    overlay: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        backgroundColor: 'rgba(0, 0, 0, 0.25)',\r\n        zIndex: 4\r\n    },\r\n    content : {\r\n        top                   : '50%',\r\n        left                  : '50%',\r\n        right                 : 'auto',\r\n        bottom                : 'auto',\r\n        minWidth              : '300px',\r\n        marginRight           : '-50%',\r\n        transform             : 'translate(-50%, -50%)',\r\n        borderRadius          : '10px',\r\n        boxShadow             : '0px 5px 30px rgba(0, 0, 0, 0.16)'\r\n    }\r\n};\r\n\r\nconst checkBoxStyles = theme => ({\r\n    root: {\r\n        color: '#CCD1D6',\r\n        '&$checked': {\r\n            color: '#008FF7',\r\n            border: 'none'\r\n        },\r\n        '&:hover': {\r\n            backgroundColor: 'transparent',\r\n        }\r\n    },\r\n    checked: {},\r\n})\r\n\r\nconst CustomCheckbox = withStyles(checkBoxStyles)(Checkbox);\r\n\r\nclass CreateRoom extends React.Component {\r\n    state = {\r\n        title: '',\r\n        isPrivate: false\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault()\r\n\r\n        fetch(`${urlApi}/api/room/create`, {\r\n            method: \"post\",\r\n            headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${this.props.user.apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                title: this.state.title,\r\n                isPrivate: this.state.isPrivate,\r\n                lang: this.props.user.roomLang\r\n            })\r\n        })\r\n        .then((response) => response.json())\r\n        .then((room) => {\r\n            this.props.roomsActions.roomsAdd(room)\r\n            SocketController.createRoom({room, lang: this.props.user.roomLang})\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        return <Modal\r\n            isOpen={this.props.isOpen}\r\n            onRequestClose={() => {this.props.close()}}\r\n            style={customStylesModal}\r\n            contentLabel=\"Create room\"\r\n        >\r\n            <h2 className=\"modal-title\">New room</h2>\r\n\r\n            <form onSubmit={(e) => {this.onSubmit(e)}}>\r\n                <input \r\n                    value={this.state.title} \r\n                    onChange={(e) => {this.setState({title: e.target.value})}} \r\n                    className=\"input-field\" \r\n                    type=\"text\"\r\n                    style={{marginBottom: 10}} \r\n                    placeholder=\"Title\" \r\n                />\r\n\r\n                <FormControlLabel \r\n                    control={\r\n                        <CustomCheckbox\r\n                            checked={this.state.isPrivate}\r\n                            onChange={() => {this.setState({isPrivate: !this.state.isPrivate})}} \r\n                        />\r\n                    }\r\n                    style={{color: '#667788'}}\r\n                    label=\"Private theme\"\r\n                />\r\n\r\n                <button className=\"button-blue\" type=\"submit\" style={{width: 'max-content'}}>Next</button>\r\n            </form>\r\n        </Modal>\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        roomsActions: bindActionCreators(roomsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateRoom)","// App\r\nimport React from 'react'\r\nimport {PageSettings} from '../Pages/PageSettings'\r\nimport RoomItem from '../Partials/Room/RoomItem'\r\nimport SocketController from '../Controllers/SocketController'\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\n// Modal\r\nimport ModalCreateRoom from '../Modals/CreateRoom'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as roomsActions from '../Redux/actions/rooms'\r\nimport { bindActionCreators } from 'redux'\r\n\r\n// Material\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { withStyles, Tooltip } from '@material-ui/core'\r\nimport showLoading from '../Partials/Loading'\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport AppsIcon from '@material-ui/icons/Apps';\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#008FF7',\r\n        position: 'absolute',\r\n        bottom: 20,\r\n        right: 20,\r\n        '&:hover': {\r\n            backgroundColor: '#008FF7',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Rooms extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    state = {\r\n        isOpenCreateRoom: false,\r\n        scrollTop: 0,\r\n        showBtnAdd: true\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n\r\n        if(!this.props.rooms.getted) {\r\n            this.props.roomsActions.roomsGet(this.props.user.apiToken, this.props.user.roomLang)\r\n        }\r\n    }\r\n\r\n    onScroll() {\r\n        if(this.state.scrollTop < this.roomsBlock.getScrollTop()) {\r\n            if(this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: false})\r\n        } else {\r\n            if(!this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: true})\r\n        }\r\n\r\n        this.setState({scrollTop: this.roomsBlock.getScrollTop()})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if(nextState.scrollTop !== this.state.scrollTop) {\r\n            return false\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <ModalCreateRoom isOpen={this.state.isOpenCreateRoom} close={() => {this.setState({isOpenCreateRoom: false})}} />\r\n\r\n                <div className=\"col-xl-3 col-lg-6 col-md-6 sidebar\" style={{overflow: 'hidden'}}>\r\n                    <h2 className=\"sidebar-title\">Rooms</h2>\r\n\r\n                    <Scrollbars\r\n                        ref={(ref) => {this.roomsBlock = ref}}\r\n                        renderTrackVertical={props => <div className=\"track-vertical\"/>}\r\n                        renderThumbVertical={props => <div className=\"thumb-vertical\"/>}\r\n                        className=\"scroll\"\r\n                        onScroll={() => {this.onScroll()}}\r\n                        style={{height: 'calc(100% - 78px)'}}\r\n                        autoHide\r\n                    >\r\n                        {this.props.rooms.isFetching && showLoading(<div className=\"room-item\">\r\n                            <Skeleton variant=\"circle\" width={40} height={40} />\r\n                            <Skeleton variant=\"text\" style={{marginLeft: 12, flex: '1 1'}} />\r\n                        </div>)}\r\n                        {this.props.rooms.rooms.map((room, index) => {\r\n                            return (\r\n                                <RoomItem key={index} room={room} />\r\n                            )\r\n                        })}\r\n\r\n                        \r\n                    </Scrollbars>\r\n\r\n                    {!this.props.rooms.isFetching && !this.props.rooms.isError && !this.props.rooms.rooms.length && <div className=\"data-empty\">\r\n                        <AppsIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                        <p>Create your first room in this language</p>\r\n                    </div>}\r\n\r\n                    {!this.props.rooms.isFetching && this.props.rooms.isError && <div className=\"data-empty\">\r\n                        <WarningIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                        <p>Что то пошло не так...</p>\r\n\r\n                        <button onClick={() => {this.props.roomsActions.roomsGet(this.props.user.apiToken, this.props.user.roomLang)}} className=\"button-gray\" type=\"submit\" style={{width: 'max-content'}}>Retry</button>\r\n                    </div>}\r\n\r\n                    <Tooltip title=\"Create room\" className={`scroll-to-bottom ${this.state.showBtnAdd ? 'active' : ''}`} placement=\"top\">\r\n                        <CustomFab color=\"primary\" size=\"small\" aria-label=\"add\" onClick={() => {this.setState({isOpenCreateRoom: true})}}>\r\n                            <AddIcon />\r\n                        </CustomFab>\r\n                    </Tooltip>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        roomsActions: bindActionCreators(roomsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Rooms)","// App\r\nimport React from 'react'\r\n\r\nimport {PageSettings} from '../Pages/PageSettings'\r\n\r\nclass Notifications extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <> \r\n                <div className=\"col-xl-3 col-lg-6 col-md-6 sidebar\">\r\n                    <h2 className=\"sidebar-title\">Notifications</h2>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Notifications\r\n","import { \r\n    USER_LOGIN,\r\n    USER_LOGOUT,\r\n    USER_UPDATE_ROOM_LANG,\r\n    DIALOGS_GET\r\n} from '../constants'\r\nimport store from '../store'\r\n\r\n\r\nexport const loginUser = (user, dialogs, noReadCount, apiToken) => (dispatch) => {\r\n    user.apiToken = apiToken\r\n    \r\n    dispatch({\r\n        type: USER_LOGIN,\r\n        payload: user\r\n    })\r\n\r\n    for (let i = 0; i < dialogs.length; i++) {\r\n        dialogs[i].user = dialogs[i].users.find(user => user._id !== store.getState().user._id)\r\n\r\n        if(!dialogs[i].user)\r\n            dialogs[i].user = dialogs[i].users[0]\r\n\r\n        dialogs[i].typing = false\r\n        dialogs[i].getted = false\r\n        dialogs[i].isLoading = false\r\n\r\n        if(dialogs[i].lastMessage) {\r\n            dialogs[i].lastMessage.isLoading = false\r\n            dialogs[i].lastMessage.isError = false\r\n        }\r\n\r\n        if(dialogs[i].lastMessage && dialogs[i].lastMessage.user._id === store.getState().user._id)\r\n            dialogs[i].noRead = 0\r\n    }\r\n\r\n    dispatch({\r\n        type: DIALOGS_GET,\r\n        payload: {dialogs, noReadCount}\r\n    })\r\n}\r\n\r\nexport const logoutUser = () => (dispatch) => {\r\n    dispatch({\r\n        type: USER_LOGOUT\r\n    })\r\n}\r\n\r\nexport const updateRoomLang = (lang) => (dispatch) => {\r\n    dispatch({\r\n        type: USER_UPDATE_ROOM_LANG,\r\n        payload: lang\r\n    })\r\n}","// App\r\nimport React from 'react'\r\nimport {PageSettings} from '../Pages/PageSettings'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as userActions from '../Redux/actions/user'\r\nimport * as roomsActions from '../Redux/actions/rooms'\r\nimport { bindActionCreators } from 'redux'\r\nimport { withRouter } from 'react-router-dom'\r\nimport {urlApi} from '../config'\r\nimport SocketController from '../Controllers/SocketController'\r\n\r\nclass Languages extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    updateRoomLang(lang) {\r\n        this.props.userActions.updateRoomLang(lang)\r\n\r\n        this.props.history.push('/')\r\n\r\n        this.props.roomsActions.roomsGet(this.props.user.apiToken, lang)\r\n\r\n        SocketController.joinLang(lang)\r\n\r\n        fetch(`${urlApi}/api/user/update-room-lang`, {\r\n            method: \"post\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                Authorization: `Bearer ${this.props.user.apiToken}`,\r\n            },\r\n            body: JSON.stringify({\r\n                lang\r\n            })\r\n        })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <> \r\n                <div className=\"col-xl-3 col-lg-6 col-md-6 sidebar\">\r\n                    <h2 className=\"sidebar-title\">Language</h2>\r\n\r\n                    <span style={{color: this.props.user.roomLang === 'eng' ? 'red' : '#000'}} onClick={() => {\r\n                        this.updateRoomLang('eng')\r\n                    }}>English</span>\r\n                    <span style={{color: this.props.user.roomLang === 'rus' ? 'red' : '#000'}} onClick={() => {\r\n                        this.updateRoomLang('rus')\r\n                    }}>Russian</span>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        userActions: bindActionCreators(userActions, dispatch),\r\n        roomsActions: bindActionCreators(roomsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Languages))","import React from 'react'\r\nimport Avatar from './User/Avatar'\r\n\r\nimport '../Css/Partials/UserSidebar.css'\r\n\r\n// Icons\r\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\r\nimport NotificationsNoneIcon from '@material-ui/icons/NotificationsNone';\r\nimport LanguageIcon from '@material-ui/icons/Language';\r\nimport AppsIcon from '@material-ui/icons/Apps';\r\nimport Messages from '../Sidebar/Messages';\r\nimport Rooms from '../Sidebar/Rooms';\r\nimport Notifications from '../Sidebar/Notifications';\r\nimport Languages from '../Sidebar/Languages';\r\nimport { connect } from 'react-redux';\r\n\r\nclass UserSidebar extends React.Component {\r\n    state = {\r\n        activeTab: 'languages'\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <div className=\"col-xl-3 col-lg-6 col-md-6 user-header\">\r\n                    <ul>\r\n                        <li><Avatar style={{width: 32, height: 32, fontSize: 14, fontWeight: 600, backgroundColor: `rgb(${this.props.user.color})`}} name={this.props.user.name.first.charAt(0) + this.props.user.name.last.charAt(0)} /></li>\r\n                        <li style={{position: 'relative'}} className={`${this.state.activeTab === 'messages' ? 'active' : ''}`} onClick={() => {this.setState({activeTab: 'messages'})}}>\r\n                            <ChatBubbleOutlineIcon style={{color: '#CCD1D6'}} />\r\n                            {!!this.props.dialogs.noReadCount && <span \r\n                                className=\"unread-messages-count\"\r\n                                style={{\r\n                                    top: 11,\r\n                                    right: '40%',\r\n                                    transform: 'translateX(50%)'\r\n                                }}\r\n                            >{this.props.dialogs.noReadCount}</span>}\r\n                        </li>\r\n                        <li className={`${this.state.activeTab === 'rooms' ? 'active' : ''}`} onClick={() => {this.setState({activeTab: 'rooms'})}}><AppsIcon style={{color: '#CCD1D6'}} /></li>\r\n                        <li className={`${this.state.activeTab === 'notifications' ? 'active' : ''}`} onClick={() => {this.setState({activeTab: 'notifications'})}}><NotificationsNoneIcon style={{color: '#CCD1D6'}} /></li>\r\n                        <li className={`${this.state.activeTab === 'languages' ? 'active' : ''}`} onClick={() => {this.setState({activeTab: 'languages'})}}><LanguageIcon style={{color: '#CCD1D6'}} /></li>\r\n                    </ul>\r\n                </div>\r\n\r\n                {this.state.activeTab === 'messages' && <Messages />}\r\n                {this.state.activeTab === 'rooms' && <Rooms />}\r\n                {this.state.activeTab === 'notifications' && <Notifications />}\r\n                {this.state.activeTab === 'languages' && <Languages />}\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        dialogs: state.dialogs\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(UserSidebar)","// App\r\nimport React from 'react'\r\nimport { withCookies } from 'react-cookie'\r\nimport '../../Css/Auth/Login.css'\r\n\r\n// Router\r\nimport {\r\n    BrowserRouter as Router,\r\n} from \"react-router-dom\"\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as userActions from '../../Redux/actions/user'\r\nimport { bindActionCreators } from 'redux'\r\nimport SocketController from '../../Controllers/SocketController'\r\nimport {urlApi} from '../../config'\r\n\r\nclass Login extends React.Component {\r\n    state = {\r\n        email: '',\r\n        password: '',\r\n        error: false,\r\n        errors: [],\r\n        isFetching: false\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault()\r\n\r\n        if(this.state.email && this.state.password) {\r\n            this.setState({isFetching: true})\r\n\r\n            fetch(`${urlApi}/auth/login`, {\r\n                method: \"post\",\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    email: this.state.email,\r\n                    password: this.state.password\r\n                })\r\n            })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                if(data.error) {\r\n                    this.setState({error: true, errors: data.errors})\r\n                } else {\r\n                    const { cookies } = this.props\r\n                    cookies.set('apiToken', data.token, { path: '/' })\r\n\r\n                    this.props.userActions.loginUser(data.user, data.dialogs, data.token)\r\n\r\n                    SocketController.init(data.token)\r\n                }\r\n\r\n                this.setState({isFetching: false})\r\n            })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"login-page\">\r\n                <h1 className=\"logo\">\r\n                    <span style={{color: '#556677'}}>heva</span>\r\n                    <span style={{color: '#008FF7'}}>chat</span>\r\n                </h1>\r\n\r\n                <form onSubmit={(e) => {this.onSubmit(e)}} className=\"form\">\r\n                    <input value={this.state.email} onChange={(e) => {this.setState({email: e.target.value})}} className=\"input-field\" type=\"text\" name=\"email\" placeholder=\"E-mail\" />\r\n                    <input value={this.state.password} onChange={(e) => {this.setState({password: e.target.value})}} className=\"input-field\" type=\"password\" name=\"password\" placeholder=\"Пароль\" />\r\n\r\n                    <button type=\"submit\" className=\"button-gray\">Войти</button>\r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        userActions: bindActionCreators(userActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withCookies(Login))","// App\r\nimport React from 'react'\r\nimport { withCookies } from 'react-cookie'\r\nimport '../../Css/Auth/Login.css'\r\n\r\n// Router\r\nimport {\r\n    BrowserRouter as Router,\r\n} from \"react-router-dom\"\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as userActions from '../../Redux/actions/user'\r\nimport { bindActionCreators } from 'redux'\r\nimport {urlApi} from '../../config'\r\n\r\nclass Register extends React.Component {\r\n    state = {\r\n        email: '',\r\n        password: '',\r\n        error: false,\r\n        errors: [],\r\n        isFetching: false\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault()\r\n\r\n        if(this.state.email && this.state.password) {\r\n            this.setState({isFetching: true})\r\n\r\n            fetch(`${urlApi}/auth/register`, {\r\n                method: \"post\",\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    email: this.state.email,\r\n                    password: this.state.password\r\n                })\r\n            })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                if(data.error) {\r\n                    this.setState({error: true, errors: data.errors})\r\n                } else {\r\n                    const { cookies } = this.props\r\n                    cookies.set('apiToken', data.token, { path: '/' })\r\n\r\n                    this.props.userActions.loginUser(data.user, data.dialogs, data.token)\r\n                }\r\n\r\n                this.setState({isFetching: false})\r\n            })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"login-page\">\r\n                <h1 className=\"logo\">\r\n                    <span style={{color: '#556677'}}>heva</span>\r\n                    <span style={{color: '#008FF7'}}>chat</span>\r\n                </h1>\r\n\r\n                <form onSubmit={(e) => {this.onSubmit(e)}} className=\"form\">\r\n                    <input value={this.state.email} onChange={(e) => {this.setState({email: e.target.value})}} className=\"input-field\" type=\"text\" placeholder=\"E-mail\" />\r\n                    <input value={this.state.password} onChange={(e) => {this.setState({password: e.target.value})}} className=\"input-field\" type=\"password\" placeholder=\"Пароль\" />\r\n\r\n                    <button type=\"submit\" className=\"button-gray\">Зарегистрироваться</button>\r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        userActions: bindActionCreators(userActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withCookies(Register))","// App\r\nimport React from 'react'\r\n\r\n// Material\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\r\nimport PauseIcon from '@material-ui/icons/Pause';\r\nimport { randomInteger } from '../../Controllers/FunctionsController';\r\n\r\nlet audioDurationInterval = false\r\n\r\nclass Audio extends React.Component {\r\n    state = {\r\n        duration: '00:00',\r\n        audio: false,\r\n        randomId: randomInteger(0, 10000000)\r\n    }\r\n\r\n    componentDidMount() {\r\n        let thisAudio = document.getElementsByName(this.props.src)\r\n\r\n        for(let audio of thisAudio) {\r\n            audio.volume = 0.5\r\n            this.setState({audio})\r\n            break\r\n        }\r\n\r\n        let audio = document.getElementById(this.state.randomId)\r\n\r\n        audio.onloadedmetadata = () => {\r\n            this.getDuration()\r\n        }\r\n    }\r\n\r\n    getDuration() {\r\n        function padZero(v) {\r\n            return (v < 10) ? \"0\" + v : v;\r\n        }\r\n\r\n        let thisAudio = document.getElementsByName(this.props.src)\r\n\r\n        let t = 0\r\n\r\n        for(let audio of thisAudio) {\r\n            t = audio.duration\r\n            break\r\n        }\r\n\r\n        this.setState({duration: padZero(parseInt((t / (60)))) + \":\" + padZero(parseInt((t) % 60))})\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if(audioDurationInterval)\r\n            this.stopTimer()\r\n\r\n        if(this.state.audio) {\r\n            this.state.audio.parentElement.className = 'message-sound'\r\n            this.state.audio.pause()\r\n        }\r\n    }\r\n\r\n    playAudio(e) {\r\n        e.stopPropagation()\r\n\r\n        let otherAudio = document.getElementsByClassName('message-sounds-element')\r\n        \r\n        this.stopTimer()\r\n\r\n        for (let audio of otherAudio) { \r\n            audio.parentElement.className = 'message-sound'\r\n            audio.pause()\r\n        }\r\n\r\n        let thisAudio = document.getElementsByName(this.props.src)\r\n\r\n        for(let audio of thisAudio) {\r\n            audio.parentElement.className = 'message-sound active'\r\n            audio.play()\r\n        }\r\n\r\n        this.startTimer()\r\n    }\r\n\r\n    changeDurationAudio(e) {\r\n        e.stopPropagation()\r\n\r\n        let position = e.nativeEvent.layerX * 100 / this.rangeBlock.clientWidth\r\n        let time = this.state.audio.duration / 100 * position\r\n\r\n        let thisAudio = document.getElementsByName(this.props.src)\r\n\r\n        for(let audio of thisAudio) {\r\n            audio.currentTime = time\r\n        }\r\n\r\n        let thisRange = document.getElementsByName(this.props.src+'-range')\r\n\r\n        for(let range of thisRange) {\r\n            range.style.width = (100*this.state.audio.currentTime/this.state.audio.duration)+'%'\r\n        }\r\n    }\r\n\r\n    startTimer() {\r\n        audioDurationInterval = setInterval(() => {\r\n            let thisRange = document.getElementsByName(this.props.src+'-range')\r\n\r\n            for(let range of thisRange) {\r\n                range.style.width = (100*this.state.audio.currentTime/this.state.audio.duration)+'%'\r\n            }\r\n        }, 100)\r\n    }\r\n\r\n    stopTimer() {\r\n        clearInterval(audioDurationInterval)\r\n    }\r\n\r\n    viewDurationAudio(e) {\r\n        let position = e.nativeEvent.layerX * 100 / this.rangeBlock.clientWidth\r\n        let time = this.state.audio.duration / 100 * position\r\n\r\n        let thisRange = document.getElementsByName(this.props.src+'-range')\r\n\r\n        for(let range of thisRange) {\r\n            range.style.width = (100*time/this.state.audio.duration)+'%'\r\n        }\r\n    }\r\n\r\n    stopAudio(e) {\r\n        if(audioDurationInterval)\r\n            this.stopTimer()\r\n\r\n        e.stopPropagation()\r\n\r\n        let thisAudio = document.getElementsByName(this.props.src)\r\n\r\n        for(let audio of thisAudio) {\r\n            audio.parentElement.className = 'message-sound'\r\n            audio.pause()\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return <div className=\"message-sound\">\r\n            <audio className={`message-sounds-element`} id={this.state.randomId} name={this.props.src} src={this.props.src} />\r\n            <span className=\"play\" onClick={(e) => {this.playAudio(e)}}><PlayArrowIcon style={{color: '#008FF7'}} /></span>\r\n            <span className=\"pause\" onClick={(e) => {this.stopAudio(e)}}><PauseIcon style={{color: '#008FF7'}} /></span>\r\n            <div className=\"message-sound-info\">\r\n                <p className=\"message-sounds-name\">{this.props.fileName}</p>\r\n                <p className=\"message-sounds-duration\">{this.state.duration}</p>\r\n            </div>\r\n\r\n            <div className=\"message-sound-range\" \r\n                ref={(ref) => {this.rangeBlock = ref}} \r\n                onMouseMove={(e) => {this.viewDurationAudio(e)}} \r\n                onMouseEnter={() => {this.stopTimer()}}\r\n                onMouseLeave={() => {this.startTimer()}}\r\n                onClick={(e) => {this.changeDurationAudio(e)}}\r\n            >\r\n                <span className=\"range-position\" ref={(ref) => {this.range = ref}} name={this.props.src + '-range'}></span>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\nexport default Audio","// App\r\nimport React from 'react'\r\nimport Avatar from '../User/Avatar'\r\nimport { getHM, timeAt } from '../../Controllers/TimeController'\r\nimport { CSSTransitionGroup } from 'react-transition-group';\r\nimport MessageComponent from './Message'\r\n\r\n// Material\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport QueryBuilderIcon from '@material-ui/icons/QueryBuilder';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport InsertDriveFileOutlinedIcon from '@material-ui/icons/InsertDriveFileOutlined';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\n\r\nimport Audio from './Audio';\r\n\r\nimport Linkify from 'react-linkify'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport ActionMenu from '../ActionMenu'\r\nimport { randomInteger } from '../../Controllers/FunctionsController'\r\n\r\nconst componentDecorator = (href, text, key) => (\r\n    <a href={href} onClick={(e) => {e.stopPropagation()}} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\r\n      {text}\r\n    </a>\r\n);\r\n\r\nclass Message extends React.PureComponent {\r\n    state = {\r\n        randomId: randomInteger(0, 100000)\r\n    }\r\n\r\n    render() {\r\n        let isHistoryDate = true\r\n        let moreHour = false\r\n\r\n        if(this.props.messages[this.props.index-1]) {\r\n            let date1 = new Date(this.props.message.createdAt);\r\n            let date2 = new Date(this.props.messages[this.props.index-1].createdAt);\r\n            \r\n            if(\r\n                date1.getFullYear() === date2.getFullYear() && \r\n                date1.getMonth() === date2.getMonth() && \r\n                date1.getDate() === date2.getDate()\r\n            ) {\r\n                isHistoryDate = false\r\n            }\r\n\r\n            let diffHours = Math.abs(date1 - date2) / 36e5;\r\n            \r\n            if(diffHours > 1) {\r\n                moreHour = true\r\n            }\r\n        }\r\n\r\n        let isFirst = (\r\n            ((this.props.messages[this.props.index-1] && \r\n            this.props.messages[this.props.index-1].user._id !== this.props.message.user._id) || \r\n            !this.props.messages[this.props.index-1]) || moreHour\r\n        )\r\n\r\n        return (<>\r\n            {isHistoryDate && <div className=\"history-date\">{timeAt(new Date(this.props.message.createdAt))}</div>}\r\n\r\n            <div\r\n                className={`message ${this.props.selected ? 'selected' : ''}`} \r\n                onClick={(e) => {\r\n                    if(this.props.message.isLoading || this.props.message.isError)\r\n                        return\r\n\r\n                    if(this.props.selected) {\r\n                        this.props.unSelect(this.props.message._id)\r\n                    } else {\r\n                        this.props.onSelect(this.props.message)\r\n                    }\r\n                }}\r\n                style={{\r\n                    background: this.props.isRecent ? 'none' : (this.props.message.isLoading || this.props.message.isError) ? '#fff' : (this.props.message.user._id !== this.props.user._id && !this.props.message.isRead) ? '#EFF4F8' : '', \r\n                    cursor: (this.props.message.isLoading || this.props.message.isError) ? 'default' : '',\r\n                    padding: this.props.isRecent ? '8px 14px 8px 6px' : ''\r\n                }}\r\n            >\r\n                {\r\n                    (isFirst || isHistoryDate) && !this.props.isRecent && \r\n                    <Avatar style={{width: 32, height: 32, fontSize: 14, lineHeight: '14px', fontWeight: 600, backgroundColor: `rgb(${this.props.message.user.color})`}} name={this.props.message.user.name.first.charAt(0)+this.props.message.user.name.last.charAt(0)} />\r\n                }\r\n\r\n                {\r\n                    (!isFirst && !isHistoryDate && !this.props.isRecent) &&\r\n                    <div style={{width: 46}} />\r\n                }\r\n\r\n                {(!this.props.message.isLoading && !this.props.message.isError) && this.props.canSelect && <span className={`select-indicator ${this.props.selected ? 'active' : ''}`}>\r\n                    {this.props.selected && <CheckIcon style={{\r\n                        color: '#fff', \r\n                        fontSize: 16,\r\n                        position: 'absolute',\r\n                        top: 0,\r\n                        left: 0,\r\n                        right: 0,\r\n                        bottom: 0,\r\n                        margin: 'auto'\r\n                    }} />}\r\n                </span>}\r\n                \r\n                <div className=\"content col\">\r\n                    {\r\n                        (isFirst || isHistoryDate) &&\r\n                        <h3 className=\"user-name\" style={{color: this.props.message.user._id === this.props.user._id ? '#FF3333' : ''}}>{`${this.props.message.user.name.first} ${this.props.message.user.name.last}`} <span className=\"time-at\">{getHM(this.props.message.createdAt)}</span></h3>\r\n                    }\r\n\r\n                    {this.props.message.text && <p className=\"message-text\">\r\n                        <Linkify componentDecorator={componentDecorator}>\r\n                            {this.props.message.text.replace(/&nbsp;/g, '')\r\n                                .replace(/&amp;/g, '&')\r\n                                .replace(/&gt;/g, '>')\r\n                                .replace(/&lt;/g, '<')\r\n                                // .replace(/(\\r\\n|\\n|\\r)/gm, \"\")\r\n                                .replace(/(^\\s*(?!.+)\\n+)|(\\n+\\s+(?!.+)$)/g, \"\")\r\n                                .replace(/(\\r\\n|\\r|\\n){2,}/g, '$1\\n')\r\n                            }\r\n                        </Linkify>\r\n                    </p>}\r\n\r\n                    {!!this.props.message.recentMessages.length && this.props.countRecent > 1 && <p className=\"message-text\">\r\n                        {`Attachmend messages [${this.props.message.recentMessages.length}]`}    \r\n                    </p>}\r\n\r\n                    {!!this.props.message.images.length && <div className=\"message-images\">\r\n                        {this.props.message.images.map((image, index, images) => {\r\n                            let width\r\n                            let isBlur = false\r\n\r\n                            if(images.length <= 3 && images.length !== 2) {\r\n                                width = index === 0 ? '100%' : '50%' \r\n                            } else {\r\n                                width = '50%'\r\n                            }\r\n\r\n                            if(images.length > 4 && index === 3)\r\n                                isBlur = true\r\n                            \r\n                            if(index > 3)\r\n                                return null\r\n\r\n                            if(isBlur)\r\n                                return <div key={index} className=\"image\" style={{width}}>\r\n                                    <div className=\"image-blur\" onClick={(e) => {\r\n                                        e.stopPropagation()\r\n                                        this.props.openSlider(images)\r\n                                    }}>\r\n                                        <span>{`+${images.length-3}`}</span>\r\n                                        <img key={index} src={image.path} alt={image.name} />\r\n                                    </div>\r\n                                </div>\r\n\r\n                            return  <div key={index} className=\"image\" style={{width}}>\r\n                                <img onClick={(e) => {\r\n                                    e.stopPropagation()\r\n                                    this.props.openSlider(images)\r\n                                }} src={image.path} alt={image.name} />\r\n                            </div>\r\n                        })}\r\n                    </div>}\r\n\r\n                    {!!this.props.message.sounds.length && <div className=\"message-sounds\">\r\n                        {this.props.message.sounds.map((sound, index, images) => {\r\n                            return <Audio\r\n                                key={index}\r\n                                fileName={sound.name}\r\n                                src={sound.path}\r\n                            />\r\n                        })}\r\n                    </div>}\r\n                    \r\n                    \r\n                    {!!this.props.message.files.length && <div className=\"message-files\">\r\n                        {this.props.message.files.map((file, index, images) => {\r\n                            return <div className=\"message-file\" key={index} onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                window.open(file.path, '_self');\r\n                            }}>\r\n                                <InsertDriveFileOutlinedIcon className=\"file-icon\" style={{color: '#008FF7'}} />\r\n                                <div className=\"message-file-info\">\r\n                                    <p className=\"message-file-name\">{file.name}</p>\r\n                                    <p className=\"message-file-size\">{file.size > 999 ? (file.size / 1000).toFixed(1) + ' mb' : Math.ceil(file.size) + ' kb'}</p>\r\n                                </div>\r\n                                <GetAppIcon className=\"download-icon\" style={{color: '#008FF7'}} />\r\n                            </div>\r\n                        })}\r\n                    </div>}\r\n                    \r\n\r\n                    {!!this.props.message.recentMessages.length && this.props.countRecent < 2 && <div className=\"message-recent\">\r\n                        {this.props.message.recentMessages.map((message, index, messages) => {\r\n                            return <MessageComponent countRecent={this.props.countRecent+1} isRecent={true} onSelect={() => {}} openSlider={(sliderImages) => {this.props.openSlider(sliderImages)}} key={index} message={message} messages={messages} index={index} />\r\n                        })}\r\n                    </div>}\r\n                </div>\r\n                \r\n                {!this.props.isRecent && !this.props.canSelect && <div className=\"message-status\">\r\n                    <CSSTransitionGroup \r\n                        transitionName=\"message-status-transition\"\r\n                        transitionEnterTimeout={100}\r\n                        transitionLeaveTimeout={100}>\r\n                        {!this.props.message.isLoading && !this.props.message.isError && this.props.message.isEdit && <EditOutlinedIcon style={{color: '#B8C3CF'}} />}\r\n                    </CSSTransitionGroup>\r\n                </div>}\r\n                {!this.props.isRecent && !this.props.canSelect && <div className=\"message-status\">\r\n                    <CSSTransitionGroup \r\n                        transitionName=\"message-status-transition\"\r\n                        transitionEnterTimeout={100}\r\n                        transitionLeaveTimeout={100}>\r\n                            {this.props.message.user._id === this.props.user._id && this.props.message.isLoading && <QueryBuilderIcon style={{color: '#B8C3CF'}} />}\r\n                            \r\n                            {this.props.message.user._id === this.props.user._id && !this.props.message.isLoading && !this.props.message.isError && !this.props.message.isRead && <DoneIcon style={{color: '#B8C3CF'}} />}\r\n                            {this.props.message.user._id === this.props.user._id &&!this.props.message.isLoading && !this.props.message.isError && this.props.message.isRead && <DoneAllIcon style={{color: '#008FF7'}} />}\r\n                            {this.props.message.user._id === this.props.user._id &&!this.props.message.isLoading && this.props.message.isError &&<>\r\n                            <ActionMenu actions={[\r\n                                {text: 'Retry', action: () => {\r\n                                    this.props.retrySendMessage(this.props.message)\r\n                                }},\r\n                                {text: 'Delete', action: () => {\r\n                                    this.props.deleteLocalMessage(this.props.message._id)\r\n                                }},\r\n                            ]} from={'message-error-actions-'+this.state.randomId} />\r\n                            <ErrorOutlineIcon className='error' id={'message-error-actions-'+this.state.randomId} style={{color: '#FF3333'}} />\r\n                        </>}\r\n                    </CSSTransitionGroup>\r\n                </div>}\r\n            </div>\r\n        </>)\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms\r\n    }\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(Message)","// App\r\nimport React from 'react'\r\nimport Message from './Message'\r\n\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\n// Material\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport { withStyles, LinearProgress, CircularProgress } from '@material-ui/core'\r\n\r\nimport { connect } from 'react-redux';\r\n\r\nlet waitActiveUser = false\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#fff',\r\n        position: 'absolute',\r\n        color: '#008FF7',\r\n        bottom: 20,\r\n        right: 20,\r\n        zIndex: 2,\r\n        '&:hover': {\r\n            backgroundColor: '#fff',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Dialog extends React.Component {\r\n    state = {\r\n        showFabToBottom: false,\r\n        activePage: false,\r\n        scrollTop: 0\r\n    }\r\n\r\n    scrollToBottom() {\r\n        if(this.messagesBlock) {\r\n            this.messagesBlock.view.scroll({\r\n                top: this.messagesBlock.getScrollHeight(),\r\n                left: 0,\r\n                behavior: 'smooth'\r\n            })\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('blur', this.blurPage.bind(this));\r\n        window.removeEventListener('mousemove', this.focusPage.bind(this));\r\n    }\r\n\r\n    focusPage() {\r\n        let active\r\n        if(this.messagesBlock && this.messagesBlock.getScrollTop() + this.messagesBlock.getClientHeight() < this.messagesBlock.getScrollHeight()) {\r\n            active = false\r\n        } else {\r\n            active = true\r\n        }\r\n\r\n        if(!this.state.activePage && active && !!this.props.unRead.length) {\r\n            if(waitActiveUser)\r\n                clearTimeout(waitActiveUser)\r\n\r\n            this.props.readMessages()\r\n            this.setState({activePage: true})\r\n\r\n            waitActiveUser = setTimeout(() => {\r\n                this.setState({activePage: false})\r\n            }, 3000)\r\n        } \r\n    }\r\n\r\n    blurPage() {\r\n        this.setState({activePage: false})\r\n    }\r\n    \r\n    componentDidMount() {\r\n        window.addEventListener('blur', this.blurPage.bind(this));\r\n        window.addEventListener('mousemove', this.focusPage.bind(this));\r\n\r\n        if(this.messagesBlock) {\r\n            this.messagesBlock.view.scroll({\r\n                top: 10000,\r\n                left: 0,\r\n            })\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if(\r\n            prevProps.messages.length < this.props.messages.length && \r\n            JSON.stringify(prevProps.messages[0]) === JSON.stringify(this.props.messages[0]) &&\r\n            ((this.messagesBlock.getScrollHeight() - this.messagesBlock.getClientHeight() - this.messagesBlock.getScrollTop()) < this.messagesBlock.getClientHeight()/3 ||\r\n            prevProps.messages[prevProps.messages.length-1].user._id === this.props.user._id)\r\n        ) {\r\n            if(this.state.activePage) {\r\n                this.props.readMessages()\r\n            }\r\n            \r\n            this.scrollToBottom()\r\n\r\n            if(this.state.showFabToBottom)\r\n                this.setState({showFabToBottom: false})\r\n        }\r\n\r\n        if(JSON.stringify(prevProps.messages[0]) !== JSON.stringify(this.props.messages[0])) {\r\n            this.messagesBlock.scrollTop(this.messagesBlock.getScrollHeight() - this.state.scrollTop - 4)\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if(nextState.scrollTop !== this.state.scrollTop) {\r\n            return false\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    onScroll() {\r\n        this.setState({scrollTop: this.messagesBlock.getScrollHeight() - this.messagesBlock.getScrollTop()})\r\n        if(this.messagesBlock.getScrollTop() + this.messagesBlock.getClientHeight() < this.messagesBlock.getScrollHeight() - 100) {\r\n            if(!this.state.showFabToBottom)\r\n                this.setState({showFabToBottom: true})\r\n        } else {\r\n            if(this.state.showFabToBottom) {\r\n                this.setState({showFabToBottom: false})\r\n                if(!!this.props.unRead.length) {\r\n                    this.props.readMessages()\r\n                }\r\n            }\r\n        }\r\n\r\n        if(this.props.type === 'room' && this.props.rooms.activeRoom.canLoad && this.messagesBlock.getScrollTop() < 100) {\r\n            this.props.loadMessages()\r\n        }\r\n        \r\n        if(this.props.type === 'dialog' && this.props.dialog.canLoad && this.messagesBlock.getScrollTop() < 100) {\r\n            this.props.loadMessages()\r\n        }\r\n            \r\n\r\n    }\r\n\r\n    viewTypers() {\r\n        if(this.props.rooms.activeRoom.typers.length === 1) {\r\n            return this.props.rooms.activeRoom.typers[0].name.first\r\n        }\r\n\r\n        if(this.props.rooms.activeRoom.typers.length === 2) {\r\n            return `${this.props.rooms.activeRoom.typers[0].name.first} и ${this.props.rooms.activeRoom.typers[1].name.first}`\r\n        }\r\n\r\n        return `${this.props.rooms.activeRoom.typers[0].name.first} и ${this.props.rooms.activeRoom.typers.length-1}`\r\n    }\r\n    \r\n    render() {\r\n        return (\r\n            <div className=\"dialog-wrap\">\r\n                <Scrollbars\r\n                    onScroll={() => {this.onScroll()}}\r\n                    ref={(ref) => {this.messagesBlock = ref}}\r\n                    renderTrackVertical={props => <div className=\"track-vertical\"/>}\r\n                    renderThumbVertical={props => <div className=\"thumb-vertical\"/>}\r\n                    className=\"dialog scroll\"\r\n                    autoHide\r\n                >\r\n                    {((this.props.type === 'room' && this.props.rooms.activeRoom.isLoading) || (this.props.type === 'dialog' && this.props.dialog.canLoad)) && <div className=\"dialog-loading\">\r\n                        <LinearProgress style={{backgroundColor: '#EFF4F8'}} />\r\n                    </div>}\r\n                    <div className=\"offset-top\"></div>\r\n                    {this.props.messages.map((message, index, messages) => {\r\n                        return <Message \r\n                            countRecent={0}\r\n                            isRecent={false}\r\n                            openSlider={(sliderImages) => {this.props.openSlider(sliderImages)}}\r\n                            selected={this.props.recentMessages.find(x => x._id === message._id)}\r\n                            canSelect={!!this.props.recentMessages.length}\r\n                            key={index} \r\n                            deleteLocalMessage={(_id) => {this.props.deleteLocalMessage(_id)}}\r\n                            retrySendMessage={(message) => {this.props.retrySendMessage(message)}}\r\n                            index={index}\r\n                            message={message} \r\n                            messages={messages} \r\n                            onSelect={(message) => {this.props.onSelect(message)}} \r\n                            unSelect={(id) => {this.props.unSelect(id)}}\r\n                        />\r\n                    })}\r\n\r\n                    {this.props.type === 'room' && <div className=\"dialog-typers\">\r\n                        {!!this.props.rooms.activeRoom.typers.length && <p className=\"typing\">{this.viewTypers()} typing</p>}\r\n                        {!this.props.rooms.activeRoom.typers.length && <p style={{height: 18}}></p>}\r\n                    </div>}\r\n\r\n                    {this.props.type === 'dialog' && <div className=\"dialog-typers\">\r\n                        {this.props.typing && <p className=\"typing\">{this.props.userName} typing</p>}\r\n                        {!this.props.typing && <p style={{height: 18}}></p>}\r\n                    </div>}\r\n                </Scrollbars>\r\n\r\n                <CustomFab className={`scroll-to-bottom ${this.state.showFabToBottom ? 'active' : ''}`} color=\"primary\" size=\"small\" aria-label=\"add\" onClick={() => {this.scrollToBottom()}}>\r\n                    {!!this.props.unRead.length && <span className=\"unread-messages-count\">{this.props.unRead.length}</span>}\r\n                    <ExpandMoreIcon style={{color: '#99AABB'}} />\r\n                </CustomFab>\r\n\r\n                {this.props.type === 'dialog' && this.props.loading && <CircularProgress style={{\r\n                    color: '#008FF7',\r\n                    position: 'absolute',\r\n                    left: 0,\r\n                    right: 0,\r\n                    margin: 'auto',\r\n                    top: 'calc(50% - 20px)'\r\n                }} />}\r\n\r\n                {(!this.props.messages.length && !this.props.loading) && <div className=\"data-empty\">\r\n                    <SendIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                    <p>Write your first message to {this.props.to}</p>\r\n                </div>}\r\n            </div>  \r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Dialog)","// App\r\nimport React from 'react'\r\n\r\n// Material\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { getHM } from '../../Controllers/TimeController';\r\nimport Linkify from 'react-linkify';\r\nimport Button from '@material-ui/core/Button';\r\nimport MusicNoteIcon from '@material-ui/icons/MusicNote';\r\nimport InsertDriveFileOutlinedIcon from '@material-ui/icons/InsertDriveFileOutlined';\r\n\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\nconst componentDecorator = (href, text, key) => (\r\n    <a href={href} onClick={(e) => {e.stopPropagation()}} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\r\n      {text}\r\n    </a>\r\n);\r\n\r\nclass Attachment extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className=\"dialog-attachment\">\r\n                {!!this.props.recentMessages.length && <div className=\"message-attachment\">\r\n                    <Button className=\"btn-cancel-select\" style={{width: 60}} onClick={() => {this.props.unSelectRecentMessages()}}>\r\n                        <CloseIcon style={{color: '#99AABB'}} />\r\n                    </Button>\r\n\r\n                    {this.props.recentMessages.length === 1 &&<div className=\"col message-recent\">\r\n                        <h3 className=\"user-name\">{`${this.props.recentMessages[0].user.name.first} ${this.props.recentMessages[0].user.name.last}`} <span className=\"time-at\">{getHM(this.props.recentMessages[0].createdAt)}</span></h3>\r\n                        <p className=\"message-text\"><Linkify componentDecorator={componentDecorator}>{\r\n                            this.props.recentMessages[0].text ? \r\n                            this.props.recentMessages[0].text : `Вложения [${\r\n                                this.props.recentMessages[0].images.length+\r\n                                this.props.recentMessages[0].files.length+\r\n                                this.props.recentMessages[0].sounds.length+\r\n                                this.props.recentMessages[0].recentMessages.length\r\n\r\n                            }]`\r\n                        }</Linkify></p>\r\n                    </div>}\r\n\r\n                    {this.props.recentMessages.length > 1 &&<div className=\"col message-recent\">\r\n                        <h3 className=\"user-name\">Attachment messages</h3>\r\n                        <p className=\"message-text\">{`${this.props.recentMessages.length} messages`}</p>\r\n                    </div>}\r\n                </div>}\r\n\r\n                {!!this.props.images.length && <div className=\"image-attachment\">\r\n                    {this.props.images.map((image, index, images) => {\r\n                        return <div key={index} className=\"image-container\" style={{marginRight: images[index+1] ? 5 : 0}}>\r\n                            <span className=\"btn-delete-image\" onClick={() => {this.props.removeImage(image.id)}}>\r\n                                <CloseIcon style={{color: '#fff'}} />\r\n                            </span>\r\n                            <img src={image.path} alt=\"Attach\" />\r\n                        </div>\r\n                    })}\r\n                </div>}\r\n\r\n                {!!this.props.sounds.length && <div className=\"sound-attachment\">\r\n                    {this.props.sounds.map((sound, index, sounds) => {\r\n                        return <div key={index} className=\"sound-container\">\r\n                            <Button className=\"btn-cancel-select\" style={{minWidth: 60}} onClick={() => {this.props.removeSound(sound.id)}}>\r\n                                <CloseIcon style={{color: '#99AABB'}} />\r\n                            </Button>\r\n\r\n                            <MusicNoteIcon style={{color: '#008FF7'}} />\r\n\r\n                            <p className=\"sound-attachment-name\">{sound.name}</p>\r\n                        </div>\r\n                    })}\r\n                </div>}\r\n\r\n                {!!this.props.files.length && <div className=\"sound-attachment\">\r\n                    {this.props.files.map((file, index, files) => {\r\n                        return <div key={index} className=\"sound-container\">\r\n                            <Button className=\"btn-cancel-select\" style={{minWidth: 60}} onClick={() => {this.props.removeFile(file.id)}}>\r\n                                <CloseIcon style={{color: '#99AABB'}} />\r\n                            </Button>\r\n\r\n                            <InsertDriveFileOutlinedIcon style={{color: '#008FF7'}} />\r\n\r\n                            <p className=\"sound-attachment-name\">{file.name}</p>\r\n                        </div>\r\n                    })}\r\n                </div>}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Attachment","// App\r\nimport React from 'react'\r\nimport Modal from 'react-modal';\r\n\r\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\r\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport '../../Css/Partials/Slider.css'\r\n\r\nconst customStylesModal = {\r\n    overlay: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        backgroundColor: 'rgba(0, 0, 0, 0.25)',\r\n        zIndex: 4\r\n    },\r\n    content : {\r\n        top                   : '50%',\r\n        left                  : '50%',\r\n        right                 : 'auto',\r\n        bottom                : 'auto',\r\n        padding               : '0',\r\n        marginRight           : '-50%',\r\n        transform             : 'translate(-50%, -50%)',\r\n        background            : 'rgba(0, 0, 0, 0.5);',\r\n        border                : 'none',\r\n        width: '100%',\r\n        height: '100vh'\r\n    }\r\n};\r\n\r\n\r\nclass Slider extends React.Component {\r\n    state = {\r\n        index: 0\r\n    }\r\n\r\n    render() {\r\n        return <Modal\r\n            isOpen={true}\r\n            onRequestClose={() => {this.props.close()}}\r\n            style={customStylesModal}\r\n            contentLabel=\"Slider\"\r\n        >\r\n            <div className=\"slider-close\" onClick={() => {\r\n                this.props.close()\r\n            }}>\r\n                <CloseIcon style={{color: '#fff', fontSize: 30, opacity: 0.5}} />\r\n            </div>\r\n\r\n            {this.props.images[this.state.index-1] && <div className=\"slider-prev\" onClick={() => {\r\n                this.setState({index: this.state.index-1})\r\n            }}>\r\n                <NavigateBeforeIcon style={{color: '#fff', fontSize: 45, opacity: 0.5}} />\r\n            </div>}\r\n\r\n            <div className=\"slider-image-container\" onClick={() => {this.props.close()}}>\r\n                <img className=\"slider-image\" src={this.props.images[this.state.index].path} alt=\"Media from user\" />\r\n            </div>\r\n\r\n            {this.props.images[this.state.index+1] && <div className=\"slider-next\" onClick={() => {\r\n                this.setState({index: this.state.index+1})\r\n            }}>\r\n                <NavigateNextIcon style={{color: '#fff', fontSize: 45, opacity: 0.5}} />\r\n            </div>}\r\n        </Modal>\r\n    }\r\n}\r\n\r\nexport default Slider","// App\r\nimport React from 'react'\r\nimport ReactResizeDetector from 'react-resize-detector'\r\nimport {CSSTransitionGroup} from 'react-transition-group'\r\n\r\n// Material\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nclass InputMessage extends React.Component {\r\n    state = {\r\n        inputMessageHeight: 0,\r\n        text: ''\r\n    }\r\n\r\n    setText(text) {\r\n        this.setState({text})\r\n    }\r\n\r\n    onPaste(event) {\r\n        let items = (event.clipboardData || event.originalEvent.clipboardData).items\r\n        \r\n        for (let index = 0; index < items.length; index++) {\r\n            if (items[index].kind === 'file') {\r\n                let file = items[index].getAsFile()\r\n\r\n                this.props.addFile(file, true)\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if(this.props.isEdit) {\r\n            if(!/\\S/.test(this.state.text) && !this.props.attachedRecentMessages.length && !this.props.images.length && !this.props.files.length && !this.props.sounds.length) {\r\n                this.props.cancelEditMessage()\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={`dialog-input ${this.props.isShow ? '': 'd-none'}`}>\r\n                <IconButton component={'label'} className=\"btn-add-files\">\r\n                    <AttachFileIcon style={{transform: 'rotate(45deg)', color: '#008FF7'}} />\r\n\r\n                    <input \r\n                        type=\"file\" \r\n                        multiple \r\n                        onChange={(e) => {this.props.addFile(e)}}\r\n                        id=\"uploadFile\" \r\n                        style={{display: 'none'}} \r\n                        accept=\"image/jpeg,image/gif,image/jpeg,image/png,application/pdf,text/plain,application/x-zip-compressed,application/zip,application/msword,audio/mpeg\" \r\n                    />\r\n                </IconButton>\r\n\r\n                <textarea className=\"col input-message\" id=\"input-message\" onPaste={(e) => {this.onPaste(e)}}\r\n                    onKeyDown={(e) => {\r\n                        if(e.keyCode === 38 && !this.props.isEdit && !this.state.text.length) {\r\n                            this.props.setLastEditMessage()\r\n                        }\r\n\r\n                        if (e.keyCode === 13 && !e.shiftKey) {\r\n                            e.preventDefault()\r\n                            if(/\\S/.test(this.state.text) || !!this.props.attachedRecentMessages.length  || !!this.props.images.length || !!this.props.files.length || !!this.props.sounds.length) {\r\n                                if(!this.props.isEdit) {\r\n                                    this.props.sendMessage(this.state.text)\r\n                                    this.setState({text: ''})\r\n                                }\r\n                                else {\r\n                                    this.props.sendEditMessage(this.state.text)\r\n                                    this.setState({text: ''})\r\n                                }\r\n                                let inputMessage = document.getElementById('input-message')\r\n                                inputMessage.style.maxHeight = \"60px\";\r\n                            }\r\n                        }\r\n                    }}\r\n                    onInput={() => {\r\n                        let inputMessage = document.getElementById('input-message')\r\n                        inputMessage.style.height = \"5px\";\r\n                        inputMessage.style.height = (inputMessage.scrollHeight)+\"px\";\r\n\r\n                        if(inputMessage.scrollHeight > 179) {\r\n                            inputMessage.style.maxHeight = '179px'\r\n                        } else {\r\n                            inputMessage.style.maxHeight = (inputMessage.scrollHeight)+\"px\";\r\n                        }\r\n                    }}\r\n                    onChange={(e) => {\r\n                        this.props.typing(e.target.value, this.state.text)\r\n                        this.setState({text: e.target.value})\r\n                    }}\r\n                    value={this.state.text}\r\n                ></textarea>\r\n\r\n                {!this.state.text && <div className=\"placeholder\">Write message...</div>}\r\n\r\n                {!this.props.isEdit && <CSSTransitionGroup \r\n                    transitionName=\"btn-send-message\"\r\n                    transitionEnterTimeout={100}\r\n                    transitionLeaveTimeout={100}>\r\n                     {(/\\S/.test(this.state.text) || !!this.props.files.length || !!this.props.images.length|| !!this.props.sounds.length || !!this.props.attachedRecentMessages.length) && <IconButton onClick={() => {\r\n                            this.props.sendMessage(this.state.text)\r\n                            this.setState({text: ''})\r\n                            let inputMessage = document.getElementById('input-message')\r\n                            inputMessage.style.maxHeight = \"60px\";\r\n                        }} className=\"btn-send-message\">\r\n                        <SendIcon style={{color: '#008FF7'}} />\r\n                    </IconButton>}\r\n                </CSSTransitionGroup>}\r\n\r\n                {this.props.isEdit && <CSSTransitionGroup \r\n                    transitionName=\"btn-send-message\"\r\n                    transitionEnterTimeout={100}\r\n                    transitionLeaveTimeout={100}>\r\n                     {(\r\n                        JSON.stringify({\r\n                            text: this.props.editMessage.text,\r\n                            images: this.props.editMessage.images,\r\n                            sounds: this.props.editMessage.sounds,\r\n                            files: this.props.editMessage.files,\r\n                            attachedRecentMessages: this.props.editMessage.recentMessages,\r\n                        }) !== \r\n                        JSON.stringify({\r\n                            text: this.state.text,\r\n                            images: this.props.images,\r\n                            sounds: this.props.sounds,\r\n                            files: this.props.files,\r\n                            attachedRecentMessages: this.props.attachedRecentMessages\r\n                        })) && <IconButton ref={(node) => {\r\n                        if (node) {\r\n                            node.style.setProperty(\"margin-right\", \"0\", \"important\");\r\n                        }\r\n                        }} \r\n                        onClick={() => {\r\n                            this.props.sendEditMessage(this.state.text)\r\n                            this.setState({text: ''})\r\n                            let inputMessage = document.getElementById('input-message')\r\n                            inputMessage.style.maxHeight = \"60px\";\r\n                        }} className=\"btn-send-message\">\r\n                        <EditOutlinedIcon style={{color: '#008FF7'}} />\r\n                    </IconButton>}\r\n\r\n                    <IconButton ref={(node) => {\r\n                        if (node) {\r\n                            node.style.setProperty(\"margin-left\", \"0\", \"important\");\r\n                        }\r\n                        }} \r\n                        onClick={() => {\r\n                            this.props.cancelEditMessage()\r\n                            let inputMessage = document.getElementById('input-message')\r\n                            inputMessage.style.maxHeight = \"60px\";\r\n                        }} className=\"btn-send-message\">\r\n                        <CloseIcon style={{color: '#008FF7'}} />\r\n                    </IconButton>\r\n                </CSSTransitionGroup>}\r\n\r\n                <ReactResizeDetector handleHeight onResize={(width, inputMessageHeight) => {\r\n                    this.setState({inputMessageHeight})\r\n                }} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default InputMessage","// App\r\nimport React from 'react'\r\n\r\n// Material\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\r\nimport Button from '@material-ui/core/Button';\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\n\r\nclass ToolbarMessage extends React.Component {\r\n    state = {\r\n        inputMessageHeight: 0\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"dialog-input\">\r\n                <Button className=\"btn-reply\" onClick={() => {this.props.addAttachmentRecentMessage()}}>\r\n                    Reply\r\n                </Button>\r\n\r\n                <Button className=\"btn-forward\">\r\n                    Forward\r\n                </Button>\r\n\r\n                <div className=\"col\">\r\n\r\n                </div>\r\n\r\n                {(!this.props.recentMessages.find(message => message.user._id !== this.props.user._id) && this.props.recentMessages.length === 1) && <Button className=\"btn-edit-message\" onClick={() => {\r\n                    this.props.setEditMessage()\r\n                }}>\r\n                    <EditOutlinedIcon style={{color: '#99AABB'}} />\r\n                </Button>}\r\n\r\n                {!this.props.recentMessages.find(message => message.user._id !== this.props.user._id) && <Button className=\"btn-delete-message\" onClick={() => {\r\n                    this.props.deleteMessage()\r\n                }}>\r\n                    <DeleteOutlineIcon style={{color: '#99AABB'}} />\r\n                </Button>}\r\n\r\n                <Button className=\"btn-cancel-select\" onClick={() => {\r\n                    this.props.cancelAttachmentRecentMessage()\r\n                }}>\r\n                    <CloseIcon style={{color: '#99AABB'}} />\r\n                </Button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(ToolbarMessage)","// App\r\nimport React from 'react'\r\nimport Dialog from './Dialog'\r\nimport {CSSTransitionGroup} from 'react-transition-group'\r\nimport { toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as roomsActions from '../../Redux/actions/rooms'\r\nimport * as dialogsActions from '../../Redux/actions/dialogs'\r\nimport { bindActionCreators } from 'redux'\r\n\r\nimport Attachment from './Attachment';\r\nimport Slider from './Slider'\r\nimport InputMessage from './InputMessage'\r\nimport ToolbarMessage from './ToolbarMessage'\r\nimport SocketController from '../../Controllers/SocketController'\r\nimport { randomInteger } from '../../Controllers/FunctionsController';\r\nimport InsertDriveFileOutlinedIcon from '@material-ui/icons/InsertDriveFileOutlined';\r\n\r\nlet waitFastRead = false\r\nlet waitDraft = false\r\n\r\nclass Chat extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.inputMessage = React.createRef()\r\n    }\r\n\r\n    state = {\r\n        recentMessages: [],\r\n        attachedRecentMessages: [],\r\n        sounds: [],\r\n        files: [],\r\n        images: [],\r\n        inputMessageHeight: 0,\r\n        isOpenSlider: false,\r\n        sliderImages: [],\r\n        isEdit: false,\r\n        editMessage: {},\r\n        canTyping: true,\r\n        drag: false\r\n    }\r\n\r\n    dropRef = React.createRef()\r\n    dragCounter = 0\r\n\r\n    componentDidMount() {\r\n        let div = this.dropRef.current\r\n        div.addEventListener('dragenter', this.handleDragIn)\r\n        div.addEventListener('dragleave', this.handleDragOut)\r\n        div.addEventListener('dragover', this.handleDrag)\r\n        div.addEventListener('drop', this.handleDrop)\r\n\r\n        let drafts = {...JSON.parse(localStorage.getItem('drafts'))}\r\n        \r\n        if(drafts['draft-'+this.props.dialogId])\r\n            this.inputMessage.current.setText(drafts['draft-'+this.props.dialogId])\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        let div = this.dropRef.current\r\n        div.removeEventListener('dragenter', this.handleDragIn)\r\n        div.removeEventListener('dragleave', this.handleDragOut)\r\n        div.removeEventListener('dragover', this.handleDrag)\r\n        div.removeEventListener('drop', this.handleDrop)\r\n    }\r\n\r\n    handleDrag = (e) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n    }\r\n\r\n    handleDragIn = (e) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.dragCounter++\r\n        if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\r\n            this.setState({drag: true})\r\n        }\r\n    }\r\n\r\n    handleDragOut = (e) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.dragCounter--\r\n        if (this.dragCounter === 0) {\r\n            this.setState({drag: false})\r\n        }\r\n    }\r\n\r\n    handleDrop = (e) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.setState({drag: false})\r\n        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n          this.handleDropFiles(e.dataTransfer.files)\r\n          e.dataTransfer.clearData()\r\n          this.dragCounter = 0    \r\n        }\r\n      }\r\n\r\n    handleDropFiles = (files) => {\r\n        for (var i = 0; i < files.length; i++) {\r\n            this.addFile(files, false, true)\r\n        }\r\n    }\r\n\r\n    sendMessage(text) {\r\n        if(/\\S/.test(text) || !!this.state.attachedRecentMessages.length || !!this.state.images.length || !!this.state.files.length|| !!this.state.sounds.length) {\r\n            let drafts = {...JSON.parse(localStorage.getItem('drafts'))}\r\n            drafts['draft-'+this.props.dialogId] = ''\r\n            localStorage.setItem('drafts', JSON.stringify(drafts));\r\n            switch (this.props.type) {\r\n                case 'room': \r\n                    this.props.roomsActions.sendMessage({\r\n                        text: text,\r\n                        roomId: this.props.roomId,\r\n                        images: this.state.images,\r\n                        files: this.state.files,\r\n                        sounds: this.state.sounds,\r\n                        dialogId: this.props.dialogId,\r\n                        recentMessages: this.state.attachedRecentMessages\r\n                    }, this.props.user.apiToken)\r\n                    break;\r\n                case 'dialog': \r\n                    this.props.dialogsActions.sendMessage({\r\n                        text: text,\r\n                        userId: this.props.userId,\r\n                        images: this.state.images,\r\n                        files: this.state.files,\r\n                        sounds: this.state.sounds,\r\n                        dialogId: this.props.dialogId,\r\n                        recentMessages: this.state.attachedRecentMessages\r\n                    }, this.props.user.apiToken)\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            \r\n            this.setState({attachedRecentMessages: [], images: [], sounds: [], files: []})\r\n            this.inputMessage.current.setText('')\r\n        }\r\n    }\r\n\r\n    sendEditMessage(text) {\r\n        if(/\\S/.test(text) || !!this.state.attachedRecentMessages.length || !!this.state.images.length || !!this.state.sounds.length || !!this.state.files.length) {\r\n            switch (this.props.type) {\r\n                case 'room': \r\n                    this.props.roomsActions.editMessage({\r\n                        _id: this.state.editMessage._id,\r\n                        text: text,\r\n                        roomId: this.props.roomId,\r\n                        images: this.state.images,\r\n                        files: this.state.files,\r\n                        sounds: this.state.sounds,\r\n                        dialogId: this.props.dialogId,\r\n                        recentMessages: this.state.attachedRecentMessages\r\n                    }, this.props.user.apiToken)\r\n                    break;\r\n                case 'dialog': \r\n                    this.props.dialogsActions.editMessage({\r\n                        _id: this.state.editMessage._id,\r\n                        text: text,\r\n                        userId: this.props.userId,\r\n                        images: this.state.images,\r\n                        files: this.state.files,\r\n                        sounds: this.state.sounds,\r\n                        dialogId: this.props.dialogId,\r\n                        recentMessages: this.state.attachedRecentMessages\r\n                    }, this.props.user.apiToken)\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            \r\n           this.cancelEditMessage()\r\n        }\r\n    }\r\n\r\n    deleteMessage() {\r\n        switch (this.props.type) {\r\n            case 'room': \r\n                this.props.roomsActions.deleteMessage({\r\n                    roomId: this.props.roomId,\r\n                    deleteMessages: this.state.recentMessages\r\n                }, this.props.user.apiToken)\r\n                break;\r\n            case 'dialog': \r\n                this.props.dialogsActions.deleteMessage({\r\n                    otherId: this.props.userId,\r\n                    dialogId: this.props.dialogId,\r\n                    deleteMessages: this.state.recentMessages\r\n                }, this.props.user.apiToken)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        this.setState({recentMessages: []})\r\n    }\r\n\r\n    retrySendMessage(message) {\r\n        switch (this.props.type) {\r\n            case 'room': \r\n                message.roomId = this.props.rooms.activeRoom._id\r\n                message.dialogId = this.props.dialogId\r\n                this.props.roomsActions.retrySendMessage(message, this.props.user.apiToken)\r\n                break;\r\n            case 'dialog': \r\n                message.userId = this.props.userId\r\n                message.dialogId = this.props.dialogId\r\n                this.props.dialogsActions.retrySendMessage(message, this.props.user.apiToken)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    deleteLocalMessage(_id) {\r\n        switch (this.props.type) {\r\n            case 'room': \r\n                this.props.roomsActions.deleteLocalMessage(_id)\r\n                break;\r\n            case 'dialog': \r\n                this.props.dialogsActions.deleteLocalMessage(_id, this.props.dialogId)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    addAttachmentRecentMessage() {\r\n        this.setState({\r\n            attachedRecentMessages: this.state.recentMessages,\r\n            recentMessages: []\r\n        })\r\n    }\r\n\r\n    cancelAttachmentRecentMessage() {\r\n        this.setState({\r\n            recentMessages: []\r\n        })\r\n    }\r\n\r\n    setEditMessage() {\r\n        this.inputMessage.current.setText(this.state.recentMessages[0].text)\r\n\r\n        this.state.recentMessages[0].images.map((x, i) => {\r\n            x.id = i\r\n        })\r\n        this.state.recentMessages[0].sounds.map((x, i) => {\r\n            x.id = i\r\n        })\r\n        this.state.recentMessages[0].files.map((x, i) => {\r\n            x.id = i\r\n        })\r\n\r\n        this.setState({\r\n            images: this.state.recentMessages[0].images,\r\n            sounds: this.state.recentMessages[0].sounds,\r\n            files: this.state.recentMessages[0].files,\r\n            recentMessages: [],\r\n            attachedRecentMessages: this.state.recentMessages[0].recentMessages,\r\n            isEdit: true,\r\n            editMessage: this.state.recentMessages[0]\r\n        })\r\n    }\r\n\r\n    setLastEditMessage() {\r\n        let lastMyMessage = this.props.messages.slice().reverse().find(x => x.user._id === this.props.user._id)\r\n\r\n        lastMyMessage.images.map((x, i) => {\r\n            x.id = i\r\n        })\r\n        lastMyMessage.sounds.map((x, i) => {\r\n            x.id = i\r\n        })\r\n        lastMyMessage.files.map((x, i) => {\r\n            x.id = i\r\n        })\r\n\r\n        if(lastMyMessage) {\r\n            this.inputMessage.current.setText(lastMyMessage.text)\r\n            this.setState({\r\n                images: lastMyMessage.images,\r\n                sounds: lastMyMessage.sounds,\r\n                files: lastMyMessage.files,\r\n                recentMessages: [],\r\n                attachedRecentMessages: lastMyMessage.recentMessages,\r\n                isEdit: true,\r\n                editMessage: lastMyMessage\r\n            })\r\n        }\r\n    }\r\n\r\n    cancelEditMessage() {\r\n        this.inputMessage.current.setText('')\r\n        this.setState({\r\n            images: [],\r\n            sounds: [],\r\n            files: [],\r\n            recentMessages: [],\r\n            attachedRecentMessages: [],\r\n            isEdit: false,\r\n            editMessage: {}\r\n        })\r\n    }\r\n\r\n    readMessages() {\r\n        if(waitFastRead)\r\n            clearTimeout(waitFastRead)\r\n\r\n        switch (this.props.type) {\r\n            case 'room': \r\n                waitFastRead = setTimeout(() => {\r\n                    this.props.roomsActions.readMessages({\r\n                        dialogId: this.props.dialogId, \r\n                        roomId: this.props.roomId, \r\n                        userId: this.props.user._id\r\n                    }, this.props.user.apiToken)\r\n                }, 500)\r\n                break;\r\n            case 'dialog': \r\n                waitFastRead = setTimeout(() => {\r\n                    this.props.dialogsActions.readMessages({\r\n                        dialogId: this.props.dialogId, \r\n                        otherId: this.props.userId, \r\n                        userId: this.props.user._id\r\n                    }, this.props.user.apiToken)\r\n                }, 500)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    loadMessages() {\r\n        switch (this.props.type) {\r\n            case 'room': \r\n                this.props.roomsActions.loadMessages({dialogId: this.props.dialogId}, this.props.user.apiToken)\r\n                break;\r\n            case 'dialog': \r\n                this.props.dialogsActions.loadMessages({dialogId: this.props.dialogId}, this.props.user.apiToken)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    addFile(e, paste = false, drag = false) {\r\n        let sounds = [...this.state.sounds]\r\n        let files = [...this.state.files]\r\n        let images = [...this.state.images]\r\n\r\n        let counter = sounds.length + files.length + images.length\r\n        \r\n        if(!paste && !drag) {\r\n            for (let i = 0; i < e.target.files.length; i++) {\r\n                if(counter > 9) {\r\n                    toast.error(\"Max upload 10 attachment!\", {\r\n                        position: toast.POSITION.TOP_CENTER\r\n                    });\r\n                    break\r\n                }\r\n\r\n                let file = {\r\n                    path: (window.URL || window.webkitURL).createObjectURL(new Blob([e.target.files[i]], {type: e.target.files[i].type})), \r\n                    file: e.target.files[i], \r\n                    name: e.target.files[i].name, \r\n                    type: e.target.files[i].name.split('.').pop(),\r\n                    size: e.target.files[i].size / 1000\r\n                }\r\n                \r\n                if(file.type === 'png' || file.type === 'jpg' || file.type === 'jpeg' || file.type === 'gif') {\r\n                    file.id = images.length\r\n                    images.push(file)\r\n                }\r\n\r\n                if(file.type === 'txt' || file.type === 'pdf' || file.type === 'docx' || file.type === 'zip' || file.type === 'doc') {\r\n                    file.id = files.length\r\n                    files.push(file)\r\n                }\r\n\r\n                if(file.type === 'mp3') {\r\n                    file.id = sounds.length\r\n                    sounds.push(file)\r\n                }\r\n\r\n                counter++\r\n            }\r\n\r\n            e.target.value = null;\r\n        }\r\n\r\n        if(paste) {\r\n            if(counter > 9) {\r\n                toast.error(\"Max upload 10 attachment!\", {\r\n                    position: toast.POSITION.TOP_CENTER\r\n                });\r\n            } else {\r\n                let file = {\r\n                    id: images.length,\r\n                    path: (window.URL || window.webkitURL).createObjectURL(new Blob([e], {type: e.type})), \r\n                    file: e, \r\n                    name: e.name, \r\n                    type: e.name.split('.').pop()\r\n                }\r\n\r\n                images.push(file)\r\n            }\r\n        }\r\n\r\n        if(drag) {\r\n            for (let i = 0; i < e.length; i++) {\r\n                if(counter > 9) {\r\n                    toast.error(\"Max upload 10 attachment!\", {\r\n                        position: toast.POSITION.TOP_CENTER\r\n                    });\r\n                    break\r\n                }\r\n\r\n                let file = {\r\n                    path: (window.URL || window.webkitURL).createObjectURL(new Blob([e[i]], {type: e[i].type})), \r\n                    file: e[i], \r\n                    name: e[i].name, \r\n                    type: e[i].name.split('.').pop(),\r\n                    size: e[i].size / 1000\r\n                }\r\n                \r\n                if(file.type === 'png' || file.type === 'jpg' || file.type === 'jpeg' || file.type === 'gif') {\r\n                    file.id = images.length\r\n                    images.push(file)\r\n                }\r\n\r\n                if(file.type === 'txt' || file.type === 'pdf' || file.type === 'docx' || file.type === 'zip' || file.type === 'doc') {\r\n                    file.id = files.length\r\n                    files.push(file)\r\n                }\r\n\r\n                if(file.type === 'mp3') {\r\n                    file.id = sounds.length\r\n                    sounds.push(file)\r\n                }\r\n\r\n                counter++\r\n            }\r\n        }\r\n\r\n        this.setState({sounds, files, images})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if(this.state.canTyping !== nextState.canTyping) {\r\n            return false\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    typing(newText, prevText) {\r\n        if(waitDraft)\r\n            clearTimeout(waitDraft)\r\n\r\n        if(newText > prevText && !this.state.isEdit) {\r\n            if(this.state.canTyping) {\r\n                this.setState({canTyping: false})\r\n\r\n                switch (this.props.type) {\r\n                    case 'room': \r\n                        SocketController.typingRoom(this.props.rooms.activeRoom._id)\r\n                        break;\r\n                    case 'dialog': \r\n                        SocketController.typingDialog(this.props.userId, this.props.user._id)\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                \r\n                setTimeout(() => {\r\n                    this.setState({canTyping: true})\r\n                }, 2500)\r\n            }\r\n        }\r\n\r\n        if(!this.state.isEdit) {\r\n            waitDraft = setTimeout(() => {\r\n                let drafts = {...JSON.parse(localStorage.getItem('drafts'))}\r\n                drafts['draft-'+this.props.dialogId] = newText\r\n                if(!drafts['draft-'+this.props.dialogId] || !/\\S/.test(drafts['draft-'+this.props.dialogId]))\r\n                    delete drafts['draft-'+this.props.dialogId]\r\n                localStorage.setItem('drafts', JSON.stringify(drafts));\r\n            }, 500);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n        <>\r\n            <div className=\"dialog-container\" ref={this.dropRef}>\r\n                {this.state.drag &&\r\n                    <div className=\"drag-and-drop-container\">\r\n                        <div className=\"data-empty\">\r\n                            <InsertDriveFileOutlinedIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                            <p>Drag & drop files here to attach</p>\r\n                        </div>\r\n                    </div>\r\n                }\r\n\r\n                {this.state.isOpenSlider && <Slider images={this.state.sliderImages} close={() => {this.setState({isOpenSlider: false, sliderImages: []})}} />}\r\n\r\n                <Dialog \r\n                    loadMessages={() => {this.loadMessages()}}\r\n                    retrySendMessage={(message) => {this.retrySendMessage(message)}}\r\n                    deleteLocalMessage={(_id) => {this.deleteLocalMessage(_id)}}\r\n                    messages={this.props.messages}\r\n                    to={this.props.to}\r\n                    dialog={this.props.dialog}\r\n                    userName={this.props.userName}\r\n                    typing={this.props.typing}\r\n                    loading={this.props.loading}\r\n                    type={this.props.type}\r\n                    unRead={this.props.messages.filter(x => !x.isRead && x.user._id !== this.props.user._id)}\r\n                    recentMessages={this.state.recentMessages}\r\n                    openSlider={(sliderImages) => {this.setState({sliderImages, isOpenSlider: true})}}\r\n                    onSelect={(message) => {\r\n                        this.setState({recentMessages: [...this.state.recentMessages, message]})\r\n                    }} \r\n                    unSelect={(id) => {\r\n                        this.setState({recentMessages: [\r\n                            ...this.state.recentMessages.filter(message => {                        \r\n                                return message._id !== id\r\n                            })\r\n                        ]})\r\n                    }}\r\n                    readMessages={() => {\r\n                        this.readMessages()\r\n                    }}\r\n                />\r\n\r\n                <CSSTransitionGroup \r\n                    transitionName=\"scroll-to-bottom\"\r\n                    transitionEnterTimeout={100}\r\n                    transitionLeaveTimeout={100}>\r\n                    {(!!this.state.attachedRecentMessages.length || !!this.state.images.length || !!this.state.sounds.length || !!this.state.files.length) && \r\n                        <Attachment \r\n                            images={this.state.images} \r\n                            recentMessages={this.state.attachedRecentMessages} \r\n                            files={this.state.files} \r\n                            sounds={this.state.sounds}\r\n                            unSelectRecentMessages={() => {\r\n                                this.setState({attachedRecentMessages: []})\r\n                            }}\r\n                            removeImage={(id) => {\r\n                                this.setState({images: [\r\n                                    ...this.state.images.filter(image => {                        \r\n                                        return image.id !== id\r\n                                    })\r\n                                ]})\r\n                            }}\r\n                            removeSound={(id) => {\r\n                                this.setState({sounds: [\r\n                                    ...this.state.sounds.filter(sound => {                        \r\n                                        return sound.id !== id\r\n                                    })\r\n                                ]})\r\n                            }}\r\n                            removeFile={(id) => {\r\n                                this.setState({files: [\r\n                                    ...this.state.files.filter(file => {                        \r\n                                        return file.id !== id\r\n                                    })\r\n                                ]})\r\n                            }}\r\n                        />\r\n                    }\r\n                </CSSTransitionGroup>\r\n\r\n                <InputMessage \r\n                    isShow={!this.state.recentMessages.length}\r\n                    ref={this.inputMessage}\r\n                    cancelEditMessage={() => {this.cancelEditMessage()}}\r\n                    isEdit={this.state.isEdit}\r\n                    editMessage={this.state.editMessage}\r\n                    sendEditMessage={(text) => {this.sendEditMessage(text)}}\r\n                    cancelEditMessage={() => {this.cancelEditMessage()}}\r\n                    images={this.state.images} \r\n                    sounds={this.state.sounds} \r\n                    files={this.state.files} \r\n                    attachedRecentMessages={this.state.attachedRecentMessages} \r\n                    sendMessage={(text) => {this.sendMessage(text)}}\r\n                    typing={(newText, prevText) => {this.typing(newText, prevText)}}\r\n                    addFile={(e, paste) => {this.addFile(e, paste)}} \r\n                    setLastEditMessage={() => {this.setLastEditMessage()}}\r\n                />\r\n\r\n                {!!this.state.recentMessages.length && \r\n                    <ToolbarMessage \r\n                        addAttachmentRecentMessage={() => {this.addAttachmentRecentMessage()}}\r\n                        cancelAttachmentRecentMessage={() => {this.cancelAttachmentRecentMessage()}} \r\n                        deleteMessage={() => {this.deleteMessage()}}\r\n                        recentMessages={this.state.recentMessages}\r\n                        setEditMessage={() => {this.setEditMessage()}}\r\n                    />\r\n                }\r\n            </div>\r\n        </>)\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        roomsActions: bindActionCreators(roomsActions, dispatch),\r\n        dialogsActions: bindActionCreators(dialogsActions, dispatch)\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat)","// App\r\nimport React from 'react'\r\nimport Modal from 'react-modal';\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nconst customStylesModal = {\r\n    overlay: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        backgroundColor: 'rgba(0, 0, 0, 0.25)'\r\n    },\r\n    content : {\r\n        top                   : '50%',\r\n        left                  : '50%',\r\n        right                 : 'auto',\r\n        bottom                : 'auto',\r\n        minWidth              : '300px',\r\n        marginRight           : '-50%',\r\n        transform             : 'translate(-50%, -50%)',\r\n        borderRadius          : '10px',\r\n        boxShadow             : '0px 5px 30px rgba(0, 0, 0, 0.16)',\r\n        textAlign             : 'center'\r\n    }\r\n};\r\n\r\nclass RoomJoinError extends React.Component {\r\n    render() {\r\n        return <Modal\r\n            isOpen={this.props.isOpen}\r\n            style={customStylesModal}\r\n            contentLabel=\"Error join room\"\r\n        >\r\n            <ErrorOutlineIcon style={{color: '#FF3333', fontSize: 60}} />\r\n            <h2 className=\"modal-title\">Error</h2>\r\n            <p className=\"modal-text\">{this.props.rooms.activeRoom.error.msg}</p>\r\n            <button className=\"button-blue\" type=\"submit\" style={{width: 'max-content'}} onClick={() => {\r\n                this.props.history.push('/')\r\n            }}>Back</button>\r\n        </Modal>\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        rooms: state.rooms\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(withRouter(RoomJoinError))","// App\r\nimport React from 'react'\r\nimport {PageSettings} from '../PageSettings'\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as roomsActions from '../../Redux/actions/rooms'\r\nimport { bindActionCreators } from 'redux'\r\n\r\n// Material\r\nimport { withRouter } from 'react-router-dom'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport Chat from '../../Partials/Chat/Chat'\r\nimport RoomJoinError from '../../Modals/RoomJoinError'\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport MicIcon from '@material-ui/icons/Mic';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport { withStyles } from '@material-ui/core'\r\nimport WebRtcController from '../../Controllers/WebRtcController'\r\nimport SocketController from '../../Controllers/SocketController'\r\nimport MusicOffIcon from '@material-ui/icons/MusicOff';\r\nimport CallEndIcon from '@material-ui/icons/CallEnd';\r\nimport { randomInteger } from '../../Controllers/FunctionsController'\r\nimport Avatar from '../../Partials/User/Avatar';\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#fff',\r\n        color: '#008FF7',\r\n        zIndex: 2,\r\n        '&:hover': {\r\n            backgroundColor: '#fff',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Members extends React.Component {\r\n    render() {\r\n        return <Scrollbars\r\n            renderTrackVertical={props => <div className=\"track-vertical\"/>}\r\n            renderThumbVertical={props => <div className=\"thumb-vertical\"/>}\r\n            className=\"theme-members scroll\"\r\n            autoHide\r\n        >\r\n            {this.props.users.map((user, index) => \r\n                <div key={index} className=\"member\">\r\n                    <Avatar name={user.name.first.charAt(0)+user.name.last.charAt(0)} style={{fontSize: 30, borderRadius: 0, width: '100%', height: '100%', backgroundColor: `rgb(${user.color})`}}  />\r\n                    {user.speaking && <span className=\"speaking\"></span>}\r\n                </div>\r\n            )}\r\n        </Scrollbars>\r\n    }\r\n}\r\n\r\nclass MediaStream extends React.PureComponent {\r\n    componentDidMount() {\r\n        this.audio.srcObject = this.props.stream\r\n    }\r\n\r\n    render() {\r\n        return <audio ref={ref => {this.audio = ref}} style={{display: 'none'}} autoPlay></audio>\r\n    }\r\n}\r\n\r\nclass Room extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(false)\r\n\r\n        let waitSocket = setInterval(() => {\r\n            if(SocketController.getSocketId()) {\r\n                this.props.roomsActions.joinRoom({id: this.props.match.params.id, apiToken: this.props.user.apiToken})\r\n                clearInterval(waitSocket)\r\n            }\r\n        }, 100);\r\n        \r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.roomsActions.leaveRoom(this.props.rooms.activeRoom._id, this.props.rooms.activeRoom.lang)\r\n    }\r\n\r\n    render() {\r\n        if(this.props.rooms.activeRoom && this.props.rooms.activeRoom.error) {\r\n            return <RoomJoinError isOpen={true} />\r\n        }\r\n\r\n        return this.props.rooms.activeRoom && (\r\n            <>  \r\n                {this.props.rooms.activeRoom.remoteStream && <MediaStream stream={this.props.rooms.activeRoom.remoteStream} />}\r\n                <div className=\"col-xl-3 col-lg-6 col-md-6\">\r\n                    <div className=\"theme-header\">\r\n                        <IconButton className=\"back-btn\" onClick={() => {\r\n                            this.props.history.push('/')\r\n                        }}>\r\n                            <ArrowBackIcon fontSize=\"small\" style={{color: '#008FF7'}} />\r\n                        </IconButton>\r\n                        \r\n                        <div className=\"theme-info\">\r\n                            <h2 className=\"theme-title\">{this.props.rooms.activeRoom.title}</h2>\r\n                            <h3 className=\"theme-online-counter\">{this.props.rooms.activeRoom.users.length + 1} online</h3>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"theme-sidebar\">\r\n                        <Chat messages={this.props.rooms.activeRoom.dialog.messages} type=\"room\" to={this.props.rooms.activeRoom.title} dialogId={this.props.rooms.activeRoom.dialog._id} roomId={this.props.rooms.activeRoom._id} />\r\n                    </div>\r\n                </div>\r\n                \r\n\r\n                <div className=\"col-xl-9 col-lg-6 col-md-6 theme-screen\">\r\n                    {this.props.rooms.activeRoom && <Members users={this.props.rooms.activeRoom.users} />}\r\n\r\n                    <div className=\"media-options\">\r\n                        <CustomFab className={`media-option ${this.props.media.micOn ? 'active' : ''}`} onClick={() => {WebRtcController.toggleMicrophone()}}>\r\n                            <MicIcon style={{color: this.props.media.micOn ? '#fff' : '#008FF7'}} />\r\n                        </CustomFab>\r\n                        <CustomFab className={`media-option ${this.props.media.musicOn ? '' : 'active'}`} onClick={() => {WebRtcController.toggleMusic()}}>\r\n                            <MusicOffIcon style={{color: this.props.media.musicOn ? '#008FF7' : '#fff'}} />\r\n                        </CustomFab>\r\n                        <CustomFab className={`media-option reject`} onClick={() => {this.props.history.push('/')}}>\r\n                            <CallEndIcon style={{color: '#fff'}} />\r\n                        </CustomFab>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms,\r\n        media: state.media\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        roomsActions: bindActionCreators(roomsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Room))","// App\r\nimport React from 'react'\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\nimport {PageSettings} from '../PageSettings'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as dialogsActions from '../../Redux/actions/dialogs'\r\nimport { bindActionCreators } from 'redux'\r\nimport RoomItem from '../../Partials/Room/RoomItem'\r\n\r\n// Material\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { withStyles, Tooltip } from '@material-ui/core'\r\nimport showLoading from '../../Partials/Loading'\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#008FF7',\r\n        position: 'absolute',\r\n        bottom: 20,\r\n        right: 20,\r\n        '&:hover': {\r\n            backgroundColor: '#008FF7',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Main extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    state = {\r\n        showBtnAdd: true,\r\n        scrollTop: 0\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n    }\r\n\r\n    onScroll() {\r\n        if(this.state.scrollTop < this.messagesBlock.getScrollTop()) {\r\n            if(this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: false})\r\n        } else {\r\n            if(!this.state.showBtnAdd)\r\n                this.setState({showBtnAdd: true})\r\n        }\r\n\r\n        this.setState({scrollTop: this.messagesBlock.getScrollTop()})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if(nextState.scrollTop !== this.state.scrollTop) {\r\n            return false\r\n        }\r\n\r\n        return true\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <> \r\n                <div className=\"col-md-9\" style={{order: 2}}></div>\r\n                <div className=\"col-md-9\" style={{order: 4}}></div>            \r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        rooms: state.rooms,\r\n        dialogs: state.dialogs\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Main)\r\n","// App\r\nimport React from 'react'\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\nimport { withRouter } from 'react-router-dom'\r\nimport {PageSettings} from '../PageSettings'\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\nimport * as dialogsActions from '../../Redux/actions/dialogs'\r\nimport { bindActionCreators } from 'redux'\r\nimport RoomItem from '../../Partials/Room/RoomItem'\r\n\r\n// Material\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { withStyles } from '@material-ui/core'\r\nimport showLoading from '../../Partials/Loading'\r\nimport Avatar from '../../Partials/User/Avatar';\r\nimport Chat from '../../Partials/Chat/Chat';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\n\r\nconst fabStyles = theme => ({\r\n    root: {\r\n        backgroundColor: '#008FF7',\r\n        position: 'absolute',\r\n        bottom: 20,\r\n        right: 20,\r\n        '&:hover': {\r\n            backgroundColor: '#008FF7',\r\n        }\r\n    }\r\n})\r\n\r\nconst CustomFab = withStyles(fabStyles)(Fab);\r\n\r\nclass Dialog extends React.Component {\r\n    static contextType = PageSettings;\r\n\r\n    state = {\r\n        showBtnAdd: true,\r\n        scrollTop: 0,\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.context.toggleHeader(true)\r\n\r\n        if(!this.props.dialogs.dialogs.find(dialog => dialog.user._id === this.props.match.params.id)) {\r\n            this.props.dialogsActions.dialogGet(this.props.match.params.id, this.props.user.apiToken)\r\n        } else {\r\n            if(!this.props.dialogs.dialogs.find(dialog => dialog.user._id === this.props.match.params.id).getted)\r\n                this.props.dialogsActions.dialogLoad(this.props.match.params.id, this.props.user.apiToken)\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        this.context.toggleHeader(false)\r\n    }\r\n\r\n    render() {    \r\n        let dialog = this.props.dialogs.dialogs.find(dialog => dialog.user._id === this.props.match.params.id)\r\n\r\n        return (\r\n            <> \r\n                {dialog && !dialog.isNotFound && <><div className=\"col-xl-9 col-lg-6 col-md-6 dialog-header\" style={{order: 2}}>\r\n                     <><Avatar style={{\r\n                        width: 32, \r\n                        height: 32, \r\n                        fontSize: 14, \r\n                        fontWeight: 600, \r\n                        backgroundColor: `rgb(${dialog.user.color})`\r\n                    }} name={dialog.user.name.first.charAt(0) + dialog.user.name.last.charAt(0)} />\r\n                    <div className=\"user-info\">\r\n                        <p className=\"user-name\">{`${dialog.user.name.first} ${dialog.user.name.last}`}</p>\r\n                        <p className=\"last-message\">Last message</p>\r\n                    </div></>\r\n                </div>\r\n                <div className=\"col-xl-9 col-lg-6 col-md-6\" style={{order: 4}}>\r\n                    <Chat \r\n                        messages={dialog.messages}\r\n                        loading={dialog && !dialog.getted} \r\n                        type=\"dialog\" \r\n                        userName={dialog.user.name.first}\r\n                        typing={dialog.typing}\r\n                        userId={dialog.user._id}\r\n                        to={dialog.user.name.first} \r\n                        dialogId={dialog._id}\r\n                        dialog={dialog}\r\n                    />\r\n                </div></>}\r\n\r\n                {dialog && dialog.isNotFound && <>\r\n                    <div className=\"col-xl-9 col-lg-6 col-md-6\" style={{order: 2}}></div>\r\n                    <div className=\"col-xl-9 col-lg-6 col-md-6\" style={{order: 4}}>\r\n                        <div className=\"data-empty\">\r\n                            <SearchIcon style={{color: '#B8C3CF', fontSize: 54, margin: '0 auto', display: 'block'}} />\r\n\r\n                            <p>User not found</p>\r\n                        </div>\r\n                    </div>\r\n                </>}     \r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.user,\r\n        dialogs: state.dialogs\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        dialogsActions: bindActionCreators(dialogsActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Dialog))\r\n","import React from 'react'\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport Login from '../Pages/Auth/Login'\r\nimport Register from '../Pages/Auth/Register'\r\n\r\nimport Languages from '../Sidebar/Languages'\r\nimport Rooms from '../Sidebar/Rooms';\r\nimport Room from '../Pages/User/Room';\r\nimport Messages from '../Sidebar/Messages';\r\nimport Notifications from '../Sidebar/Notifications';\r\nimport Main from '../Pages/User/Main';\r\nimport Dialog from '../Pages/User/Dialog';\r\nimport { randomInteger } from '../Controllers/FunctionsController';\r\n\r\nconst routes = [\r\n    {\r\n        path: '/login',\r\n        exact: true,\r\n        type: 'auth',\r\n        title: 'Авторизация',\r\n        component: () => <Login />\r\n    },\r\n    {\r\n        path: '/register',\r\n        exact: true,\r\n        type: 'auth',\r\n        title: 'Регистрация',\r\n        component: () => <Register />\r\n    },\r\n    {\r\n        path: '/',\r\n        exact: true,\r\n        type: 'user',\r\n        title: 'Home',\r\n        component: () => <Main />\r\n    },\r\n    {\r\n        path: '/languages',\r\n        exact: true,\r\n        type: 'user',\r\n        title: 'Languages',\r\n        component: () => <Languages />\r\n    },\r\n    {\r\n        path: '/chats/:id',\r\n        exact: true,\r\n        type: 'user',\r\n        title: '',\r\n        component: () => <Dialog key={randomInteger(0, 1000)} />\r\n    },\r\n    {\r\n        path: '/rooms/:id',\r\n        exact: true,\r\n        type: 'user',\r\n        title: '',\r\n        component: () => <Room />\r\n    },\r\n]\r\n\r\nexport default routes","// App\r\nimport React from 'react'\r\n\r\n// Router\r\nimport {\r\n    BrowserRouter as Router,\r\n} from \"react-router-dom\"\r\n\r\nclass NoMatch extends React.Component {\r\n    render() {\r\n        return (\r\n            404\r\n        )\r\n    }\r\n}\r\n\r\nexport default NoMatch\r\n","// App\r\nimport React from \"react\";\r\nimport { withCookies } from \"react-cookie\";\r\nimport SocketController from '../Controllers/SocketController'\r\n\r\n// Router\r\nimport { Switch, Route, Redirect, withRouter } from \"react-router-dom\";\r\nimport routes from './config'\r\n\r\n// Redux\r\nimport { connect } from \"react-redux\";\r\nimport * as userActions from \"../Redux/actions/user\";\r\nimport { bindActionCreators } from \"redux\";\r\n\r\nimport NoMatch from '../Pages/NoMatch'\r\nimport { setTitle } from \"../Controllers/FunctionsController\";\r\nimport {urlApi} from '../config'\r\nclass AppRouter extends React.Component {\r\n  state = {\r\n    isRender: false\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.history.listen(() => {\r\n      setTitle(this.props.history.location.pathname, routes);\r\n    });\r\n    \r\n    setTitle(this.props.history.location.pathname, routes);\r\n    \r\n    const { cookies } = this.props;\r\n    let apiToken = cookies.get(\"apiToken\");\r\n\r\n    if (apiToken) {\r\n      fetch(`${urlApi}/api/user/me`, {\r\n        method: \"get\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${apiToken}`,\r\n        },\r\n      })\r\n        .then((response) => response.json())\r\n        .then(({user, dialogs, noReadCount}) => {\r\n          SocketController.init(apiToken)\r\n          // SocketController.joinLang(user.roomLang)\r\n          this.props.userActions.loginUser(user, dialogs, noReadCount, apiToken);\r\n          this.setState({isRender: true})\r\n        })\r\n        .catch(() => {\r\n          this.setState({isRender: true})\r\n        })\r\n    } else {\r\n      this.setState({isRender: true})\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.state.isRender && (<>\r\n      <Switch>\r\n          {routes.map((route, index) => {\r\n              switch (route.type) {\r\n                  case 'auth':\r\n                      return <this.AuthRoute\r\n                          key={index}\r\n                          path={route.path}\r\n                          exact={route.exact}\r\n                      >\r\n                          <route.component />\r\n                      </this.AuthRoute>\r\n\r\n                  case 'user':\r\n                      return <this.PrivateRoute\r\n                          key={index}\r\n                          path={route.path}\r\n                          exact={route.exact}\r\n                      >\r\n                          <route.component />\r\n                      </this.PrivateRoute>\r\n              \r\n                  default:\r\n                      return false\r\n              }            \r\n          })}\r\n\r\n          {/* Auth routes */}\r\n          {/* <this.AuthRoute exact path=\"/reset/:token\" component={Reset}/> */}\r\n          {/* Auth routes end */}\r\n\r\n          <Route component={NoMatch} />\r\n      </Switch></>\r\n    );\r\n  }\r\n\r\n  PrivateRoute = ({ children, ...rest }) => {\r\n    return (\r\n      <Route\r\n        {...rest}\r\n        render={() =>\r\n          this.props.user.isAuth ? (\r\n            children\r\n          ) : (\r\n            <Redirect\r\n              to={{\r\n                pathname: \"/login\",\r\n              }}\r\n            />\r\n          )\r\n        }\r\n      />\r\n    );\r\n  };\r\n\r\n  AuthRoute = ({ children, ...rest }) => {\r\n    return (\r\n      <Route\r\n        {...rest}\r\n        render={() =>\r\n          !this.props.user.isAuth ? (\r\n            children\r\n          ) : (\r\n            <Redirect\r\n              to={{\r\n                pathname: \"/\",\r\n              }}\r\n            />\r\n          )\r\n        }\r\n      />\r\n    );\r\n  };\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    user: state.user,\r\n  };\r\n};\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    userActions: bindActionCreators(userActions, dispatch),\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(withCookies(withRouter(AppRouter)));\r\n","// App\nimport React from 'react'\nimport './App.css'\nimport {PageSettings} from './Pages/PageSettings'\n\n// Partials\nimport UserSidebar from './Partials/UserSidebar'\n\n// Router\nimport AppRouter from './Router'\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.toggleHeader = (value) => {\n            this.setState({userHeader: value})\n        }\n\n        this.state = {\n            userHeader: false,\n            toggleHeader: this.toggleHeader\n        }\n    }\n\n    \n\n    render() {\n        return (\n            <PageSettings.Provider value={this.state}>\n                <div className=\"container-fluid\">\n                    <div className=\"row\">\n                        {this.state.userHeader && <UserSidebar />}\n                        <AppRouter />\n                    </div>\n                </div>\n            </PageSettings.Provider>\n        )\n    }\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","// App\nimport 'react-app-polyfill/ie9';\nimport 'react-app-polyfill/ie11';\nimport 'core-js/features/array/find';\nimport 'core-js/features/array/includes';\nimport 'core-js/features/number/is-nan';\nimport 'react-app-polyfill/stable';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { CookiesProvider } from 'react-cookie'\nimport {\n    BrowserRouter as Router,\n} from \"react-router-dom\"\nimport Modal from \"react-modal\";\nimport { ToastContainer } from 'react-toastify';\n\n\n// Redux\nimport store from './Redux/store'\nimport { Provider } from 'react-redux'\n\nModal.setAppElement(\"#root\");\n\nReactDOM.render(\n    <CookiesProvider>\n        <Provider store={store}>\n            <Router>\n                <App />\n                <ToastContainer />\n            </Router>\n        </Provider>\n    </CookiesProvider>,\n    document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}